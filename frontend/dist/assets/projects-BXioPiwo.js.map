{"version":3,"file":"projects-BXioPiwo.js","sources":["../../src/services/projects.js"],"sourcesContent":["import { apiFetch } from './api';\r\n\r\nexport const listProjects = (params = {}) => {\r\n  const sp = new URLSearchParams();\r\n  if (params.page) sp.set('page', params.page);\r\n  if (params.limit) sp.set('limit', params.limit);\r\n  if (params.search) sp.set('search', params.search);\r\n  if (params.status) sp.set('status', params.status);\r\n  if (params.company_id) sp.set('company_id', params.company_id);\r\n  if (params.project_type) sp.set('project_type', params.project_type);\r\n  if (params.priority) sp.set('priority', params.priority);\r\n  if (params.q) sp.set('q', params.q);\r\n  const qs = sp.toString();\r\n  const path = qs ? `/api/projects?${qs}` : '/api/projects';\r\n  \r\n  console.log('üîç listProjects - Llamando a:', path);\r\n  console.log('üîç listProjects - Token:', localStorage.getItem('token') ? 'Presente' : 'Ausente');\r\n  \r\n  return apiFetch(path).then(data => {\r\n    console.log('‚úÖ listProjects - Respuesta recibida:', data);\r\n    return data;\r\n  }).catch(error => {\r\n    console.error('‚ùå listProjects - Error:', error);\r\n    throw error;\r\n  });\r\n};\r\n\r\nexport const createProject = (payload) =>\r\n  apiFetch('/api/projects', {\r\n    method: 'POST',\r\n    body: JSON.stringify(payload),\r\n  });\r\n\r\nexport const getProject = (id) => apiFetch(`/api/projects/${id}`);\r\n\r\nexport const searchProjectsByName = (name, company_id = null) => {\r\n  const sp = new URLSearchParams();\r\n  sp.set('name', name);\r\n  if (company_id) sp.set('company_id', company_id);\r\n  \r\n  const path = `/api/projects/search-by-name?${sp.toString()}`;\r\n  \r\n  console.log('üîç searchProjectsByName - Llamando a:', path);\r\n  \r\n  return apiFetch(path).then(data => {\r\n    console.log('‚úÖ searchProjectsByName - Respuesta recibida:', data);\r\n    return data;\r\n  }).catch(error => {\r\n    console.error('‚ùå searchProjectsByName - Error:', error);\r\n    throw error;\r\n  });\r\n};\r\n\r\nexport const updateProject = (id, payload) => {\r\n  console.log('üîç updateProject - ID:', id);\r\n  console.log('üîç updateProject - Payload:', payload);\r\n  console.log('üîç updateProject - URL:', `/api/projects/${id}`);\r\n  \r\n  return apiFetch(`/api/projects/${id}`, {\r\n    method: 'PATCH',\r\n    body: JSON.stringify(payload),\r\n  });\r\n};\r\n\r\nexport const updateProjectStatus = (id, payload) =>\r\n  apiFetch(`/api/projects/${id}/status`, {\r\n    method: 'PUT',\r\n    body: JSON.stringify(payload),\r\n  });\r\n\r\n// Funci√≥n eliminada - sistema de categor√≠as obsoleto\r\n\r\nexport const updateProjectQueries = (id, payload) =>\r\n  apiFetch(`/api/projects/${id}/queries`, {\r\n    method: 'PUT',\r\n    body: JSON.stringify(payload),\r\n  });\r\n\r\nexport const updateProjectMark = (id, payload) =>\r\n  apiFetch(`/api/projects/${id}/mark`, {\r\n    method: 'PUT',\r\n    body: JSON.stringify(payload),\r\n  });\r\n\r\nexport const deleteProject = (id) =>\r\n  apiFetch(`/api/projects/${id}`, {\r\n    method: 'DELETE',\r\n  });\r\n\r\nexport const getProjectStats = () => {\r\n  console.log('üìä getProjectStats - Llamando a: /api/projects/stats');\r\n  const token = localStorage.getItem('token');\r\n  console.log('üìä getProjectStats - Token:', token ? 'Presente' : 'Ausente');\r\n  if (token) {\r\n    try {\r\n      const payload = JSON.parse(atob(token.split('.')[1]));\r\n      console.log('üìä getProjectStats - Usuario del token:', { id: payload.id, role: payload.role, name: payload.name });\r\n    } catch (e) {\r\n      console.log('üìä getProjectStats - Error decodificando token:', e.message);\r\n    }\r\n  }\r\n  \r\n  return apiFetch('/api/projects/stats').then(data => {\r\n    console.log('‚úÖ getProjectStats - Respuesta recibida:', data);\r\n    return data;\r\n  }).catch(error => {\r\n    console.error('‚ùå getProjectStats - Error:', error);\r\n    throw error;\r\n  });\r\n};\r\n\r\nexport const getExistingServices = () => {\r\n  console.log('üîç getExistingServices - Llamando a: /api/projects/services');\r\n  return apiFetch('/api/projects/services').then(data => {\r\n    console.log('‚úÖ getExistingServices - Respuesta recibida:', data);\r\n    return data;\r\n  }).catch(error => {\r\n    console.error('‚ùå getExistingServices - Error:', error);\r\n    throw error;\r\n  });\r\n};\r\n\r\nexport default { listProjects, createProject, getProject, updateProject, deleteProject, getProjectStats, getExistingServices };\r\n"],"names":["listProjects","params","sp","qs","path","apiFetch","data","error","createProject","payload","searchProjectsByName","name","company_id","updateProject","id","updateProjectStatus","updateProjectQueries","updateProjectMark","deleteProject","getProjectStats","token"],"mappings":"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"}