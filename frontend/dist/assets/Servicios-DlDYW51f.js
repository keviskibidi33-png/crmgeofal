import{r as d,a as q,L as P,j as s,s as t,Y as k,B as z,O as B,c as G,a6 as Q,Q as H,b as I,v as p,g as T}from"./index-Vrmn15ab.js";import{u as m}from"./useMutation-CW9zOA4W.js";import{u as R}from"./useQuery-C0PUex0E.js";import{P as x}from"./PageHeader-BlrN-WgO.js";import{D as f}from"./DataTable-C6GfqTma.js";import{M as _}from"./ModalForm-DmG8OU-6.js";import{d as O,l as U,c as V,u as Y}from"./services-DI7UyBF6.js";import{A as $}from"./Alert-DzwbTeBT.js";import"./InputGroup-BN0s6ecM.js";const S={name:"",area:"laboratorio"},J=[{value:"laboratorio",label:"Laboratorio"},{value:"comercial",label:"Comercial"},{value:"soporte",label:"Soporte"},{value:"sistemas",label:"Sistemas"},{value:"gerencia",label:"Gerencia"}];function ne(){const[h,r]=d.useState(!1),[a,o]=d.useState(null),[K,j]=d.useState(null),{user:n}=q(),y=["admin","jefe_laboratorio","jefa_comercial"].includes(n==null?void 0:n.role),N=P(),{data:i,isLoading:u}=R(["services"],()=>U(),{keepPreviousData:!0}),c=e=>{N.invalidateQueries("services"),r(!1),o(null),j(null)},g=m(V,{onSuccess:()=>c(),onError:e=>console.error("Error creating service:",e)}),v=m(Y,{onSuccess:()=>c(),onError:e=>console.error("Error updating service:",e)}),E=m(O,{onSuccess:()=>c(),onError:e=>console.error("Error deleting service:",e)}),C=()=>{o(S),r(!0)},M=e=>{o(e),r(!0)},w=e=>{window.confirm(`¿Estás seguro de que quieres eliminar el servicio "${e.name}"?`)&&E.mutate(e.id)},A=async e=>{a.id?await v.mutateAsync({id:a.id,...e}):await g.mutateAsync(e)},F=e=>{const l={laboratorio:{bg:"primary",text:"Laboratorio",icon:t},comercial:{bg:"success",text:"Comercial",icon:I},soporte:{bg:"info",text:"Soporte",icon:H},sistemas:{bg:"warning",text:"Sistemas",icon:Q},gerencia:{bg:"danger",text:"Gerencia",icon:G}}[e]||{bg:"secondary",text:e,icon:t},L=l.icon;return s.jsxs(p,{bg:l.bg,className:"status-badge d-flex align-items-center",children:[s.jsx(L,{size:12,className:"me-1"}),l.text]})},b=[{header:"ID",accessor:"id",width:"80px"},{header:"Nombre del Servicio",accessor:"name",render:e=>s.jsx("div",{className:"fw-medium",children:e})},{header:"Área",accessor:"area",render:e=>F(e)},{header:"Estado",accessor:"status",render:e=>s.jsxs(p,{bg:"success",className:"status-badge d-flex align-items-center",children:[s.jsx(T,{size:12,className:"me-1"}),"Activo"]})}],D=[{name:"name",label:"Nombre del Servicio",type:"text",required:!0,placeholder:"Ingresa el nombre del servicio"},{name:"area",label:"Área",type:"select",required:!0,options:J}];return y?s.jsxs("div",{className:"fade-in",children:[s.jsx(x,{title:"Gestión de Servicios",subtitle:"Crear, editar y gestionar servicios del sistema",icon:t,actions:s.jsxs(z,{variant:"primary",onClick:C,children:[s.jsx(B,{className:"me-2"}),"Nuevo Servicio"]})}),s.jsx(f,{data:(i==null?void 0:i.services)||[],columns:b,loading:u,onEdit:M,onDelete:w,emptyMessage:"No hay servicios registrados"}),s.jsx(_,{show:h,onHide:()=>r(!1),title:a!=null&&a.id?"Editar Servicio":"Nuevo Servicio",data:a||S,fields:D,onSubmit:A,loading:g.isLoading||v.isLoading,submitText:a!=null&&a.id?"Actualizar":"Crear"})]}):s.jsxs("div",{className:"fade-in",children:[s.jsx(x,{title:"Gestión de Servicios",subtitle:"Visualiza los servicios disponibles en el sistema",icon:t}),s.jsxs($,{variant:"warning",className:"d-flex align-items-center",children:[s.jsx(k,{className:"me-2"}),"No tienes permisos para gestionar servicios. Contacta al administrador."]}),s.jsx(f,{data:(i==null?void 0:i.services)||[],columns:b,loading:u,emptyMessage:"No hay servicios registrados"})]})}export{ne as default};
//# sourceMappingURL=Servicios-DlDYW51f.js.map
