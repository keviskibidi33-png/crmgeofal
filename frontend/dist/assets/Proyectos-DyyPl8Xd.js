import{r as n,e as ue,j as e,Q as gs,p as g,B as b,y as D,w as B,S as Oe,T as bs,n as X,k as O,b as vs,J as Ke,f as Y,o as K,g as Re,U as Ns,u as fs,V as ys,c as Ss,H as V,I as _s,W as Ue,L as Cs,m as $e,P as He,h as ws,X as Ve,x as ks,Y as we,s as Es,N as Ps}from"./index-CJuzvD_R.js";import{P as qs}from"./PageHeader-NoH3AoYJ.js";import{D as Fs}from"./DataTable-Dr__4Ol-.js";import{M as ke}from"./ModalForm-CRTtXpsx.js";import{S as xe}from"./StatsCard-D4P-ueZT.js";import{d as Ts,c as As,u as Is,a as Ms,b as zs,e as Ls,f as Ds,l as Bs,g as Gs}from"./projects-SlGmrIYM.js";import{l as Ee,u as Rs,d as Us,a as $s}from"./attachments-D37l2X9-.js";import{l as Hs,a as Vs}from"./services-BLi9-_Yr.js";import{C as o,R as G}from"./Row-B9arpL02.js";import{F as h}from"./Form-CKV1GU6x.js";import{S as Qe}from"./Spinner-BhrlrNe3.js";import{C as S}from"./Col-DXGSQkwi.js";import{A as je}from"./Alert-BTrAEOjL.js";import{P as Qs}from"./ProgressBar-DYkNRPhr.js";import{T as Os,a as Q}from"./Tabs-DOKdPQMy.js";import"./InputGroup-En6Uyfcr.js";import"./Table-Ct6XUerj.js";/* empty css                     */import"./Modal-VRH4uMZk.js";import"./ElementChildren-GtC5s3Ff.js";function Ks({selectedServices:y=[],onServicesChange:_}){const[v,w]=n.useState(""),[i,F]=n.useState(null),[N,A]=n.useState([]),{data:I,isLoading:W}=ue(["services"],()=>Hs({}),{staleTime:5*60*1e3,cacheTime:10*60*1e3}),{data:x,isLoading:Z}=ue(["subservices",i==null?void 0:i.id],()=>i?Vs({service_id:i.id}):null,{enabled:!!i,staleTime:5*60*1e3,cacheTime:10*60*1e3}),R=(I==null?void 0:I.data)||(I==null?void 0:I.rows)||[],T=(x==null?void 0:x.data)||(x==null?void 0:x.rows)||[],d=R.filter(r=>{var j,m;return((j=r.name)==null?void 0:j.toLowerCase().includes(v.toLowerCase()))||((m=r.description)==null?void 0:m.toLowerCase().includes(v.toLowerCase()))}),E=r=>{if(!y.some(m=>m.ensayo.id===r.id)){if(y.length>=5){alert("MÃ¡ximo 5 servicios pueden ser seleccionados");return}F(r),A([])}},ee=r=>{const j=N.some(m=>m.id===r.id);A(j?m=>m.filter(P=>P.id!==r.id):m=>[...m,r])},U=()=>{if(i&&N.length>0){const r={ensayo:i,subservices:N,total:N.reduce((j,m)=>j+(m.precio||0),0)};_([...y,r]),F(null),A([])}},l=r=>{const j=y.filter((m,P)=>P!==r);_(j)};return e.jsxs("div",{className:"service-selection",children:[e.jsxs(o,{className:"mb-4",children:[e.jsx(o.Header,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("h6",{className:"mb-0",children:[e.jsx(gs,{className:"me-2"}),"SelecciÃ³n de Servicios"]}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsxs(g,{bg:"info",children:[y.length,"/5 seleccionados"]}),y.length>0&&e.jsxs(b,{variant:"outline-danger",size:"sm",onClick:()=>_([]),children:[e.jsx(D,{size:12,className:"me-1"}),"Limpiar"]})]})]})}),e.jsxs(o.Body,{children:[e.jsx("div",{className:"mb-3",children:e.jsx(h.Control,{type:"text",placeholder:"Buscar servicios...",value:v,onChange:r=>w(r.target.value)})}),W?e.jsxs("div",{className:"text-center py-4",children:[e.jsx(Qe,{animation:"border",variant:"primary"}),e.jsx("p",{className:"mt-2 text-muted",children:"Cargando servicios..."})]}):e.jsx(G,{className:"g-3",children:d.map(r=>{const j=y.some(P=>P.ensayo.id===r.id),m=(i==null?void 0:i.id)===r.id;return e.jsx(S,{md:6,lg:4,children:e.jsx(o,{className:`h-100 cursor-pointer ${j?"border-success":m?"border-primary":""} ${j?"bg-light":""}`,onClick:()=>E(r),children:e.jsxs(o.Body,{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[e.jsx("h6",{className:"mb-1",children:r.name}),j?e.jsx(g,{bg:"success",children:e.jsx(B,{size:14})}):m?e.jsx(g,{bg:"primary",children:e.jsx(B,{size:14})}):null]}),e.jsx("p",{className:"text-muted small mb-2",children:r.description||"Sin descripciÃ³n"}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("small",{className:"text-muted",children:[e.jsx(Oe,{className:"me-1",size:12}),r.norma||"N/A"]}),e.jsxs(g,{bg:r.subservices_count>0?"info":"secondary",children:[r.subservices_count||0," subservicios"]})]})]})})},r.id)})}),i&&e.jsxs(o,{className:"mt-4 border-primary",children:[e.jsx(o.Header,{children:e.jsxs("h6",{className:"mb-0",children:["Subservicios de: ",i.name]})}),e.jsxs(o.Body,{children:[Z?e.jsxs("div",{className:"text-center py-3",children:[e.jsx(Qe,{animation:"border",size:"sm",variant:"primary"}),e.jsx("p",{className:"mt-2 text-muted small",children:"Cargando subservicios..."})]}):T.length>0?e.jsx(G,{className:"g-2",children:T.map(r=>{const j=N.some(m=>m.id===r.id);return e.jsx(S,{md:6,lg:4,children:e.jsx(o,{className:`h-100 cursor-pointer ${j?"border-success":""}`,onClick:()=>ee(r),children:e.jsxs(o.Body,{className:"p-3",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[e.jsx("h6",{className:"mb-1 small",children:r.codigo}),j&&e.jsx(g,{bg:"success",children:e.jsx(B,{size:12})})]}),e.jsx("p",{className:"text-muted small mb-2",children:r.descripcion}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("small",{className:"text-muted",children:r.norma||"-"}),e.jsxs(g,{bg:r.precio>0?"success":"warning",children:[e.jsx(bs,{className:"me-1",size:10}),r.precio>0?`S/ ${r.precio}`:"Sujeto a evaluaciÃ³n"]})]})]})})},r.id)})}):e.jsx(je,{variant:"info",className:"mb-0",children:"No hay subservicios disponibles para este servicio."}),N.length>0&&e.jsx("div",{className:"mt-3 text-center",children:e.jsxs(b,{variant:"success",onClick:U,disabled:N.length===0,children:[e.jsx(B,{className:"me-1"}),"Agregar ",N.length," subservicio(s) seleccionado(s)"]})})]})]})]})]}),y.length>0&&e.jsxs(o,{className:"border-success",children:[e.jsx(o.Header,{children:e.jsxs("h6",{className:"mb-0 text-success",children:[e.jsx(B,{className:"me-2"}),"Servicios Seleccionados (",y.length,")"]})}),e.jsx(o.Body,{children:y.map((r,j)=>e.jsx(o,{className:"mb-3",children:e.jsx(o.Body,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-start",children:[e.jsxs("div",{children:[e.jsx("h6",{className:"mb-1",children:r.ensayo.name}),e.jsx("p",{className:"text-muted small mb-2",children:r.ensayo.description}),e.jsx("div",{className:"d-flex flex-wrap gap-1",children:r.subservices.map((m,P)=>e.jsx(g,{bg:"info",className:"me-1",children:m.codigo},P))})]}),e.jsxs("div",{className:"text-end",children:[e.jsxs("h6",{className:"text-success mb-1",children:["S/ ",r.total.toFixed(2)]}),e.jsx(b,{variant:"outline-danger",size:"sm",onClick:()=>l(j),children:e.jsx(D,{size:14})})]})]})})},j))})]})]})}function Xe({onServicesChange:y,selectedServices:_=[]}){const v=w=>{y(w)};return e.jsxs(o,{className:"mb-4",children:[e.jsx(o.Header,{children:e.jsxs("h6",{className:"mb-0",children:[e.jsx(X,{className:"me-2"}),"ConfiguraciÃ³n de Servicios del Proyecto"]})}),e.jsxs(o.Body,{children:[e.jsxs(je,{variant:"info",className:"mb-4",children:[e.jsx(O,{className:"me-2"}),e.jsxs("div",{children:[e.jsx("strong",{children:"Servicios:"})," Selecciona los servicios que necesitas para este proyecto.",e.jsx("br",{}),e.jsx("small",{className:"text-muted",children:"Puedes elegir entre diferentes tipos de servicios (Laboratorio, IngenierÃ­a, etc.) y sus subservicios correspondientes. MÃ¡ximo 5 servicios."})]})]}),e.jsx(Ks,{selectedServices:_,onServicesChange:v}),_.length>0&&e.jsxs(o,{className:"border-success mt-4",children:[e.jsx(o.Header,{children:e.jsxs("h6",{className:"mb-0 text-success",children:[e.jsx(B,{className:"me-2"}),"Resumen de Servicios Seleccionados"]})}),e.jsx(o.Body,{children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Total de Servicios:"})," ",_.length]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Total de Subservicios:"})," ",_.reduce((w,i)=>w+i.subservices.length,0)]})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Subtotal:"})," S/ ",_.reduce((w,i)=>w+i.total,0).toFixed(2)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"IGV (18%):"})," S/ ",(_.reduce((w,i)=>w+i.total,0)*.18).toFixed(2)]}),e.jsxs("div",{className:"fw-bold text-success",children:[e.jsx("strong",{children:"Total:"})," S/ ",(_.reduce((w,i)=>w+i.total,0)*1.18).toFixed(2)]})]})]})})]})]})]})}const Xs=async(y,_)=>{try{const v=new URLSearchParams({type:y,q:_});return await vs(`/companies/search?${v.toString()}`)}catch(v){throw console.error("Error en bÃºsqueda de empresas:",v),v}};function Ws({data:y={},onSubmit:_,loading:v=!1,onCancel:w}){const[i,F]=n.useState({clientType:"",client_id:"",client_name:"",client_info:{},name:"",location:"",vendedor_id:"",laboratorio_id:"",contact_name:"",contact_phone:"",contact_email:"",queries:"",priority:"normal",marked:!1,selectedServices:[]}),[N,A]=n.useState(1),[I,W]=n.useState(!1),[x,Z]=n.useState({}),[R,T]=n.useState(""),[d,E]=n.useState([]),[ee,U]=n.useState(!1),[l,r]=n.useState(!1),j=4;n.useEffect(()=>{y&&F(c=>({...c,...y,selectedServices:y.selectedServices||[]}))},[y]);const m=(c,t)=>{F(k=>({...k,[c]:t})),x[c]&&Z(k=>({...k,[c]:null}))},P=c=>{F(t=>({...t,selectedServices:c}))},pe=async c=>{if(!c||c.length<2){E([]),r(!1);return}if(!i.clientType){E([]),r(!1);return}U(!0);try{const t=await Xs(i.clientType,c);t.success?(E(t.data||[]),r(!0)):(E([]),r(!1))}catch(t){console.error("Error en bÃºsqueda:",t),E([]),r(!1)}finally{U(!1)}},te=c=>{F(t=>({...t,client_id:c.id,client_name:c.name,client_info:c})),T(c.name),r(!1)},ge=()=>{F(c=>({...c,client_id:"",client_name:"",client_info:{}})),T(""),E([]),r(!1)},J=c=>{const t={};switch(c){case 1:i.clientType||(t.clientType="Selecciona el tipo de cliente"),i.client_id||(t.client_id="Selecciona un cliente"),i.name||(t.name="Nombre del proyecto es requerido"),i.location||(t.location="UbicaciÃ³n es requerida");break;case 2:i.contact_name||(t.contact_name="Persona de contacto es requerida"),i.contact_phone||(t.contact_phone="TelÃ©fono es requerido");break;case 3:i.selectedServices.length===0&&(t.services="Debes seleccionar al menos un servicio");break}return Z(t),Object.keys(t).length===0},se=()=>{J(N)&&A(c=>Math.min(c+1,j))},ne=()=>{A(c=>Math.max(c-1,1))},ae=()=>{J(N)&&_(i)},M=c=>{switch(c){case 1:return e.jsx(K,{});case 2:return e.jsx(Re,{});case 3:return e.jsx(X,{});case 4:return e.jsx(Y,{});default:return e.jsx(K,{})}},oe=c=>{switch(c){case 1:return"InformaciÃ³n BÃ¡sica";case 2:return"Contacto";case 3:return"Servicios";case 4:return"Resumen";default:return"Paso"}},q=()=>e.jsxs("div",{className:"step-content",children:[e.jsxs("h5",{className:"mb-4",children:[e.jsx(K,{className:"me-2"}),"InformaciÃ³n BÃ¡sica del Proyecto"]}),e.jsxs(G,{className:"g-3",children:[e.jsx(S,{md:12,children:e.jsxs(h.Group,{children:[e.jsx(h.Label,{className:"fw-bold",children:"Tipo de Cliente *"}),e.jsxs("div",{className:"d-flex gap-3",children:[e.jsx(h.Check,{type:"radio",id:"empresa",name:"clientType",label:"Empresa",checked:i.clientType==="empresa",onChange:()=>m("clientType","empresa"),className:"d-flex align-items-center"}),e.jsx(h.Check,{type:"radio",id:"persona_natural",name:"clientType",label:"Persona Natural",checked:i.clientType==="persona_natural",onChange:()=>m("clientType","persona_natural"),className:"d-flex align-items-center"})]}),x.clientType&&e.jsx(h.Control.Feedback,{type:"invalid",children:x.clientType})]})}),i.clientType&&e.jsx(S,{md:12,children:e.jsxs(h.Group,{children:[e.jsxs(h.Label,{className:"fw-bold",children:["Buscar ",i.clientType==="empresa"?"Empresa":"Persona Natural"," *"]}),e.jsxs("div",{className:"position-relative",children:[e.jsx(h.Control,{type:"text",value:R,onChange:c=>{const t=c.target.value;T(t),pe(t)},placeholder:`Buscar ${i.clientType==="empresa"?"empresa":"persona natural"}...`,isInvalid:!!x.client_id}),ee&&e.jsx("div",{className:"position-absolute top-50 end-0 translate-middle-y me-3",children:e.jsx("div",{className:"spinner-border spinner-border-sm",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Buscando..."})})}),l&&R&&e.jsx("div",{className:"position-absolute w-100 bg-white border rounded shadow-lg",style:{zIndex:1e3,maxHeight:"300px",overflowY:"auto"},children:d.length>0?d.map((c,t)=>e.jsxs("div",{className:"p-3 border-bottom cursor-pointer hover-bg-light",onClick:()=>te(c),children:[e.jsx("div",{className:"fw-bold",children:c.name}),e.jsxs("div",{className:"text-muted small",children:[i.clientType==="empresa"?c.ruc:c.dni," â€¢ ",c.address]})]},t)):e.jsx("div",{className:"p-3 text-muted text-center",children:"No se encontraron resultados"})})]}),x.client_id&&e.jsx(h.Control.Feedback,{type:"invalid",children:x.client_id})]})}),i.client_id&&e.jsx(S,{md:12,children:e.jsxs(o,{className:"border-success",children:[e.jsxs(o.Header,{className:"bg-success text-white d-flex justify-content-between align-items-center",children:[e.jsxs("h6",{className:"mb-0",children:[e.jsx(Y,{className:"me-2"}),"Cliente Seleccionado"]}),e.jsxs(b,{variant:"outline-light",size:"sm",onClick:ge,className:"d-flex align-items-center",children:[e.jsx(D,{className:"me-1"}),"Cambiar"]})]}),e.jsx(o.Body,{children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("strong",{children:"Nombre:"})," ",i.client_name]}),e.jsxs("div",{className:"col-md-6",children:[e.jsxs("strong",{children:[i.clientType==="empresa"?"RUC":"DNI",":"]})," ",i.client_info.ruc||i.client_info.dni]}),e.jsxs("div",{className:"col-md-12 mt-2",children:[e.jsx("strong",{children:"DirecciÃ³n:"})," ",i.client_info.address]}),i.client_info.phone&&e.jsxs("div",{className:"col-md-6 mt-2",children:[e.jsx("strong",{children:"TelÃ©fono:"})," ",i.client_info.phone]}),i.client_info.email&&e.jsxs("div",{className:"col-md-6 mt-2",children:[e.jsx("strong",{children:"Email:"})," ",i.client_info.email]})]})})]})}),e.jsx(S,{md:12,children:e.jsxs(h.Group,{children:[e.jsx(h.Label,{className:"fw-bold",children:"Nombre del Proyecto *"}),e.jsx(h.Control,{type:"text",value:i.name,onChange:c=>m("name",c.target.value),placeholder:"Ingresa el nombre del proyecto",isInvalid:!!x.name}),x.name&&e.jsx(h.Control.Feedback,{type:"invalid",children:x.name})]})}),e.jsx(S,{md:12,children:e.jsxs(h.Group,{children:[e.jsx(h.Label,{className:"fw-bold",children:"UbicaciÃ³n *"}),e.jsx(h.Control,{type:"text",value:i.location,onChange:c=>m("location",c.target.value),placeholder:"Ingresa la ubicaciÃ³n del proyecto",isInvalid:!!x.location}),x.location&&e.jsx(h.Control.Feedback,{type:"invalid",children:x.location})]})})]})]}),de=()=>e.jsxs("div",{className:"step-content",children:[e.jsxs("h5",{className:"mb-4",children:[e.jsx(Re,{className:"me-2"}),"InformaciÃ³n de Contacto"]}),e.jsxs(G,{className:"g-3",children:[e.jsx(S,{md:6,children:e.jsxs(h.Group,{children:[e.jsx(h.Label,{className:"fw-bold",children:"Persona de Contacto *"}),e.jsx(h.Control,{type:"text",value:i.contact_name,onChange:c=>m("contact_name",c.target.value),placeholder:"Nombre completo",isInvalid:!!x.contact_name}),x.contact_name&&e.jsx(h.Control.Feedback,{type:"invalid",children:x.contact_name})]})}),e.jsx(S,{md:6,children:e.jsxs(h.Group,{children:[e.jsx(h.Label,{className:"fw-bold",children:"TelÃ©fono *"}),e.jsx(h.Control,{type:"tel",value:i.contact_phone,onChange:c=>m("contact_phone",c.target.value),placeholder:"NÃºmero de telÃ©fono",isInvalid:!!x.contact_phone}),x.contact_phone&&e.jsx(h.Control.Feedback,{type:"invalid",children:x.contact_phone})]})}),e.jsx(S,{md:12,children:e.jsxs(h.Group,{children:[e.jsx(h.Label,{className:"fw-bold",children:"Email"}),e.jsx(h.Control,{type:"email",value:i.contact_email,onChange:c=>m("contact_email",c.target.value),placeholder:"Email para comunicaciÃ³n"})]})}),e.jsx(S,{md:12,children:e.jsxs(h.Group,{children:[e.jsx(h.Label,{className:"fw-bold",children:"Consultas/Notas"}),e.jsx(h.Control,{as:"textarea",rows:4,value:i.queries,onChange:c=>m("queries",c.target.value),placeholder:"Consultas, notas o comentarios adicionales"})]})})]})]}),be=()=>e.jsxs("div",{className:"step-content",children:[e.jsxs("h5",{className:"mb-4",children:[e.jsx(X,{className:"me-2"}),"SelecciÃ³n de Servicios"]}),e.jsx(je,{variant:"info",className:"mb-4",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(Ns,{className:"me-2"}),e.jsxs("div",{children:[e.jsx("strong",{children:"Selecciona los servicios que requiere este proyecto"}),e.jsx("br",{}),e.jsx("small",{children:"Puedes elegir entre servicios de Laboratorio o IngenierÃ­a"})]})]})}),e.jsxs("div",{className:"mb-4",children:[e.jsxs(b,{variant:"outline-primary",onClick:()=>W(!0),className:"w-100 py-3",size:"lg",children:[e.jsx(X,{className:"me-2"}),i.selectedServices.length>0?`Configurar Servicios (${i.selectedServices.length} seleccionados)`:"Seleccionar Servicios del Proyecto"]}),x.services&&e.jsx(je,{variant:"danger",className:"mt-2",children:x.services})]}),i.selectedServices.length>0&&e.jsxs(o,{className:"border-success",children:[e.jsx(o.Header,{className:"bg-success text-white",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx(Y,{className:"me-2"}),"Servicios Seleccionados (",i.selectedServices.length,")"]})}),e.jsxs(o.Body,{children:[i.selectedServices.map((c,t)=>e.jsx("div",{className:"mb-3 p-3 border rounded bg-light",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-start",children:[e.jsxs("div",{children:[e.jsx("h6",{className:"mb-1",children:c.ensayo.name}),e.jsx("p",{className:"text-muted small mb-2",children:c.ensayo.description}),e.jsx("div",{className:"d-flex flex-wrap gap-1",children:c.subservices.map((k,z)=>e.jsx(g,{bg:"info",className:"me-1",children:k.codigo},z))})]}),e.jsxs("div",{className:"text-end",children:[e.jsxs("div",{className:"fw-bold text-success h5 mb-1",children:["S/ ",c.total.toFixed(2)]}),e.jsx(b,{variant:"outline-danger",size:"sm",onClick:()=>{const k=i.selectedServices.filter((z,$)=>$!==t);P(k)},children:e.jsx(D,{size:12})})]})]})},t)),e.jsx("div",{className:"mt-3 pt-3 border-top",children:e.jsxs(G,{children:[e.jsxs(S,{md:6,children:[e.jsxs("div",{className:"d-flex justify-content-between mb-2",children:[e.jsx("span",{children:"Subtotal:"}),e.jsxs("strong",{children:["S/ ",i.selectedServices.reduce((c,t)=>c+t.total,0).toFixed(2)]})]}),e.jsxs("div",{className:"d-flex justify-content-between mb-2",children:[e.jsx("span",{children:"IGV (18%):"}),e.jsxs("span",{children:["S/ ",(i.selectedServices.reduce((c,t)=>c+t.total,0)*.18).toFixed(2)]})]})]}),e.jsx(S,{md:6,children:e.jsxs("div",{className:"d-flex justify-content-between fw-bold text-success h5",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{children:["S/ ",(i.selectedServices.reduce((c,t)=>c+t.total,0)*1.18).toFixed(2)]})]})})]})})]})]})]}),ie=()=>e.jsxs("div",{className:"step-content",children:[e.jsxs("h5",{className:"mb-4",children:[e.jsx(Y,{className:"me-2"}),"Resumen del Proyecto"]}),e.jsxs(G,{className:"g-4",children:[e.jsx(S,{md:6,children:e.jsxs(o,{children:[e.jsx(o.Header,{children:e.jsx("h6",{className:"mb-0",children:"InformaciÃ³n BÃ¡sica"})}),e.jsxs(o.Body,{children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Proyecto:"})," ",i.name]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"UbicaciÃ³n:"})," ",i.location]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Contacto:"})," ",i.contact_name]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"TelÃ©fono:"})," ",i.contact_phone]}),i.contact_email&&e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Email:"})," ",i.contact_email]})]})]})}),e.jsx(S,{md:6,children:e.jsxs(o,{children:[e.jsx(o.Header,{children:e.jsx("h6",{className:"mb-0",children:"Servicios Seleccionados"})}),e.jsx(o.Body,{children:i.selectedServices.length>0?e.jsxs("div",{children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Total de Servicios:"})," ",i.selectedServices.length]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Total de Subservicios:"})," ",i.selectedServices.reduce((c,t)=>c+t.subservices.length,0)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Subtotal:"})," S/ ",i.selectedServices.reduce((c,t)=>c+t.total,0).toFixed(2)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"IGV (18%):"})," S/ ",(i.selectedServices.reduce((c,t)=>c+t.total,0)*.18).toFixed(2)]}),e.jsxs("div",{className:"fw-bold text-success h5",children:[e.jsx("strong",{children:"Total:"})," S/ ",(i.selectedServices.reduce((c,t)=>c+t.total,0)*1.18).toFixed(2)]})]}):e.jsxs("div",{className:"text-muted",children:[e.jsx(D,{className:"me-1"}),"No hay servicios seleccionados"]})})]})})]}),i.queries&&e.jsxs(o,{className:"mt-4",children:[e.jsx(o.Header,{children:e.jsx("h6",{className:"mb-0",children:"Consultas/Notas"})}),e.jsx(o.Body,{children:e.jsx("p",{className:"mb-0",children:i.queries})})]})]});return e.jsxs("div",{className:"project-form-redesigned",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[e.jsx("h6",{className:"mb-0",children:"Progreso del Formulario"}),e.jsxs("span",{className:"text-muted",children:[N," de ",j]})]}),e.jsx(Qs,{now:N/j*100,variant:"primary",style:{height:"8px"}})]}),e.jsx("div",{className:"mb-4",children:e.jsx(G,{className:"g-2",children:Array.from({length:j},(c,t)=>{const k=t+1,z=k===N,$=k<N;return e.jsx(S,{md:3,children:e.jsxs("div",{className:`step-indicator text-center p-3 rounded ${z?"bg-primary text-white":$?"bg-success text-white":"bg-light"}`,style:{cursor:"pointer"},onClick:()=>A(k),children:[e.jsx("div",{className:"mb-2",children:M(k)}),e.jsx("div",{className:"small fw-bold",children:oe(k)})]})},k)})})}),e.jsx(o,{className:"mb-4",children:e.jsxs(o.Body,{children:[N===1&&q(),N===2&&de(),N===3&&be(),N===4&&ie()]})}),e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs(b,{variant:"outline-secondary",onClick:ne,disabled:N===1,children:[e.jsx(D,{className:"me-1"}),"Anterior"]}),e.jsxs("div",{children:[N<j?e.jsxs(b,{variant:"primary",onClick:se,className:"me-2",children:["Siguiente",e.jsx(Ke,{className:"ms-1"})]}):e.jsxs(b,{variant:"success",onClick:ae,disabled:v,className:"me-2",children:[v?"Creando...":"Crear Proyecto",e.jsx(Y,{className:"ms-1"})]}),e.jsx(b,{variant:"outline-danger",onClick:w,children:"Cancelar"})]})]}),I&&e.jsx("div",{className:"modal-backdrop",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",zIndex:1050,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{className:"modal-content bg-white rounded shadow-lg",style:{width:"90%",maxWidth:"1200px",maxHeight:"90vh",overflow:"auto"},children:[e.jsxs("div",{className:"modal-header p-4 border-bottom",children:[e.jsx("h5",{className:"mb-0",children:"Seleccionar Servicios del Proyecto"}),e.jsx(b,{variant:"outline-secondary",size:"sm",onClick:()=>W(!1),children:e.jsx(D,{})})]}),e.jsx("div",{className:"modal-body p-4",children:e.jsx(Xe,{selectedServices:i.selectedServices,onServicesChange:P})}),e.jsx("div",{className:"modal-footer p-4 border-top",children:e.jsxs(b,{variant:"success",onClick:()=>W(!1),children:[e.jsx(B,{className:"me-1"}),"Confirmar SelecciÃ³n"]})})]})})]})}const Js={company_id:"",name:"",location:"",vendedor_id:"",laboratorio_id:"",requiere_laboratorio:!1,requiere_ingenieria:!1,requiere_consultoria:!1,requiere_capacitacion:!1,requiere_auditoria:!1,contact_name:"",contact_phone:"",contact_email:"",queries:"",priority:"normal",marked:!1};function va(){var Le,De,Be,Ge;const[y,_]=n.useState(!1),[v,w]=n.useState(null),[i,F]=n.useState(null),[N,A]=n.useState(!1),[I,W]=n.useState(!1),[x,Z]=n.useState(!1),[R,T]=n.useState(!1),[d,E]=n.useState(null),[ee,U]=n.useState("view"),[l,r]=n.useState({}),[j,m]=n.useState(!1),[P,pe]=n.useState(""),[te,ge]=n.useState("success"),[J,se]=n.useState([]),[ne,ae]=n.useState(!1),[M,oe]=n.useState(null),[q,de]=n.useState([]),[be,ie]=n.useState(!1),[c,t]=n.useState(!0),[k,z]=n.useState(!1),[$,ve]=n.useState(1),[Pe,We]=n.useState(""),[qe,Je]=n.useState(""),[Fe,Ye]=n.useState(""),[Te,Ze]=n.useState(""),[Ae,es]=n.useState(""),[ss,Ie]=n.useState(!1);fs();const H=(Le=ys().state)==null?void 0:Le.selectedClient,me=Ss(),{data:C,isLoading:Me,refetch:as}=ue(["projects",$,Pe,qe,Fe,Te,Ae],()=>Bs({page:$,limit:20,search:Pe,status:qe,company_id:Fe,project_type:Te,priority:Ae}),{keepPreviousData:!0,refetchOnWindowFocus:!1,refetchOnMount:!1,staleTime:3e4,cacheTime:3e5,retry:2,retryDelay:1e3}),{data:L,isLoading:he}=ue(["projectStats"],Gs,{refetchOnWindowFocus:!1,refetchOnMount:!1,staleTime:6e4,cacheTime:3e5,retry:1,onSuccess:s=>{console.log("ðŸ“Š Frontend - EstadÃ­sticas recibidas:",s),console.log("ðŸ“Š Frontend - alta_prioridad:",s==null?void 0:s.alta_prioridad)}});n.useEffect(()=>{(async()=>{if(d!=null&&d.id)try{const a=await Ee(d.id);se(a)}catch(a){console.error("Error al cargar adjuntos:",a)}})()},[d==null?void 0:d.id,R]);const re=s=>{me.invalidateQueries("projects"),me.invalidateQueries("projectStats"),_(!1),w(null),F(null)},p=(s,a="success")=>{pe(s),ge(a),m(!0),setTimeout(()=>{m(!1)},5e3)},is=s=>{console.log("ðŸ” handleSearch - BÃºsqueda:",s),We(s),ve(1),Ie(!0),setTimeout(()=>Ie(!1),1e3)},rs=s=>{console.log("ðŸ” handleFilter - Filtros:",s),Je(s.status||""),Ye(s.company_id||""),Ze(s.project_type||""),es(s.priority||""),ve(1)},cs=s=>{const a=s.target.files[0];a&&oe(a)},ls=async()=>{if(!M||!(d!=null&&d.id)){p("âŒ Por favor selecciona un archivo","danger");return}ae(!0);try{const s=new FormData;s.append("file",M),s.append("description",`Archivo subido: ${M.name}`),await Rs(d.id,s);const a=await Ee(d.id);se(a),oe(null),ae(!1),p("âœ… Archivo subido correctamente","success")}catch(s){console.error("Error al subir archivo:",s),ae(!1),p("âŒ Error al subir archivo","danger")}},ts=async s=>{try{await Us(s),p("âœ… Archivo descargado correctamente","success")}catch(a){console.error("Error al descargar archivo:",a),p("âŒ Error al descargar archivo","danger")}},ns=async s=>{if(window.confirm("Â¿EstÃ¡s seguro de que quieres eliminar este archivo?"))try{await $s(s);const a=await Ee(d.id);se(a),p("âœ… Archivo eliminado correctamente","success")}catch(a){console.error("Error al eliminar archivo:",a),p("âŒ Error al eliminar archivo","danger")}},os=[{title:"Por Estado",options:[{label:"Pendientes",filter:{status:"pendiente"}},{label:"Activos",filter:{status:"activo"}},{label:"Completados",filter:{status:"completado"}},{label:"Cancelados",filter:{status:"cancelado"}}]},{title:"Por Prioridad",options:[{label:"ðŸ”´ Urgente",filter:{priority:"urgent"}},{label:"ðŸŸ  Alta",filter:{priority:"high"}},{label:"ðŸ”µ Activo",filter:{priority:"active"}},{label:"ðŸŸ¢ Normal",filter:{priority:"normal"}},{label:"ðŸ”µ Baja",filter:{priority:"low"}}]},{title:"Por Tipo de Proyecto",options:[{label:"AnÃ¡lisis de Suelos",filter:{project_type:"AnÃ¡lisis de Suelos"}},{label:"Estudio GeotÃ©cnico",filter:{project_type:"Estudio GeotÃ©cnico"}},{label:"EvaluaciÃ³n Ambiental",filter:{project_type:"EvaluaciÃ³n Ambiental"}},{label:"Control de Calidad",filter:{project_type:"Control de Calidad"}},{label:"AnÃ¡lisis de Agua",filter:{project_type:"AnÃ¡lisis de Agua"}},{label:"Estudio de Impacto",filter:{project_type:"Estudio de Impacto"}},{label:"AnÃ¡lisis QuÃ­mico",filter:{project_type:"AnÃ¡lisis QuÃ­mico"}},{label:"Pruebas de Laboratorio",filter:{project_type:"Pruebas de Laboratorio"}},{label:"InspecciÃ³n TÃ©cnica",filter:{project_type:"InspecciÃ³n TÃ©cnica"}},{label:"CertificaciÃ³n de Materiales",filter:{project_type:"CertificaciÃ³n de Materiales"}}]}],Ne=V(As,{onSuccess:()=>re(),onError:s=>console.error("Error creating project:",s)}),ce=V(({id:s,data:a})=>Is(s,a),{onSuccess:s=>{console.log("âœ… updateMutation - Success:",s),E(s),r(s),p("âœ… Proyecto actualizado exitosamente!","success"),me.invalidateQueries("projects")},onError:s=>{console.error("âŒ updateMutation - Error:",s),p("âŒ Error al actualizar proyecto","danger")}}),ds=V(Ts,{onSuccess:()=>re(),onError:s=>console.error("Error deleting project:",s)}),fe=V(({id:s,...a})=>Ms(s,a),{onSuccess:s=>{E(s),r(s),re()},onError:s=>console.error("Error updating project status:",s)}),ye=V(({id:s,...a})=>zs(s,a),{onSuccess:s=>{console.log("âœ… updateCategoriesMutation - Success:",s),E(s),r(s),p("âœ… CategorÃ­as guardadas correctamente!","success"),me.invalidateQueries("projects")},onError:s=>{console.error("âŒ updateCategoriesMutation - Error:",s),p("âŒ Error al guardar categorÃ­as","danger")}}),Se=V(({id:s,...a})=>Ls(s,a),{onSuccess:s=>{E(s),r(s),re()},onError:s=>console.error("Error updating project queries:",s)}),_e=V(({id:s,...a})=>Ds(s,a),{onSuccess:s=>{E(s),r(s),re()},onError:s=>console.error("Error updating project mark:",s)}),ms=s=>{w(s),_(!0)},ze=s=>{window.confirm(`Â¿EstÃ¡s seguro de que quieres eliminar el proyecto "${s.name}"?`)&&ds.mutate(s.id)},hs=s=>{console.log("ðŸ” handleViewProject - Project recibido:",s),console.log("ðŸ” handleViewProject - Project.id:",s==null?void 0:s.id),console.log("ðŸ” handleViewProject - Type of project.id:",typeof(s==null?void 0:s.id)),E(s);const a={...s,requiere_laboratorio:s.requiere_laboratorio||!1,requiere_ingenieria:s.requiere_ingenieria||!1,requiere_consultoria:s.requiere_consultoria||!1,requiere_capacitacion:s.requiere_capacitacion||!1,requiere_auditoria:s.requiere_auditoria||!1,marked:s.marked||!1,priority:s.priority||"normal",queries:s.queries||"",contact_name:s.contact_name||"",contact_phone:s.contact_phone||"",contact_email:s.contact_email||"",category_id:s.category_id||"",subcategory_id:s.subcategory_id||"",category_name:s.category_name||"",subcategory_name:s.subcategory_name||""};console.log("ðŸ” handleViewProject - editingData inicializado:",a),r(a),U("view"),T(!0)},xs=async s=>{v.id?await ce.mutateAsync({id:v.id,...s}):await Ne.mutateAsync(s)},us=s=>{const u={activo:{bg:"success",text:"Activo"},pendiente:{bg:"warning",text:"Pendiente"},completado:{bg:"primary",text:"Completado"},cancelado:{bg:"danger",text:"Cancelado"}}[s]||{bg:"secondary",text:s};return e.jsx(g,{bg:u.bg,className:"status-badge",children:u.text})},js=[{header:"ID",accessor:"id",width:"80px"},{header:"Proyecto",accessor:"name",render:(s,a)=>e.jsxs("div",{children:[e.jsx("div",{className:"fw-medium",children:a.name}),a.location&&e.jsxs("small",{className:"text-muted",children:[e.jsx(Ps,{size:12,className:"me-1"}),a.location]})]})},{header:"Tipo de Proyecto",accessor:"project_type",render:(s,a)=>{const u=a.project_type||"General";let f="secondary";switch(u){case"AnÃ¡lisis de Suelos":f="success";break;case"Estudio GeotÃ©cnico":f="primary";break;case"EvaluaciÃ³n Ambiental":f="info";break;case"Control de Calidad":f="warning";break;case"AnÃ¡lisis de Agua":f="info";break;case"Estudio de Impacto":f="danger";break;case"AnÃ¡lisis QuÃ­mico":f="primary";break;case"Pruebas de Laboratorio":f="success";break;case"InspecciÃ³n TÃ©cnica":f="warning";break;case"CertificaciÃ³n de Materiales":f="info";break;default:f="secondary"}return e.jsx(g,{bg:f,className:"px-2 py-1",children:u})}},{header:"CategorÃ­a",accessor:"category_name",render:(s,a)=>e.jsxs("div",{children:[a.category_name&&e.jsx(g,{bg:"primary",className:"px-2 py-1 mb-1 d-block",children:a.category_name}),a.subcategory_name&&e.jsx(g,{bg:"secondary",className:"px-2 py-1 d-block",children:a.subcategory_name}),!a.category_name&&e.jsx("span",{className:"text-muted",children:"Sin categorÃ­a"})]})},{header:"Empresa",accessor:"company_name",render:(s,a)=>e.jsxs("div",{children:[e.jsx("div",{className:"fw-medium",children:a.company_name||"Sin empresa"}),a.company_ruc&&e.jsxs("small",{className:"text-muted",children:["RUC: ",a.company_ruc]})]})},{header:"Estado",accessor:"status",render:s=>us(s||"activo")},{header:"Servicios Requeridos",accessor:"services",render:(s,a)=>e.jsxs("div",{className:"d-flex flex-wrap gap-1",children:[a.requiere_laboratorio&&e.jsxs(g,{bg:"info",className:"px-2 py-1",children:[e.jsx(O,{size:12,className:"me-1"}),"Laboratorio"]}),a.requiere_ingenieria&&e.jsxs(g,{bg:"primary",className:"px-2 py-1",children:[e.jsx(K,{size:12,className:"me-1"}),"IngenierÃ­a"]}),!a.requiere_laboratorio&&!a.requiere_ingenieria&&e.jsx(g,{bg:"secondary",className:"px-2 py-1",children:"Sin servicios"})]})},{header:"Prioridad",accessor:"priority",render:(s,a)=>{const f=(Ce=>{switch(Ce){case"urgent":return{emoji:"ðŸ”´",text:"Urgente",color:"text-danger",bgColor:"bg-danger"};case"high":return{emoji:"ðŸŸ ",text:"Alta",color:"text-warning",bgColor:"bg-warning"};case"active":return{emoji:"ðŸ”µ",text:"Activo",color:"text-info",bgColor:"bg-info"};case"low":return{emoji:"ðŸ”µ",text:"Baja",color:"text-primary",bgColor:"bg-primary"};case"normal":default:return{emoji:"ðŸŸ¢",text:"Normal",color:"text-success",bgColor:"bg-success"}}})(a.priority);return e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("span",{className:"me-2",style:{fontSize:"1.2em"},children:f.emoji}),e.jsx("span",{className:`small ${f.color} fw-medium`,children:f.text}),(a.priority==="urgent"||a.priority==="high")&&a.requiere_laboratorio&&e.jsx("span",{className:"ms-2",title:"Requiere atenciÃ³n prioritaria del laboratorio",children:e.jsx(Ue,{className:"text-warning",size:14})})]})}},{header:"Contacto",accessor:"contacto",render:(s,a)=>e.jsxs("div",{className:"small",children:[a.contact_name&&e.jsx("div",{children:e.jsx("strong",{children:a.contact_name})}),a.contact_phone&&e.jsx("div",{className:"text-muted",children:a.contact_phone}),a.contact_email&&e.jsx("div",{className:"text-muted",children:a.contact_email}),!a.contact_name&&!a.contact_phone&&!a.contact_email&&e.jsx("span",{className:"text-muted",children:"Sin contacto"})]})},{header:"Asignado a",accessor:"vendedor_name",render:(s,a)=>e.jsxs("div",{children:[a.vendedor_name&&e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(K,{size:14,className:"me-1 text-muted"}),e.jsx("span",{children:a.vendedor_name})]}),a.laboratorio_name&&e.jsxs("div",{className:"d-flex align-items-center mt-1",children:[e.jsx(O,{size:14,className:"me-1 text-muted"}),e.jsx("span",{className:"small text-muted",children:a.laboratorio_name})]})]})},{header:"Fecha CreaciÃ³n",accessor:"created_at",type:"date"}],ps=[{name:"company_id",label:"Empresa/Cliente",type:"select",required:!0,options:((De=C==null?void 0:C.companies)==null?void 0:De.map(s=>({value:s.id,label:`${s.name} (${s.ruc||s.dni||"Sin RUC/DNI"})`})))||[],description:"Selecciona un cliente existente o crea uno nuevo desde el mÃ³dulo de clientes"},{name:"name",label:"Nombre del Proyecto",type:"text",required:!0,placeholder:"Ingresa el nombre del proyecto"},{name:"location",label:"UbicaciÃ³n del Proyecto",type:"text",placeholder:"Ingresa la ubicaciÃ³n del proyecto",required:!0},{name:"contact_name",label:"Persona de Contacto",type:"text",placeholder:"Nombre de la persona con quien negociar",description:"Persona responsable del proyecto en el cliente"},{name:"contact_phone",label:"TelÃ©fono de Contacto",type:"text",placeholder:"TelÃ©fono para comunicaciÃ³n directa",description:"NÃºmero para llamadas urgentes o seguimiento"},{name:"contact_email",label:"Email de Contacto",type:"email",placeholder:"Email para comunicaciÃ³n",description:"Email para envÃ­o de reportes y documentos"},{name:"requiere_laboratorio",label:"Requiere Laboratorio",type:"checkbox",description:"Marcar si el proyecto necesita servicios de laboratorio"},{name:"requiere_ingenieria",label:"Requiere IngenierÃ­a",type:"checkbox",description:"Marcar si el proyecto necesita servicios de ingenierÃ­a"},{name:"requiere_consultoria",label:"Requiere ConsultorÃ­a",type:"checkbox",description:"Marcar si el proyecto necesita servicios de consultorÃ­a"},{name:"requiere_capacitacion",label:"Requiere CapacitaciÃ³n",type:"checkbox",description:"Marcar si el proyecto necesita servicios de capacitaciÃ³n"},{name:"requiere_auditoria",label:"Requiere AuditorÃ­a",type:"checkbox",description:"Marcar si el proyecto necesita servicios de auditorÃ­a"},{name:"queries",label:"Consultas del Cliente",type:"textarea",placeholder:"Ingresa las consultas o dudas del cliente...",description:"Preguntas o dudas especÃ­ficas del cliente sobre el proyecto"},{name:"services",label:"Servicios del Proyecto",type:"custom",component:e.jsxs("div",{children:[e.jsx("div",{className:"mb-3",children:e.jsxs(b,{variant:"outline-primary",onClick:()=>ie(!0),className:"w-100",children:[e.jsx(X,{className:"me-2"}),q.length>0?`Configurar Servicios (${q.length} seleccionados)`:"Seleccionar Servicios"]})}),q.length>0&&e.jsxs("div",{className:"border rounded p-3 bg-light",children:[e.jsx("h6",{className:"mb-2",children:"Servicios Seleccionados:"}),q.map((s,a)=>e.jsx("div",{className:"mb-2 p-2 border rounded bg-white",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-start",children:[e.jsxs("div",{children:[e.jsx("strong",{children:s.ensayo.name}),e.jsx("div",{className:"small text-muted",children:s.subservices.map(u=>u.codigo).join(", ")})]}),e.jsxs("div",{className:"text-end",children:[e.jsxs("div",{className:"fw-bold text-success",children:["S/ ",s.total.toFixed(2)]}),e.jsx(b,{variant:"outline-danger",size:"sm",onClick:()=>{const u=q.filter((f,Ce)=>Ce!==a);de(u)},children:e.jsx(D,{size:12})})]})]})},a)),e.jsxs("div",{className:"mt-2 pt-2 border-top",children:[e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("strong",{children:"Subtotal:"}),e.jsxs("strong",{children:["S/ ",q.reduce((s,a)=>s+a.total,0).toFixed(2)]})]}),e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("span",{children:"IGV (18%):"}),e.jsxs("span",{children:["S/ ",(q.reduce((s,a)=>s+a.total,0)*.18).toFixed(2)]})]}),e.jsxs("div",{className:"d-flex justify-content-between fw-bold text-success",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{children:["S/ ",(q.reduce((s,a)=>s+a.total,0)*1.18).toFixed(2)]})]})]})]})]})},{name:"priority",label:"Prioridad del Proyecto",type:"select",options:[{value:"low",label:"Baja"},{value:"normal",label:"Normal"},{value:"high",label:"Alta"},{value:"urgent",label:"Urgente"}],description:"Nivel de prioridad para la ejecuciÃ³n del proyecto"},{name:"vendedor_id",label:"Vendedor Asignado",type:"select",options:((Be=C==null?void 0:C.users)==null?void 0:Be.filter(s=>["vendedor_comercial","jefa_comercial"].includes(s.role)).map(s=>({value:s.id,label:`${s.name} ${s.apellido}`})))||[]},{name:"laboratorio_id",label:"Responsable de Laboratorio",type:"select",options:((Ge=C==null?void 0:C.users)==null?void 0:Ge.filter(s=>["jefe_laboratorio","usuario_laboratorio","laboratorio"].includes(s.role)).map(s=>({value:s.id,label:`${s.name} ${s.apellido}`})))||[]}],le=n.useMemo(()=>{if(L)return console.log("ðŸ“Š Stats - Usando estadÃ­sticas reales del backend:",L),{total:L.total||0,activos:L.activos||0,completados:L.completados||0,pendientes:L.pendientes||0,cancelados:L.cancelados||0,alta_prioridad:L.alta_prioridad||0};const s=(C==null?void 0:C.data)||[];return console.log("ðŸ“Š Stats - Fallback: calculando desde pÃ¡gina actual:",s),{total:s.length,activos:s.filter(a=>a.status==="activo").length,completados:s.filter(a=>a.status==="completado").length,pendientes:s.filter(a=>a.status==="pendiente").length,cancelados:s.filter(a=>a.status==="cancelado").length,alta_prioridad:s.filter(a=>a.priority==="urgent"||a.priority==="high").length}},[L,C]);return e.jsxs(e.Fragment,{children:[e.jsx(_s,{fluid:!0,className:"py-4",children:e.jsxs("div",{className:"fade-in",children:[e.jsx(qs,{title:"GestiÃ³n de Proyectos",subtitle:H?`Crear proyecto para: ${H.name}`:"Crear, editar y gestionar proyectos del sistema",icon:O,actions:e.jsxs("div",{className:"d-flex gap-2",children:[H&&e.jsxs(g,{bg:"info",className:"px-3 py-2 d-flex align-items-center",children:[e.jsx(K,{className:"me-1"}),"Cliente: ",H.name]}),e.jsxs(b,{variant:"primary",onClick:()=>z(!0),children:[e.jsx(Ke,{className:"me-2"}),H?"Crear Proyecto":"Nuevo Proyecto"]})]})}),e.jsxs(G,{className:"g-4 mb-4",children:[e.jsx(S,{md:6,lg:3,children:e.jsx(xe,{title:"Total Proyectos",value:le.total,icon:O,color:"primary",subtitle:"Proyectos registrados",loading:he})}),e.jsx(S,{md:6,lg:3,children:e.jsx(xe,{title:"Proyectos Activos",value:le.activos,icon:Y,color:"success",subtitle:"En desarrollo",loading:he})}),e.jsx(S,{md:6,lg:3,children:e.jsx(xe,{title:"Alta Prioridad",value:le.alta_prioridad||0,icon:Ue,color:"danger",subtitle:"ðŸ”´ Urgente + ðŸŸ  Alta",loading:he})}),e.jsx(S,{md:6,lg:3,children:e.jsx(xe,{title:"Pendientes",value:le.pendientes,icon:Oe,color:"warning",subtitle:"Por iniciar",loading:he})})]}),e.jsxs(o,{className:"shadow-sm border-0",children:[e.jsx(o.Header,{className:"bg-white border-bottom",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("h5",{className:"mb-0",children:[e.jsx(O,{className:"me-2 text-primary"}),"Lista de Proyectos"]}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx(b,{variant:"outline-secondary",size:"sm",onClick:()=>as(),className:"d-flex align-items-center",title:"Actualizar datos",children:e.jsx(Cs,{className:`${Me?"spinning":""}`})}),e.jsxs(g,{bg:"light",text:"dark",className:"px-3 py-2",children:[le.total," proyectos"]})]})]})}),e.jsx(o.Body,{className:"p-0",children:e.jsx(Fs,{data:(C==null?void 0:C.data)||[],columns:js,loading:Me||ss,onEdit:ms,onDelete:ze,actions:[{label:"Gestionar",icon:$e,onClick:hs,variant:"outline-primary"},{label:"Eliminar",icon:He,onClick:ze,variant:"outline-danger"}],emptyMessage:"No hay proyectos registrados",totalItems:(C==null?void 0:C.total)||0,itemsPerPage:20,currentPage:$,onPageChange:ve,onSearch:is,onFilter:rs,filterOptions:os,getRowClassName:s=>s.status==="cancelado"?"table-secondary opacity-50 text-muted":""})})]}),e.jsx(ke,{show:y,onHide:()=>_(!1),title:v!=null&&v.id?"Editar Proyecto":"Nuevo Proyecto",data:v||Js,fields:ps,onSubmit:xs,loading:Ne.isLoading||ce.isLoading,submitText:v!=null&&v.id?"Actualizar":"Crear"}),e.jsx(ke,{show:R,onHide:()=>T(!1),title:`Gestionar Proyecto - ${(d==null?void 0:d.name)||""}`,data:l,fields:[{name:"project_management",label:"GestiÃ³n del Proyecto",type:"custom",render:s=>e.jsxs(Os,{activeKey:ee,onSelect:a=>U(a),className:"mb-3",children:[e.jsx(Q,{eventKey:"view",title:e.jsxs("span",{children:[e.jsx($e,{className:"me-1"}),"Ver"]}),children:e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"border rounded p-3 h-100",children:[e.jsxs("h6",{className:"text-primary mb-3",children:[e.jsx(O,{className:"me-2"}),"Datos Generales"]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"ID:"})," ",s.id]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Nombre:"})," ",s.name]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"UbicaciÃ³n:"})," ",s.location]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Tipo:"}),e.jsx(g,{bg:"info",className:"ms-2",children:s.project_type})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Estado:"}),e.jsx(g,{bg:"primary",className:"ms-2",children:s.status})]})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"border rounded p-3 h-100",children:[e.jsxs("h6",{className:"text-success mb-3",children:[e.jsx(K,{className:"me-2"}),"InformaciÃ³n de Contacto"]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Empresa:"})," ",s.company_name]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"RUC:"})," ",s.company_ruc]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Contacto:"})," ",s.contact_name||"Sin contacto"]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"TelÃ©fono:"})," ",s.contact_phone||"Sin telÃ©fono"]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Email:"})," ",s.contact_email||"Sin email"]})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"border rounded p-3 h-100",children:[e.jsxs("h6",{className:"text-warning mb-3",children:[e.jsx(X,{className:"me-2"}),"Servicios Requeridos"]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Laboratorio:"}),s.requiere_laboratorio?e.jsx(g,{bg:"info",className:"ms-2",children:"Requerido"}):e.jsx(g,{bg:"secondary",className:"ms-2",children:"No requerido"})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"IngenierÃ­a:"}),s.requiere_ingenieria?e.jsx(g,{bg:"success",className:"ms-2",children:"Requerido"}):e.jsx(g,{bg:"secondary",className:"ms-2",children:"No requerido"})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Estado Lab:"}),e.jsx(g,{bg:"info",className:"ms-2",children:s.laboratorio_status})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Estado Ing:"}),e.jsx(g,{bg:"success",className:"ms-2",children:s.ingenieria_status})]})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"border rounded p-3 h-100",children:[e.jsxs("h6",{className:"text-info mb-3",children:[e.jsx(ws,{className:"me-2"}),"Asignaciones"]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Vendedor:"})," ",s.vendedor_name||"Sin asignar"]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Laboratorio:"})," ",s.laboratorio_name||"Sin asignar"]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Fecha CreaciÃ³n:"})," ",new Date(s.created_at).toLocaleDateString()]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Ãšltima ActualizaciÃ³n:"})," ",new Date(s.updated_at).toLocaleDateString()]})]})}),s.status_notes&&e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"border rounded p-3",children:[e.jsxs("h6",{className:"text-muted mb-3",children:[e.jsx(Ve,{className:"me-2"}),"Notas del Estado"]}),e.jsx("p",{className:"mb-0",children:s.status_notes})]})})]})}),e.jsx(Q,{eventKey:"edit",title:e.jsxs("span",{children:[e.jsx(ks,{className:"me-1"}),"Editar"]}),children:e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Nombre del Proyecto"}),e.jsx("input",{type:"text",className:"form-control",value:l.name||"",onChange:a=>r({...l,name:a.target.value})})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"UbicaciÃ³n"}),e.jsx("input",{type:"text",className:"form-control",value:l.location||"",onChange:a=>r({...l,location:a.target.value})})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Persona de Contacto"}),e.jsx("input",{type:"text",className:"form-control",value:l.contact_name||"",onChange:a=>r({...l,contact_name:a.target.value})})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"TelÃ©fono de Contacto"}),e.jsx("input",{type:"text",className:"form-control",value:l.contact_phone||"",onChange:a=>r({...l,contact_phone:a.target.value})})]})}),e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Email de Contacto"}),e.jsx("input",{type:"email",className:"form-control",value:l.contact_email||"",onChange:a=>r({...l,contact_email:a.target.value})})]})}),e.jsx("div",{className:"col-12",children:e.jsx(b,{variant:"primary",onClick:()=>{const a=d==null?void 0:d.id;if(!a){console.error("No se encontrÃ³ el ID del proyecto"),p("âŒ Error: No se encontrÃ³ el ID del proyecto","danger");return}const u=typeof a=="object"?a.id:a;ce.mutate({id:u,data:l},{onSuccess:f=>{p("âœ… Proyecto actualizado exitosamente!","success")},onError:f=>{console.error("âŒ Guardar Cambios - Error:",f),p("âŒ Error al actualizar proyecto","danger")}})},disabled:ce.isLoading,children:ce.isLoading?"Guardando...":"Guardar Cambios"})})]})}),e.jsx(Q,{eventKey:"status",title:e.jsxs("span",{children:[e.jsx(X,{className:"me-1"}),"Estado"]}),children:e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Estado del Proyecto"}),e.jsxs("select",{className:"form-select",value:l.status||"",onChange:a=>r({...l,status:a.target.value}),children:[e.jsx("option",{value:"pendiente",children:"Pendiente"}),e.jsx("option",{value:"activo",children:"Activo"}),e.jsx("option",{value:"en_proceso",children:"En Proceso"}),e.jsx("option",{value:"completado",children:"Completado"}),e.jsx("option",{value:"pausado",children:"Pausado"}),e.jsx("option",{value:"cancelado",children:"Cancelado"})]})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Estado del Laboratorio"}),e.jsxs("select",{className:"form-select",value:l.laboratorio_status||"",onChange:a=>r({...l,laboratorio_status:a.target.value}),children:[e.jsx("option",{value:"no_requerido",children:"No Requerido"}),e.jsx("option",{value:"pendiente",children:"Pendiente"}),e.jsx("option",{value:"en_proceso",children:"En Proceso"}),e.jsx("option",{value:"completado",children:"Completado"}),e.jsx("option",{value:"pausado",children:"Pausado"}),e.jsx("option",{value:"cancelado",children:"Cancelado"})]})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Estado de IngenierÃ­a"}),e.jsxs("select",{className:"form-select",value:l.ingenieria_status||"",onChange:a=>r({...l,ingenieria_status:a.target.value}),children:[e.jsx("option",{value:"no_requerido",children:"No Requerido"}),e.jsx("option",{value:"pendiente",children:"Pendiente"}),e.jsx("option",{value:"en_proceso",children:"En Proceso"}),e.jsx("option",{value:"completado",children:"Completado"}),e.jsx("option",{value:"pausado",children:"Pausado"}),e.jsx("option",{value:"cancelado",children:"Cancelado"})]})]})}),e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Notas del Estado"}),e.jsx("textarea",{className:"form-control",rows:"3",value:l.status_notes||"",onChange:a=>r({...l,status_notes:a.target.value}),placeholder:"Agrega comentarios sobre el cambio de estado..."})]})}),e.jsx("div",{className:"col-12",children:e.jsx(b,{variant:"success",onClick:()=>{const a=d==null?void 0:d.id;if(!a){console.error("No se encontrÃ³ el ID del proyecto"),p("âŒ Error: No se encontrÃ³ el ID del proyecto","danger");return}fe.mutate({id:a,...l},{onSuccess:u=>{console.log("âœ… Actualizar Estado - Ã‰xito:",u),p("âœ… Estado actualizado correctamente!","success")},onError:u=>{console.error("âŒ Actualizar Estado - Error:",u),p("âŒ Error al actualizar estado","danger")}})},disabled:fe.isLoading,children:fe.isLoading?"Actualizando...":"Actualizar Estado"})})]})}),e.jsx(Q,{eventKey:"categories",title:e.jsxs("span",{children:[e.jsx(we,{className:"me-1"}),"CategorÃ­as"]}),children:e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12",children:[e.jsx("h6",{className:"mb-3",children:"CategorÃ­as del Proyecto"}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:"cat_laboratorio",checked:l.requiere_laboratorio||!1,onChange:a=>{console.log("ðŸ” requiere_laboratorio onChange:",a.target.checked),r({...l,requiere_laboratorio:a.target.checked})}}),e.jsx("label",{className:"form-check-label",htmlFor:"cat_laboratorio",children:"Laboratorio"})]}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:"cat_ingenieria",checked:l.requiere_ingenieria||!1,onChange:a=>r({...l,requiere_ingenieria:a.target.checked})}),e.jsx("label",{className:"form-check-label",htmlFor:"cat_ingenieria",children:"IngenierÃ­a"})]}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:"cat_consultoria",checked:l.requiere_consultoria||!1,onChange:a=>r({...l,requiere_consultoria:a.target.checked})}),e.jsx("label",{className:"form-check-label",htmlFor:"cat_consultoria",children:"ConsultorÃ­a"})]}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:"cat_capacitacion",checked:l.requiere_capacitacion||!1,onChange:a=>r({...l,requiere_capacitacion:a.target.checked})}),e.jsx("label",{className:"form-check-label",htmlFor:"cat_capacitacion",children:"CapacitaciÃ³n"})]}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:"cat_auditoria",checked:l.requiere_auditoria||!1,onChange:a=>r({...l,requiere_auditoria:a.target.checked})}),e.jsx("label",{className:"form-check-label",htmlFor:"cat_auditoria",children:"AuditorÃ­a"})]})]}),e.jsx("div",{className:"col-12",children:e.jsx(b,{variant:"info",onClick:()=>{const a=d==null?void 0:d.id;if(!a){console.error("No se encontrÃ³ el ID del proyecto"),p("âŒ Error: No se encontrÃ³ el ID del proyecto","danger");return}ye.mutate({id:a,requiere_laboratorio:l.requiere_laboratorio||!1,requiere_ingenieria:l.requiere_ingenieria||!1,requiere_consultoria:l.requiere_consultoria||!1,requiere_capacitacion:l.requiere_capacitacion||!1,requiere_auditoria:l.requiere_auditoria||!1},{onSuccess:u=>{console.log("âœ… Guardar CategorÃ­as - Ã‰xito:",u),p("âœ… CategorÃ­as guardadas correctamente!","success")},onError:u=>{console.error("âŒ Guardar CategorÃ­as - Error:",u),p("âŒ Error al guardar categorÃ­as","danger")}})},disabled:ye.isLoading,children:ye.isLoading?"Guardando...":"Guardar CategorÃ­as"})})]})}),e.jsx(Q,{eventKey:"queries",title:e.jsxs("span",{children:[e.jsx(Ve,{className:"me-1"}),"Consultas"]}),children:e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Consultas y Dudas del Cliente"}),e.jsx("textarea",{className:"form-control",rows:"8",value:l.queries||"",onChange:a=>r({...l,queries:a.target.value}),placeholder:"Ingresa las consultas o dudas del cliente..."})]})}),e.jsx("div",{className:"col-12",children:e.jsx(b,{variant:"warning",onClick:()=>{const a=d==null?void 0:d.id;if(!a){console.error("No se encontrÃ³ el ID del proyecto"),p("âŒ Error: No se encontrÃ³ el ID del proyecto","danger");return}Se.mutate({id:a,queries:l.queries||""},{onSuccess:u=>{console.log("âœ… Guardar Consultas - Ã‰xito:",u),p("âœ… Consultas guardadas correctamente!","success")},onError:u=>{console.error("âŒ Guardar Consultas - Error:",u),p("âŒ Error al guardar consultas","danger")}})},disabled:Se.isLoading,children:Se.isLoading?"Guardando...":"Guardar Consultas"})})]})}),e.jsx(Q,{eventKey:"mark",title:e.jsxs("span",{children:[e.jsx(B,{className:"me-1"}),"Marcar"]}),children:e.jsx("div",{className:"row g-3",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h6",{className:"mb-3",children:"Marcar Proyecto"}),e.jsx("p",{className:"text-muted mb-4",children:"Marca este proyecto para seguimiento especial o prioridad alta."}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Prioridad"}),e.jsxs("select",{className:"form-select",value:l.priority||"normal",onChange:a=>r({...l,priority:a.target.value}),children:[e.jsx("option",{value:"low",children:"Baja"}),e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"active",children:"Activo"}),e.jsx("option",{value:"high",children:"Alta"}),e.jsx("option",{value:"urgent",children:"Urgente"})]})]}),e.jsxs(b,{variant:"success",size:"lg",onClick:()=>{const a=d==null?void 0:d.id;if(!a){console.error("No se encontrÃ³ el ID del proyecto"),p("âŒ Error: No se encontrÃ³ el ID del proyecto","danger");return}_e.mutate({id:a,marked:!l.marked,priority:l.priority||"normal"},{onSuccess:u=>{console.log("âœ… Marcar Proyecto - Ã‰xito:",u);const f=l.marked?"desmarcado":"marcado";p(`âœ… Proyecto ${f} correctamente!`,"success")},onError:u=>{console.error("âŒ Marcar Proyecto - Error:",u),p("âŒ Error al marcar proyecto","danger")}})},disabled:_e.isLoading,children:[e.jsx(B,{className:"me-2"}),_e.isLoading?"Procesando...":l.marked?"Desmarcar Proyecto":"Marcar Proyecto"]})]})})})}),e.jsx(Q,{eventKey:"attachments",title:e.jsxs("span",{children:[e.jsx(we,{className:"me-1"}),"Adjuntos"]}),children:e.jsx("div",{className:"row g-3",children:e.jsxs("div",{className:"col-12",children:[e.jsx("h6",{className:"mb-3",children:"GestiÃ³n de Archivos"}),e.jsxs("div",{className:"card mb-4",children:[e.jsx("div",{className:"card-header",children:e.jsx("h6",{className:"mb-0",children:"Subir Nuevo Archivo"})}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Seleccionar Archivo"}),e.jsx("input",{type:"file",className:"form-control",onChange:cs,accept:".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.jpg,.jpeg,.png,.gif,.txt"}),e.jsx("div",{className:"form-text",children:"Formatos permitidos: PDF, DOC, DOCX, XLS, XLSX, PPT, PPTX, JPG, JPEG, PNG, GIF, TXT (mÃ¡x. 10MB)"})]}),M&&e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"alert alert-info",children:[e.jsx("strong",{children:"Archivo seleccionado:"})," ",M.name,e.jsx("br",{}),e.jsxs("small",{children:["TamaÃ±o: ",(M.size/1024/1024).toFixed(2)," MB"]})]})}),e.jsx(b,{variant:"primary",onClick:ls,disabled:!M||ne,children:ne?"Subiendo...":"Subir Archivo"})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h6",{className:"mb-0",children:["Archivos Adjuntos (",J.length,")"]})}),e.jsx("div",{className:"card-body",children:J.length===0?e.jsxs("div",{className:"text-center text-muted py-4",children:[e.jsx(we,{size:48,className:"mb-3"}),e.jsx("p",{children:"No hay archivos adjuntos"}),e.jsx("small",{children:"Sube archivos como cotizaciones, documentos tÃ©cnicos, etc."})]}):e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-hover",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Archivo"}),e.jsx("th",{children:"TamaÃ±o"}),e.jsx("th",{children:"Fecha"}),e.jsx("th",{children:"Subido por"}),e.jsx("th",{children:"Acciones"})]})}),e.jsx("tbody",{children:J.map(a=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{children:[e.jsx("strong",{children:a.original_name}),a.description&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("small",{className:"text-muted",children:a.description})]})]})}),e.jsx("td",{children:a.file_size?`${(a.file_size/1024/1024).toFixed(2)} MB`:"N/A"}),e.jsx("td",{children:new Date(a.created_at).toLocaleDateString()}),e.jsx("td",{children:a.uploaded_by_name||"Usuario"}),e.jsx("td",{children:e.jsxs("div",{className:"btn-group btn-group-sm",children:[e.jsx(b,{variant:"outline-primary",size:"sm",onClick:()=>ts(a),title:"Descargar",children:e.jsx(Es,{size:14})}),e.jsx(b,{variant:"outline-danger",size:"sm",onClick:()=>ns(a.id),title:"Eliminar",children:e.jsx(He,{size:14})})]})})]},a.id))})]})})})]})]})})})]})}],onSubmit:()=>T(!1),submitText:"Cerrar",size:"xl"})]})}),j&&e.jsxs("div",{style:{position:"fixed",top:"20px",right:"20px",zIndex:99999,backgroundColor:te==="success"?"#28a745":"#dc3545",color:"white",padding:"15px 20px",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.3)",minWidth:"300px",border:"none"},onClick:()=>m(!1),children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"5px"},children:te==="success"?"âœ… Ã‰xito":"âŒ Error"}),e.jsx("div",{children:P})]}),e.jsx(ke,{show:be,onHide:()=>ie(!1),title:"Seleccionar Servicios del Proyecto",size:"xl",data:{},fields:[],onSubmit:()=>ie(!1),loading:!1,submitText:"Cerrar",customBody:e.jsx(Xe,{selectedServices:q,onServicesChange:de,serviceType:"laboratorio"})}),k&&e.jsx("div",{className:"modal-backdrop",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",zIndex:1050,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{className:"modal-content bg-white rounded shadow-lg",style:{width:"90%",maxWidth:"1200px",maxHeight:"90vh",overflow:"auto"},children:[e.jsxs("div",{className:"modal-header p-4 border-bottom d-flex justify-content-between align-items-center",children:[e.jsx("h5",{className:"mb-0",children:"Crear Nuevo Proyecto"}),e.jsx(b,{variant:"outline-secondary",size:"sm",onClick:()=>z(!1),children:e.jsx(D,{})})]}),e.jsx("div",{className:"modal-body p-4",children:e.jsx(Ws,{data:H?{company_id:H.id}:{},onSubmit:s=>{console.log("Datos del formulario:",s),z(!1)},onCancel:()=>z(!1),loading:Ne.isLoading})})]})})]})}export{va as default};
//# sourceMappingURL=Proyectos-DyyPl8Xd.js.map
