import{r as o,u as I,b as G,j as e,ak as j,B as u,A as X,y as J,h as f,t as y,V as z,X as K,l as _,C as b}from"./index-Cuktr-pt.js";import{P as O}from"./PageHeader-BYHPV7CG.js";import{S as d}from"./StatsCard-BrhQkFRp.js";import{C,R as t}from"./Row-DXxIMG7u.js";import{S as x}from"./Spinner-B39M6lL3.js";import{A as N}from"./Alert-D03HJGca.js";import{C as i}from"./Col-nNxAn9NL.js";import{C as l}from"./Card-B0ZWfcwD.js";/* empty css                  */function le(){var D,A,$,L,k,B;const[s,H]=o.useState(null),[T,w]=o.useState(!0),[g,h]=o.useState(null),[E,S]=o.useState(!1),[r,R]=o.useState(null),[M,m]=o.useState(null),[F,V]=o.useState(null),p=I();o.useEffect(()=>{P()},[]);const P=async(a=!1)=>{try{a?S(!0):w(!0),h(null),m(null);const c=await G("/api/role-dashboard/vendedor-comercial");if(!c)throw new Error("No se recibieron datos del servidor");H(c),V(new Date),a&&(m("Datos actualizados correctamente"),setTimeout(()=>m(null),3e3))}catch(c){console.error("Error fetching dashboard data:",c);const n=c.message||"Error al cargar los datos del dashboard. Por favor, int√©ntalo de nuevo.";h(n)}finally{w(!1),S(!1)}},U=()=>{P(!0)},v=async(a,c)=>{try{switch(R(a),h(null),m(null),await new Promise(n=>setTimeout(n,1e3)),a){case"nueva-cotizacion":p("/cotizacion-inteligente");break;case"ver-clientes":p("/clientes");break;case"ver-proyectos":p("/proyectos");break;case"enviar-comprobante":p("/comprobantes-pago");break;default:throw new Error(`Acci√≥n ${a} no implementada`)}m(`${c} ejecutado correctamente`),setTimeout(()=>m(null),2e3)}catch(n){console.error(`Error en acci√≥n ${a}:`,n);const q=n.message||`Error al ejecutar ${c}. Por favor, int√©ntalo de nuevo.`;h(q)}finally{R(null)}};return T?e.jsx(C,{fluid:!0,className:"p-4",children:e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"400px"},children:e.jsx(x,{animation:"border",size:"lg"})})}):g?e.jsx(C,{fluid:!0,className:"p-4",children:e.jsx(N,{variant:"danger",children:g})}):e.jsxs(C,{fluid:!0,className:"p-4",children:[e.jsx(O,{title:"Mi Dashboard Comercial",subtitle:"M√©tricas personales y rendimiento",icon:j,children:e.jsxs("div",{className:"d-flex align-items-center",children:[F&&e.jsxs("small",{className:"text-muted me-3",children:["√öltima actualizaci√≥n: ",F.toLocaleTimeString("es-PE")]}),e.jsx(u,{variant:"outline-primary",size:"sm",onClick:U,disabled:E,children:E?e.jsxs(e.Fragment,{children:[e.jsx(x,{size:"sm",className:"me-2"}),"Actualizando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"me-2"}),"Actualizar"]})})]})}),g&&e.jsxs(N,{variant:"danger",dismissible:!0,onClose:()=>h(null),className:"mb-4",children:[e.jsx(N.Heading,{children:"‚ö†Ô∏è Error"}),g]}),M&&e.jsxs(N,{variant:"success",dismissible:!0,onClose:()=>m(null),className:"mb-4",children:[e.jsx(N.Heading,{children:"‚úÖ √âxito"}),M]}),e.jsx(t,{className:"mb-4",children:e.jsx(i,{children:e.jsxs(l,{className:"shadow-sm",children:[e.jsx(l.Header,{children:e.jsx("h5",{className:"mb-0",children:"‚ö° Acciones R√°pidas"})}),e.jsx(l.Body,{children:e.jsxs(t,{className:"g-3",children:[e.jsx(i,{md:3,children:e.jsxs(u,{variant:"primary",className:"w-100 d-flex align-items-center justify-content-center",onClick:()=>v("nueva-cotizacion","Nueva Cotizaci√≥n"),disabled:r==="nueva-cotizacion",children:[r==="nueva-cotizacion"?e.jsx(x,{size:"sm",className:"me-2"}):e.jsx(J,{className:"me-2"}),"Nueva Cotizaci√≥n"]})}),e.jsx(i,{md:3,children:e.jsxs(u,{variant:"info",className:"w-100 d-flex align-items-center justify-content-center",onClick:()=>v("ver-clientes","Ver Clientes"),disabled:r==="ver-clientes",children:[r==="ver-clientes"?e.jsx(x,{size:"sm",className:"me-2"}):e.jsx(f,{className:"me-2"}),"Ver Clientes"]})}),e.jsx(i,{md:3,children:e.jsxs(u,{variant:"success",className:"w-100 d-flex align-items-center justify-content-center",onClick:()=>v("ver-proyectos","Ver Proyectos"),disabled:r==="ver-proyectos",children:[r==="ver-proyectos"?e.jsx(x,{size:"sm",className:"me-2"}):e.jsx(y,{className:"me-2"}),"Ver Proyectos"]})}),e.jsx(i,{md:3,children:e.jsxs(u,{variant:"warning",className:"w-100 d-flex align-items-center justify-content-center",onClick:()=>v("enviar-comprobante","Enviar Comprobante"),disabled:r==="enviar-comprobante",children:[r==="enviar-comprobante"?e.jsx(x,{size:"sm",className:"me-2"}):e.jsx(z,{className:"me-2"}),"Enviar Comprobante"]})})]})})]})})}),e.jsx(t,{className:"mb-4 g-3",children:e.jsx(i,{children:e.jsxs("h4",{className:"text-primary mb-3",children:[e.jsx(j,{className:"me-2"}),"Resumen de tu actividad comercial"]})})}),e.jsxs(t,{className:"mb-4 g-3",children:[e.jsx(i,{lg:3,md:6,children:e.jsx(d,{title:"Mis Cotizaciones",value:(s==null?void 0:s.misCotizaciones)||0,icon:j,color:"primary",subtitle:`${(s==null?void 0:s.cotizacionesAprobadas)||0} aprobadas`,size:"normal"})}),e.jsx(i,{lg:3,md:6,children:e.jsx(d,{title:"Clientes",value:(s==null?void 0:s.totalClientes)||0,icon:f,color:"info",subtitle:`${(s==null?void 0:s.clientesNuevosEsteMes)||0} nuevos este mes`,size:"normal"})}),e.jsx(i,{lg:3,md:6,children:e.jsx(d,{title:"Ingresos Generados",value:`$${((s==null?void 0:s.ingresosGenerados)||0).toLocaleString()}`,icon:z,color:"success",subtitle:`${(s==null?void 0:s.cotizacionesFacturadas)||0} facturadas`,size:"normal"})}),e.jsx(i,{lg:3,md:6,children:e.jsx(d,{title:"Tasa de Conversi√≥n",value:`${(s==null?void 0:s.conversionRate)||0}%`,icon:K,color:"warning",subtitle:"Cotizaciones aprobadas",size:"normal"})})]}),e.jsx(t,{className:"mb-4 g-3",children:e.jsx(i,{children:e.jsxs("h4",{className:"text-info mb-3",children:[e.jsx(_,{className:"me-2"}),"M√©tricas mensuales y proyectos"]})})}),e.jsxs(t,{className:"mb-4 g-3",children:[e.jsx(i,{lg:3,md:6,children:e.jsx(d,{title:"Proyectos Activos",value:(s==null?void 0:s.proyectosActivos)||0,icon:y,color:"primary",subtitle:`${(s==null?void 0:s.proyectosCompletados)||0} completados`,size:"normal"})}),e.jsx(i,{lg:3,md:6,children:e.jsx(d,{title:"Cotizaciones Este Mes",value:(s==null?void 0:s.cotizacionesEsteMes)||0,icon:_,color:"info",subtitle:"Nuevas cotizaciones",size:"normal"})}),e.jsx(i,{lg:3,md:6,children:e.jsx(d,{title:"Ingresos Este Mes",value:`$${((s==null?void 0:s.ingresosEsteMes)||0).toLocaleString()}`,icon:z,color:"success",subtitle:"Ingresos del mes actual",size:"normal"})}),e.jsx(i,{lg:3,md:6,children:e.jsx(d,{title:"Clientes Nuevos",value:(s==null?void 0:s.clientesNuevosEsteMes)||0,icon:f,color:"warning",subtitle:"Este mes",size:"normal"})})]}),e.jsx(t,{className:"mb-4",children:e.jsx(i,{children:e.jsxs("h4",{className:"text-success mb-3",children:[e.jsx(j,{className:"me-2"}),"Actividad reciente"]})})}),e.jsxs(t,{className:"mb-4",children:[e.jsx(i,{lg:6,children:e.jsxs(l,{className:"shadow-sm",children:[e.jsxs(l.Header,{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h5",{className:"mb-0",children:"üìã Mis Cotizaciones Recientes"}),e.jsx(b,{bg:"primary",children:((D=s==null?void 0:s.cotizacionesRecientes)==null?void 0:D.length)||0})]}),e.jsx(l.Body,{children:((A=s==null?void 0:s.cotizacionesRecientes)==null?void 0:A.length)>0?e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-sm table-hover",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{children:"C√≥digo"}),e.jsx("th",{children:"Cliente"}),e.jsx("th",{children:"Monto"}),e.jsx("th",{children:"Estado"}),e.jsx("th",{children:"Fecha"})]})}),e.jsx("tbody",{children:s.cotizacionesRecientes.map((a,c)=>{var n;return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("code",{className:"text-primary",children:a.quote_number})}),e.jsx("td",{children:e.jsx("div",{className:"fw-medium",children:a.client_contact})}),e.jsx("td",{children:e.jsxs("span",{className:"fw-bold text-success",children:["S/ ",((n=a.total_amount)==null?void 0:n.toLocaleString("es-PE",{minimumFractionDigits:2,maximumFractionDigits:2}))||"0.00"]})}),e.jsx("td",{children:e.jsx(b,{bg:a.status==="aprobada"?"success":a.status==="facturada"?"primary":a.status==="pendiente"?"warning":a.status==="borrador"?"secondary":"info",className:"text-capitalize",children:a.status||"nueva"})}),e.jsx("td",{children:e.jsx("small",{className:"text-muted",children:new Date(a.created_at).toLocaleDateString("es-PE")})})]},c)})})]})}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx(j,{size:48,className:"text-muted mb-3"}),e.jsx("p",{className:"text-muted mb-0",children:"No tienes cotizaciones recientes"}),e.jsx("small",{className:"text-muted",children:'Crea tu primera cotizaci√≥n usando el bot√≥n "Nueva Cotizaci√≥n"'})]})})]})}),e.jsx(i,{lg:6,children:e.jsxs(l,{className:"shadow-sm",children:[e.jsxs(l.Header,{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h5",{className:"mb-0",children:"üë• Mis Clientes Recientes"}),e.jsx(b,{bg:"info",children:(($=s==null?void 0:s.clientesRecientes)==null?void 0:$.length)||0})]}),e.jsx(l.Body,{children:((L=s==null?void 0:s.clientesRecientes)==null?void 0:L.length)>0?e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-sm table-hover",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Empresa"}),e.jsx("th",{children:"RUC"}),e.jsx("th",{children:"√öltima Cotizaci√≥n"})]})}),e.jsx("tbody",{children:s.clientesRecientes.map((a,c)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("div",{className:"fw-medium",children:a.name})}),e.jsx("td",{children:e.jsx("code",{className:"text-muted",children:a.ruc})}),e.jsx("td",{children:e.jsx("small",{className:"text-muted",children:new Date(a.ultima_cotizacion).toLocaleDateString("es-PE")})})]},c))})]})}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx(f,{size:48,className:"text-muted mb-3"}),e.jsx("p",{className:"text-muted mb-0",children:"No tienes clientes recientes"}),e.jsx("small",{className:"text-muted",children:"Los clientes aparecer√°n aqu√≠ cuando crees cotizaciones"})]})})]})})]}),e.jsx(t,{children:e.jsx(i,{children:e.jsxs(l,{className:"shadow-sm",children:[e.jsxs(l.Header,{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h5",{className:"mb-0",children:"üìÅ Mis Proyectos Recientes"}),e.jsx(b,{bg:"success",children:((k=s==null?void 0:s.proyectosRecientes)==null?void 0:k.length)||0})]}),e.jsx(l.Body,{children:((B=s==null?void 0:s.proyectosRecientes)==null?void 0:B.length)>0?e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-sm table-hover",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Proyecto"}),e.jsx("th",{children:"Empresa"}),e.jsx("th",{children:"Estado"}),e.jsx("th",{children:"Fecha Creaci√≥n"})]})}),e.jsx("tbody",{children:s.proyectosRecientes.map((a,c)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("div",{className:"fw-medium",children:a.name})}),e.jsx("td",{children:e.jsx("div",{className:"text-muted",children:a.company_name})}),e.jsx("td",{children:e.jsx(b,{bg:a.status==="activo"?"success":a.status==="completado"?"primary":a.status==="pendiente"?"warning":a.status==="en_progreso"?"info":"secondary",className:"text-capitalize",children:a.status})}),e.jsx("td",{children:e.jsx("small",{className:"text-muted",children:new Date(a.created_at).toLocaleDateString("es-PE")})})]},c))})]})}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx(y,{size:48,className:"text-muted mb-3"}),e.jsx("p",{className:"text-muted mb-0",children:"No tienes proyectos recientes"}),e.jsx("small",{className:"text-muted",children:"Los proyectos aparecer√°n aqu√≠ cuando crees cotizaciones"})]})})]})})})]})}export{le as default};
//# sourceMappingURL=VendedorComercialDashboard-MXgebI6Q.js.map
