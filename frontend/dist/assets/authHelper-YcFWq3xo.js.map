{"version":3,"file":"authHelper-YcFWq3xo.js","sources":["../../src/utils/authHelper.js"],"sourcesContent":["// Utilidad para manejar la autenticaci√≥n y roles de usuario\r\nexport const getCurrentUser = () => {\r\n  try {\r\n    const token = localStorage.getItem('token');\r\n    if (!token) return null;\r\n    \r\n    const payload = JSON.parse(atob(token.split('.')[1]));\r\n    return {\r\n      id: payload.id,\r\n      name: payload.name,\r\n      role: payload.role,\r\n      email: payload.email\r\n    };\r\n  } catch (error) {\r\n    console.error('Error decodificando token:', error);\r\n    return null;\r\n  }\r\n};\r\n\r\nexport const hasRole = (requiredRoles) => {\r\n  const user = getCurrentUser();\r\n  \r\n  if (!user) {\r\n    return false;\r\n  }\r\n  \r\n  if (typeof requiredRoles === 'string') {\r\n    requiredRoles = [requiredRoles];\r\n  }\r\n  \r\n  const hasPermission = requiredRoles.includes(user.role);\r\n  \r\n  return hasPermission;\r\n};\r\n\r\nexport const canCreateClient = () => {\r\n  return hasRole(['admin', 'jefa_comercial', 'vendedor_comercial']);\r\n};\r\n\r\nexport const canEditClient = () => {\r\n  return hasRole(['admin', 'jefa_comercial', 'vendedor_comercial']);\r\n};\r\n\r\nexport const canDeleteClient = () => {\r\n  return hasRole(['admin']);\r\n};\r\n\r\nexport const canViewClientHistory = () => {\r\n  return hasRole(['admin', 'jefa_comercial', 'vendedor_comercial']);\r\n};\r\n\r\nexport const canCreateProject = () => {\r\n  return hasRole(['admin', 'jefa_comercial', 'vendedor_comercial']);\r\n};\r\n\r\nexport const canEditProject = () => {\r\n  return hasRole(['admin', 'jefa_comercial', 'vendedor_comercial']);\r\n};\r\n\r\nexport const canDeleteProject = () => {\r\n  return hasRole(['admin', 'jefa_comercial', 'soporte']);\r\n};\r\n\r\nexport const logUserInfo = () => {\r\n  const user = getCurrentUser();\r\n  if (user) {\r\n    console.log('üë§ Usuario actual:', {\r\n      id: user.id,\r\n      name: user.name,\r\n      role: user.role,\r\n      email: user.email\r\n    });\r\n    console.log('üîê Permisos:', {\r\n      canCreateClient: canCreateClient(),\r\n      canEditClient: canEditClient(),\r\n      canDeleteClient: canDeleteClient(),\r\n      canCreateProject: canCreateProject(),\r\n      canEditProject: canEditProject(),\r\n      canDeleteProject: canDeleteProject()\r\n    });\r\n  } else {\r\n    console.log('‚ùå No hay usuario autenticado');\r\n  }\r\n};\r\n"],"names":["getCurrentUser","token","payload","error","hasRole","requiredRoles","user","canCreateClient","canEditClient","canDeleteClient","canViewClientHistory","canCreateProject","canEditProject","canDeleteProject","logUserInfo"],"mappings":"AACY,MAACA,EAAiB,IAAM,CAClC,GAAI,CACF,MAAMC,EAAQ,aAAa,QAAQ,OAAO,EAC1C,GAAI,CAACA,EAAO,OAAO,KAEnB,MAAMC,EAAU,KAAK,MAAM,KAAKD,EAAM,MAAM,GAAG,EAAE,CAAC,CAAC,CAAC,EACpD,MAAO,CACL,GAAIC,EAAQ,GACZ,KAAMA,EAAQ,KACd,KAAMA,EAAQ,KACd,MAAOA,EAAQ,KACrB,CACE,OAASC,EAAO,CACd,eAAQ,MAAM,6BAA8BA,CAAK,EAC1C,IACT,CACF,EAEaC,EAAWC,GAAkB,CACxC,MAAMC,EAAON,IAEb,OAAKM,GAID,OAAOD,GAAkB,WAC3BA,EAAgB,CAACA,CAAa,GAGVA,EAAc,SAASC,EAAK,IAAI,GAP7C,EAUX,EAEaC,EAAkB,IACtBH,EAAQ,CAAC,QAAS,iBAAkB,oBAAoB,CAAC,EAGrDI,EAAgB,IACpBJ,EAAQ,CAAC,QAAS,iBAAkB,oBAAoB,CAAC,EAGrDK,EAAkB,IACtBL,EAAQ,CAAC,OAAO,CAAC,EAGbM,EAAuB,IAC3BN,EAAQ,CAAC,QAAS,iBAAkB,oBAAoB,CAAC,EAGrDO,EAAmB,IACvBP,EAAQ,CAAC,QAAS,iBAAkB,oBAAoB,CAAC,EAGrDQ,EAAiB,IACrBR,EAAQ,CAAC,QAAS,iBAAkB,oBAAoB,CAAC,EAGrDS,EAAmB,IACvBT,EAAQ,CAAC,QAAS,iBAAkB,SAAS,CAAC,EAG1CU,EAAc,IAAM,CAC/B,MAAMR,EAAON,IACTM,GACF,QAAQ,IAAI,qBAAsB,CAChC,GAAIA,EAAK,GACT,KAAMA,EAAK,KACX,KAAMA,EAAK,KACX,MAAOA,EAAK,KAClB,CAAK,EACD,QAAQ,IAAI,eAAgB,CAC1B,gBAAiBC,EAAe,EAChC,cAAeC,EAAa,EAC5B,gBAAiBC,EAAe,EAChC,iBAAkBE,EAAgB,EAClC,eAAgBC,EAAc,EAC9B,iBAAkBC,EAAgB,CACxC,CAAK,GAED,QAAQ,IAAI,8BAA8B,CAE9C"}