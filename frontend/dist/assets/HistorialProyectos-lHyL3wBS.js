import{b as x,r as c,a1 as y,c as g,a8 as b,j as e}from"./index-B6K4MeZ_.js";import{M as f}from"./ModuloBase-C9J4epBO.js";import{D as v}from"./DataTable-DZT9fMzW.js";import{T as N}from"./Toolbar-BdCeDIMz.js";const P=(a,o={})=>{const s=new URLSearchParams;o.page&&s.set("page",o.page),o.limit&&s.set("limit",o.limit);const r=s.toString(),n=`/api/project-history/project/${a}`+(r?`?${r}`:"");return x(n)};function w(){const[a,o]=c.useState(""),[s,r]=c.useState(1),[n]=c.useState(10),l=y();c.useEffect(()=>{var t;(t=l.state)!=null&&t.projectId&&o(l.state.projectId)},[l.state]);const{data:i,isLoading:m,isFetching:u}=g(["projectHistory",a,s,n],()=>P(a,{page:s,limit:n}),{enabled:!!a,keepPreviousData:!0}),h=(i==null?void 0:i.data)||[],d=(i==null?void 0:i.total)||0,p=Math.max(1,Math.ceil(d/n)),j=b.useMemo(()=>[{header:"ID",key:"id",width:80},{header:"AcciÃ³n",key:"action"},{header:"Realizado por",key:"performed_by"},{header:"Fecha",key:"created_at",render:t=>new Date(t.created_at).toLocaleString()},{header:"Notas",key:"notes"}],[]);return e.jsxs(f,{titulo:"Historial de Proyectos",descripcion:"Consulta el historial de cambios y eventos de cada proyecto.",children:[e.jsx(N,{left:e.jsx("div",{className:"d-flex align-items-end gap-2",children:e.jsxs("div",{style:{minWidth:"200px"},children:[e.jsx("label",{htmlFor:"project-id-input",className:"form-label",children:"ID del Proyecto"}),e.jsx("input",{id:"project-id-input",type:"number",className:"form-control",placeholder:"Ingrese ID del proyecto",value:a,onChange:t=>{o(t.target.value),r(1)}})]})})}),a?e.jsxs(e.Fragment,{children:[e.jsx(v,{columns:j,rows:h,loading:m||u}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-3",children:[e.jsxs("span",{className:"text-muted",children:["Total: ",d]}),e.jsxs("div",{className:"btn-group",children:[e.jsx("button",{className:"btn btn-outline-secondary",disabled:s<=1,onClick:()=>r(t=>t-1),children:"Anterior"}),e.jsxs("span",{className:"btn btn-outline-secondary disabled",children:[s," / ",p]}),e.jsx("button",{className:"btn btn-outline-secondary",disabled:s>=p,onClick:()=>r(t=>t+1),children:"Siguiente"})]})]})]}):e.jsx("div",{className:"alert alert-info mt-3",children:"Por favor, ingrese un ID de proyecto para ver su historial, o navegue desde la lista de proyectos."})]})}export{w as default};
//# sourceMappingURL=HistorialProyectos-lHyL3wBS.js.map
