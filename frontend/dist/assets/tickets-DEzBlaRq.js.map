{"version":3,"file":"tickets-DEzBlaRq.js","sources":["../../src/services/tickets.js"],"sourcesContent":["import { apiFetch } from './api';\r\n\r\nexport const listTickets = async (params = {}) => {\r\n  const qs = new URLSearchParams(params).toString();\r\n  const path = qs ? `/api/tickets?${qs}` : '/api/tickets';\r\n  const response = await apiFetch(path);\r\n  \r\n  // Manejar diferentes formatos de respuesta\r\n  if (Array.isArray(response)) {\r\n    return response;\r\n  } else if (response && Array.isArray(response.data)) {\r\n    return response.data;\r\n  } else if (response && Array.isArray(response.tickets)) {\r\n    return response.tickets;\r\n  } else {\r\n    console.warn('⚠️ Formato de respuesta inesperado para tickets:', response);\r\n    return [];\r\n  }\r\n};\r\n\r\nexport const getTicket = (id) => apiFetch(`/api/tickets/${id}`);\r\n\r\nexport const createTicket = async ({ \r\n  title, \r\n  description, \r\n  priority, \r\n  module,\r\n  category,\r\n  type,\r\n  assigned_to,\r\n  estimated_time,\r\n  tags,\r\n  additional_notes,\r\n  file \r\n}) => {\r\n  // multipart form for optional attachment under field name 'attachment'\r\n  const form = new FormData();\r\n  if (title) form.append('title', title);\r\n  if (description) form.append('description', description);\r\n  if (priority) form.append('priority', priority);\r\n  if (module) form.append('module', module);\r\n  if (category) form.append('category', category);\r\n  if (type) form.append('type', type);\r\n  if (assigned_to) form.append('assigned_to', assigned_to);\r\n  if (estimated_time) form.append('estimated_time', estimated_time);\r\n  if (tags) form.append('tags', tags);\r\n  if (additional_notes) form.append('additional_notes', additional_notes);\r\n  if (file) form.append('attachment', file);\r\n  return apiFetch('/api/tickets', {\r\n    method: 'POST',\r\n    body: form,\r\n    headers: { 'Content-Type': undefined },\r\n  });\r\n};\r\n\r\nexport const updateTicketStatus = (id, status) =>\r\n  apiFetch(`/api/tickets/${id}/status`, {\r\n    method: 'PUT',\r\n    body: JSON.stringify({ status }),\r\n  });\r\n\r\nexport const listTicketHistory = (ticket_id, params = {}) => {\r\n  const sp = new URLSearchParams();\r\n  if (params.page) sp.set('page', params.page);\r\n  if (params.limit) sp.set('limit', params.limit);\r\n  const qs = sp.toString();\r\n  const path = qs ? `/api/tickets/${ticket_id}/history?${qs}` : `/api/tickets/${ticket_id}/history`;\r\n  return apiFetch(path);\r\n};\r\n\r\nexport const listTicketHistoryGlobal = (params = {}) => {\r\n  const sp = new URLSearchParams();\r\n  if (params.page) sp.set('page', params.page);\r\n  if (params.limit) sp.set('limit', params.limit);\r\n  if (params.q) sp.set('q', params.q);\r\n  if (params.action) sp.set('action', params.action);\r\n  if (params.range) sp.set('range', params.range);\r\n  const qs = sp.toString();\r\n  return apiFetch('/api/tickets/history/global' + (qs ? `?${qs}` : ''));\r\n};\r\n\r\nexport default { listTickets, getTicket, createTicket, updateTicketStatus, listTicketHistory, listTicketHistoryGlobal };\r\n"],"names":["listTickets","params","qs","path","response","apiFetch","createTicket","title","description","priority","module","category","type","assigned_to","estimated_time","tags","additional_notes","file","form","updateTicketStatus","id","status","listTicketHistory","ticket_id","sp","listTicketHistoryGlobal"],"mappings":"wCAEY,MAACA,EAAc,MAAOC,EAAS,KAAO,CAChD,MAAMC,EAAK,IAAI,gBAAgBD,CAAM,EAAE,SAAQ,EACzCE,EAAOD,EAAK,gBAAgBA,CAAE,GAAK,eACnCE,EAAW,MAAMC,EAASF,CAAI,EAGpC,OAAI,MAAM,QAAQC,CAAQ,EACjBA,EACEA,GAAY,MAAM,QAAQA,EAAS,IAAI,EACzCA,EAAS,KACPA,GAAY,MAAM,QAAQA,EAAS,OAAO,EAC5CA,EAAS,SAEhB,QAAQ,KAAK,mDAAoDA,CAAQ,EAClE,GAEX,EAIaE,EAAe,MAAO,CACjC,MAAAC,EACA,YAAAC,EACA,SAAAC,EACA,OAAAC,EACA,SAAAC,EACA,KAAAC,EACA,YAAAC,EACA,eAAAC,EACA,KAAAC,EACA,iBAAAC,EACA,KAAAC,CACF,IAAM,CAEJ,MAAMC,EAAO,IAAI,SACjB,OAAIX,GAAOW,EAAK,OAAO,QAASX,CAAK,EACjCC,GAAaU,EAAK,OAAO,cAAeV,CAAW,EACnDC,GAAUS,EAAK,OAAO,WAAYT,CAAQ,EAC1CC,GAAQQ,EAAK,OAAO,SAAUR,CAAM,EACpCC,GAAUO,EAAK,OAAO,WAAYP,CAAQ,EAC1CC,GAAMM,EAAK,OAAO,OAAQN,CAAI,EAC9BC,GAAaK,EAAK,OAAO,cAAeL,CAAW,EACnDC,GAAgBI,EAAK,OAAO,iBAAkBJ,CAAc,EAC5DC,GAAMG,EAAK,OAAO,OAAQH,CAAI,EAC9BC,GAAkBE,EAAK,OAAO,mBAAoBF,CAAgB,EAClEC,GAAMC,EAAK,OAAO,aAAcD,CAAI,EACjCZ,EAAS,eAAgB,CAC9B,OAAQ,OACR,KAAMa,EACN,QAAS,CAAE,eAAgB,MAAS,CACxC,CAAG,CACH,EAEaC,EAAqB,CAACC,EAAIC,IACrChB,EAAS,gBAAgBe,CAAE,UAAW,CACpC,OAAQ,MACR,KAAM,KAAK,UAAU,CAAE,OAAAC,CAAM,CAAE,CACnC,CAAG,EAEUC,EAAoB,CAACC,EAAWtB,EAAS,KAAO,CAC3D,MAAMuB,EAAK,IAAI,gBACXvB,EAAO,MAAMuB,EAAG,IAAI,OAAQvB,EAAO,IAAI,EACvCA,EAAO,OAAOuB,EAAG,IAAI,QAASvB,EAAO,KAAK,EAC9C,MAAMC,EAAKsB,EAAG,WACRrB,EAAOD,EAAK,gBAAgBqB,CAAS,YAAYrB,CAAE,GAAK,gBAAgBqB,CAAS,WACvF,OAAOlB,EAASF,CAAI,CACtB,EAEasB,EAA0B,CAACxB,EAAS,KAAO,CACtD,MAAMuB,EAAK,IAAI,gBACXvB,EAAO,MAAMuB,EAAG,IAAI,OAAQvB,EAAO,IAAI,EACvCA,EAAO,OAAOuB,EAAG,IAAI,QAASvB,EAAO,KAAK,EAC1CA,EAAO,GAAGuB,EAAG,IAAI,IAAKvB,EAAO,CAAC,EAC9BA,EAAO,QAAQuB,EAAG,IAAI,SAAUvB,EAAO,MAAM,EAC7CA,EAAO,OAAOuB,EAAG,IAAI,QAASvB,EAAO,KAAK,EAC9C,MAAMC,EAAKsB,EAAG,WACd,OAAOnB,EAAS,+BAAiCH,EAAK,IAAIA,CAAE,GAAK,GAAG,CACtE"}