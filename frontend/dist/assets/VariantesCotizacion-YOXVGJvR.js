import{r as i,j as e}from"./index-o7c7tdkB.js";import{M as y}from"./ModuloBase-DpIJbQDg.js";import{l as C,d as v,u as w,c as E}from"./quoteVariants-0TxoUMz3.js";const d={code:"",title:"",description:"",conditions:""},k=()=>{const[x,j]=i.useState([]),[b,m]=i.useState(!0),[h,u]=i.useState(""),[p,n]=i.useState(!1),[l,r]=i.useState(null),[s,a]=i.useState(d),c=async()=>{m(!0),u("");try{const t=await C();j(t||[])}catch(t){u(t.message||"Error al cargar variantes")}finally{m(!1)}};i.useEffect(()=>{c()},[]);const f=async t=>{t.preventDefault();try{l?await w(l.id,s):await E(s),n(!1),r(null),a(d),await c()}catch(o){alert(o.message||"Error al guardar")}},g=t=>{r(t),a({code:t.code||"",title:t.title||"",description:t.description||"",conditions:t.conditions||""}),n(!0)},N=async t=>{if(confirm(`Eliminar variante ${t.title}?`))try{await v(t.id),await c()}catch(o){alert(o.message||"Error al eliminar")}};return e.jsxs(y,{titulo:"Variantes de Cotización",descripcion:"Administra plantillas base para cotizaciones (código, condiciones, etc.)",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:12},children:[e.jsxs("div",{children:[b&&e.jsx("span",{children:"Cargando..."}),h&&e.jsx("span",{style:{color:"red"},children:h})]}),e.jsx("button",{className:"btn btn-primary",onClick:()=>{n(!0),r(null),a(d)},children:"Nueva variante"})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-striped",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Código"}),e.jsx("th",{children:"Título"}),e.jsx("th",{children:"Descripción"}),e.jsx("th",{children:"Condiciones"}),e.jsx("th",{children:"Activo"}),e.jsx("th",{children:"Acciones"})]})}),e.jsx("tbody",{children:(x||[]).map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:t.id}),e.jsx("td",{children:t.code}),e.jsx("td",{children:t.title}),e.jsx("td",{children:t.description}),e.jsx("td",{style:{maxWidth:320,whiteSpace:"pre-wrap"},children:t.conditions}),e.jsx("td",{children:String(t.active??!0)}),e.jsxs("td",{children:[e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>g(t),children:"Editar"})," ",e.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>N(t),children:"Eliminar"})]})]},t.id))})]})}),p&&e.jsxs("div",{style:{border:"1px solid #eee",borderRadius:8,padding:16,marginTop:16},children:[e.jsx("h5",{children:l?"Editar variante":"Nueva variante"}),e.jsxs("form",{onSubmit:f,children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Código"}),e.jsx("input",{className:"form-control",value:s.code,onChange:t=>a({...s,code:t.target.value}),required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Título"}),e.jsx("input",{className:"form-control",value:s.title,onChange:t=>a({...s,title:t.target.value}),required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Descripción"}),e.jsx("textarea",{className:"form-control",rows:2,value:s.description,onChange:t=>a({...s,description:t.target.value})})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Condiciones (texto libre)"}),e.jsx("textarea",{className:"form-control",rows:4,value:s.conditions,onChange:t=>a({...s,conditions:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("button",{type:"submit",className:"btn btn-success",children:"Guardar"})," ",e.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>{n(!1),r(null)},children:"Cancelar"})]})]})]})]})};export{k as default};
//# sourceMappingURL=VariantesCotizacion-YOXVGJvR.js.map
