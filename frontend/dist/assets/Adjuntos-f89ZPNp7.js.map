{"version":3,"file":"Adjuntos-f89ZPNp7.js","sources":["../../src/components/Modal.jsx","../../src/services/categories.js","../../src/pages/Adjuntos.jsx"],"sourcesContent":["import React from 'react';\r\n\r\nconst modalStyle = {\r\n  position: 'fixed', top: 0, left: 0, width: '100vw', height: '100vh', background: 'rgba(0,0,0,0.18)', zIndex: 9999,\r\n  display: 'flex', alignItems: 'center', justifyContent: 'center'\r\n};\r\n\r\nconst getCardStyle = (size, className) => {\r\n  const baseStyle = {\r\n    background: '#fff', borderRadius: 12, boxShadow: '0 2px 16px #0002', padding: '2rem 2.5rem'\r\n  };\r\n\r\n  // Si tiene className personalizado, usar estilos mínimos\r\n  if (className) {\r\n    return {\r\n      ...baseStyle,\r\n      minWidth: 340,\r\n      maxWidth: 'none',\r\n      width: 'auto',\r\n      height: 'auto'\r\n    };\r\n  }\r\n\r\n  // Estilos por defecto según el tamaño\r\n  switch (size) {\r\n    case 'sm':\r\n      return { ...baseStyle, minWidth: 300, maxWidth: 400 };\r\n    case 'lg':\r\n      return { ...baseStyle, minWidth: 500, maxWidth: 800 };\r\n    case 'xl':\r\n      return { ...baseStyle, minWidth: 800, maxWidth: 1200 };\r\n    default:\r\n      return { ...baseStyle, minWidth: 340, maxWidth: 420 };\r\n  }\r\n};\r\n\r\nexport default function Modal({ open, onClose, children, size, className }) {\r\n  if (!open) return null;\r\n  \r\n  const cardStyle = getCardStyle(size, className);\r\n  \r\n  return (\r\n    <div style={modalStyle} onClick={onClose}>\r\n      <div \r\n        style={cardStyle} \r\n        className={className}\r\n        onClick={e => e.stopPropagation()}\r\n      >\r\n        {children}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import apiFetch from './api';\r\n\r\n// Servicios para categorías de proyectos\r\nexport const listCategories = () => {\r\n  return apiFetch('/api/project-categories');\r\n};\r\n\r\nexport const getCategoryById = (id) => {\r\n  return apiFetch(`/api/project-categories/${id}`);\r\n};\r\n\r\nexport const createCategory = (data) => {\r\n  return apiFetch('/api/project-categories', {\r\n    method: 'POST',\r\n    body: JSON.stringify(data),\r\n  });\r\n};\r\n\r\nexport const updateCategory = (id, data) => {\r\n  return apiFetch(`/api/project-categories/${id}`, {\r\n    method: 'PUT',\r\n    body: JSON.stringify(data),\r\n  });\r\n};\r\n\r\nexport const deleteCategory = (id) => {\r\n  return apiFetch(`/api/project-categories/${id}`, {\r\n    method: 'DELETE',\r\n  });\r\n};\r\n\r\n// Servicios para subcategorías\r\nexport const listSubcategories = (categoryId = null) => {\r\n  const url = categoryId \r\n    ? `/api/project-subcategories?category_id=${categoryId}`\r\n    : '/api/project-subcategories';\r\n  return apiFetch(url);\r\n};\r\n\r\nexport const getSubcategoryById = (id) => {\r\n  return apiFetch(`/api/project-subcategories/${id}`);\r\n};\r\n\r\nexport const createSubcategory = (data) => {\r\n  return apiFetch('/api/project-subcategories', {\r\n    method: 'POST',\r\n    body: JSON.stringify(data),\r\n  });\r\n};\r\n\r\nexport const updateSubcategory = (id, data) => {\r\n  return apiFetch(`/api/project-subcategories/${id}`, {\r\n    method: 'PUT',\r\n    body: JSON.stringify(data),\r\n  });\r\n};\r\n\r\nexport const deleteSubcategory = (id) => {\r\n  return apiFetch(`/api/project-subcategories/${id}`, {\r\n    method: 'DELETE',\r\n  });\r\n};","import React, { useMemo, useState, useEffect } from 'react';\r\nimport { useLocation } from 'react-router-dom';\r\nimport { useQuery, useMutation, useQueryClient } from 'react-query';\r\nimport { Container, Row, Col, Card, Badge, Button, Form, Alert, Spinner, ProgressBar } from 'react-bootstrap';\r\nimport { FiUpload, FiDownload, FiTrash2, FiFile, FiFolder, FiSearch, FiFilter, FiRefreshCw, FiAlertTriangle, FiCheckCircle, FiClock, FiUsers, FiEdit } from 'react-icons/fi';\r\nimport PageHeader from '../components/common/PageHeader';\r\nimport DataTable from '../components/common/DataTable';\r\nimport StatsCard from '../components/common/StatsCard';\r\nimport Modal from '../components/Modal';\r\nimport Toast from '../components/Toast';\r\nimport './Adjuntos.css';\r\nimport { listProjectAttachments, getAllAttachments, uploadAttachment, updateAttachment, deleteAttachment, downloadFile } from '../services/attachments';\r\nimport { listProjects } from '../services/projects';\r\nimport { listCategories, listSubcategories } from '../services/categories';\r\nimport CompanyProjectPicker from '../components/CompanyProjectPicker';\r\n\r\nconst emptyForm = { \r\n  project_id: '', \r\n  company_id: '',\r\n  company: null,\r\n  project: null,\r\n  project_name: '',\r\n  location: '',\r\n  description: '', \r\n  file: null, \r\n  category_id: '', \r\n  subcategory_id: '',\r\n  requiere_laboratorio: false,\r\n  requiere_ingenieria: false,\r\n  requiere_consultoria: false,\r\n  requiere_capacitacion: false,\r\n  requiere_auditoria: false\r\n};\r\n\r\nexport default function Adjuntos() {\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [limit] = useState(20);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [selectedProject, setSelectedProject] = useState('');\r\n  const [selectedFileType, setSelectedFileType] = useState('');\r\n  const [toast, setToast] = useState({ message: '', type: 'success', show: false });\r\n  const location = useLocation();\r\n\r\n  // Estado para el selector de cliente/proyecto\r\n  const [clientProjectSelection, setClientProjectSelection] = useState({\r\n    company_id: null,\r\n    company: null,\r\n    project_id: null,\r\n    project: null,\r\n    project_name: '',\r\n    location: ''\r\n  });\r\n\r\n  // State for modals\r\n  const [showUploadModal, setShowUploadModal] = useState(false);\r\n  const [showEditModal, setShowEditModal] = useState(false);\r\n  const [uploadForm, setUploadForm] = useState(emptyForm);\r\n  const [editingAttachment, setEditingAttachment] = useState(null);\r\n  const [deletingAttachment, setDeletingAttachment] = useState(null);\r\n  const [uploadProgress, setUploadProgress] = useState(0);\r\n  const [dragActive, setDragActive] = useState(false);\r\n\r\n  const queryClient = useQueryClient();\r\n\r\n  useEffect(() => {\r\n    if (location.state?.search) {\r\n      setSearchTerm(location.state.search);\r\n    }\r\n  }, [location.state]);\r\n\r\n  // Obtener todos los adjuntos de todos los proyectos\r\n  const { data, isLoading, refetch } = useQuery(\r\n    ['allAttachments', currentPage, limit, searchTerm, selectedProject, selectedFileType, clientProjectSelection.project_id],\r\n    () => getAllAttachments({ \r\n      page: currentPage, \r\n      limit, \r\n      search: searchTerm,\r\n      project_id: clientProjectSelection.project_id || selectedProject,\r\n      file_type: selectedFileType\r\n    }),\r\n    { \r\n      keepPreviousData: true,\r\n      refetchOnWindowFocus: false,\r\n      staleTime: 30000,\r\n    }\r\n  );\r\n\r\n  const { data: projectsData } = useQuery('projectsList', () => listProjects({ page: 1, limit: 500 }), { staleTime: Infinity });\r\n  const projects = useMemo(() => projectsData?.data || [], [projectsData]);\r\n\r\n  // Obtener todas las categorías disponibles\r\n  const { data: categoriesData, refetch: refetchCategories } = useQuery('categoriesList', listCategories, { \r\n    staleTime: 30000, // 30 segundos\r\n    refetchOnWindowFocus: true \r\n  });\r\n  const categories = useMemo(() => categoriesData || [], [categoriesData]);\r\n\r\n  // Obtener todas las subcategorías disponibles\r\n  const { data: subcategoriesData, refetch: refetchSubcategories } = useQuery('subcategoriesList', () => listSubcategories(), { \r\n    staleTime: 30000, // 30 segundos\r\n    refetchOnWindowFocus: true \r\n  });\r\n  const subcategories = useMemo(() => subcategoriesData || [], [subcategoriesData]);\r\n\r\n  // Obtener el proyecto seleccionado para sus categorías\r\n  const selectedProjectData = useMemo(() => {\r\n    return projects.find(p => p.id === parseInt(uploadForm.project_id));\r\n  }, [projects, uploadForm.project_id]);\r\n\r\n  // Obtener el proyecto del archivo que se está editando\r\n  const selectedProjectDataForEdit = useMemo(() => {\r\n    if (!editingAttachment) return null;\r\n    return projects.find(p => p.id === parseInt(editingAttachment.project_id));\r\n  }, [projects, editingAttachment]);\r\n\r\n  // Función helper para actualizar categorías y subcategorías\r\n  const refreshCategoriesAndSubcategories = () => {\r\n    refetchCategories();\r\n    refetchSubcategories();\r\n  };\r\n\r\n  // Actualizar categorías cuando se abra el modal\r\n  useEffect(() => {\r\n    if (showUploadModal || showEditModal) {\r\n      refreshCategoriesAndSubcategories();\r\n    }\r\n  }, [showUploadModal, showEditModal, refetchCategories, refetchSubcategories]);\r\n\r\n  const handleMutationSuccess = (message) => {\r\n    setToast({ message, type: 'success', show: true });\r\n    queryClient.invalidateQueries('allAttachments');\r\n    setShowUploadModal(false);\r\n    setShowEditModal(false);\r\n    setUploadForm(emptyForm);\r\n    setEditingAttachment(null);\r\n    setDeletingAttachment(null);\r\n    setUploadProgress(0);\r\n  };\r\n\r\n  const handleMutationError = (error, defaultMessage) => {\r\n    setToast({ message: error?.message || defaultMessage, type: 'error', show: true });\r\n    setUploadProgress(0);\r\n  };\r\n\r\n  const createMutation = useMutation(\r\n    (formData) => uploadAttachment(uploadForm.project_id, formData),\r\n    {\r\n      onSuccess: () => handleMutationSuccess('Archivo subido correctamente.'),\r\n      onError: (err) => handleMutationError(err, 'Error al subir archivo.'),\r\n    }\r\n  );\r\n\r\n  const updateMutation = useMutation(\r\n    ({ id, formData }) => updateAttachment(id, formData),\r\n    {\r\n      onSuccess: () => handleMutationSuccess('Archivo actualizado correctamente.'),\r\n      onError: (err) => handleMutationError(err, 'Error al actualizar archivo.'),\r\n    }\r\n  );\r\n\r\n  const deleteMutation = useMutation(deleteAttachment, {\r\n    onSuccess: () => handleMutationSuccess('Adjunto eliminado correctamente.'),\r\n    onError: (err) => handleMutationError(err, 'Error al eliminar adjunto.'),\r\n  });\r\n\r\n  const handleUploadSubmit = (e) => {\r\n    e.preventDefault();\r\n    if (!uploadForm.file || !uploadForm.project_id) {\r\n      setToast({ message: 'Debe seleccionar un proyecto y un archivo.', type: 'error', show: true });\r\n      return;\r\n    }\r\n\r\n    const formData = new FormData();\r\n    formData.append('file', uploadForm.file);\r\n    formData.append('description', uploadForm.description || '');\r\n    if (uploadForm.category_id) formData.append('category_id', uploadForm.category_id);\r\n    if (uploadForm.subcategory_id) formData.append('subcategory_id', uploadForm.subcategory_id);\r\n    formData.append('requiere_laboratorio', uploadForm.requiere_laboratorio);\r\n    formData.append('requiere_ingenieria', uploadForm.requiere_ingenieria);\r\n    formData.append('requiere_consultoria', uploadForm.requiere_consultoria);\r\n    formData.append('requiere_capacitacion', uploadForm.requiere_capacitacion);\r\n    formData.append('requiere_auditoria', uploadForm.requiere_auditoria);\r\n    \r\n    createMutation.mutate(formData);\r\n  };\r\n\r\n  const handleEdit = (attachment) => {\r\n    setEditingAttachment(attachment);\r\n    setUploadForm({\r\n      project_id: attachment.project_id,\r\n      description: attachment.description || '',\r\n      file: null,\r\n      category_id: attachment.category_id || '',\r\n      subcategory_id: attachment.subcategory_id || '',\r\n      requiere_laboratorio: attachment.requiere_laboratorio || false,\r\n      requiere_ingenieria: attachment.requiere_ingenieria || false,\r\n      requiere_consultoria: attachment.requiere_consultoria || false,\r\n      requiere_capacitacion: attachment.requiere_capacitacion || false,\r\n      requiere_auditoria: attachment.requiere_auditoria || false\r\n    });\r\n    setShowEditModal(true);\r\n  };\r\n\r\n  const handleEditSubmit = (e) => {\r\n    e.preventDefault();\r\n    if (!editingAttachment) return;\r\n\r\n    const updateData = {\r\n      description: uploadForm.description || '',\r\n      category_id: uploadForm.category_id || null,\r\n      subcategory_id: uploadForm.subcategory_id || null,\r\n      requiere_laboratorio: uploadForm.requiere_laboratorio,\r\n      requiere_ingenieria: uploadForm.requiere_ingenieria,\r\n      requiere_consultoria: uploadForm.requiere_consultoria,\r\n      requiere_capacitacion: uploadForm.requiere_capacitacion,\r\n      requiere_auditoria: uploadForm.requiere_auditoria\r\n    };\r\n\r\n    console.log('🔄 handleEditSubmit - Editing attachment ID:', editingAttachment.id);\r\n    console.log('🔄 handleEditSubmit - Upload form data:', uploadForm);\r\n    console.log('🔄 handleEditSubmit - Update data:', updateData);\r\n\r\n    // Siempre usar FormData para mantener consistencia\r\n    const formData = new FormData();\r\n    \r\n    // Si hay un nuevo archivo, lo agregamos\r\n    if (uploadForm.file) {\r\n      formData.append('file', uploadForm.file);\r\n    }\r\n    \r\n    // Agregar todos los datos de actualización\r\n    Object.keys(updateData).forEach(key => {\r\n      if (updateData[key] !== null && updateData[key] !== undefined) {\r\n        formData.append(key, updateData[key]);\r\n        console.log(`🔄 FormData - ${key}:`, updateData[key]);\r\n      }\r\n    });\r\n    \r\n    console.log('🔄 FormData entries:');\r\n    for (let [key, value] of formData.entries()) {\r\n      console.log(`  ${key}:`, value);\r\n    }\r\n    \r\n    updateMutation.mutate({ id: editingAttachment.id, formData });\r\n  };\r\n\r\n  const handleDeleteConfirm = () => {\r\n    if (deletingAttachment) {\r\n      deleteMutation.mutate(deletingAttachment.id);\r\n    }\r\n  };\r\n\r\n  const handleDownload = async (attachment) => {\r\n    try {\r\n      await downloadFile(attachment);\r\n      setToast({ message: 'Descarga iniciada correctamente.', type: 'success', show: true });\r\n    } catch (error) {\r\n      console.error('Error al descargar archivo:', error);\r\n      setToast({ message: 'Error al descargar el archivo.', type: 'error', show: true });\r\n    }\r\n  };\r\n\r\n\r\n  const handleDragEnter = (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    setDragActive(true);\r\n  };\r\n\r\n  const handleDragLeave = (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    setDragActive(false);\r\n  };\r\n\r\n  const handleDragOver = (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n  };\r\n\r\n  const handleDrop = (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    setDragActive(false);\r\n    \r\n    const files = e.dataTransfer.files;\r\n    if (files && files[0]) {\r\n      setUploadForm(f => ({ ...f, file: files[0] }));\r\n    }\r\n  };\r\n\r\n  const handleFilter = (filters) => {\r\n    setSelectedProject(filters.project_id || '');\r\n    setSelectedFileType(filters.file_type || '');\r\n    setCurrentPage(1);\r\n  };\r\n\r\n  const getFileIcon = (fileName) => {\r\n    const ext = fileName.split('.').pop()?.toLowerCase();\r\n    switch (ext) {\r\n      case 'pdf': return '📄';\r\n      case 'doc':\r\n      case 'docx': return '📝';\r\n      case 'xls':\r\n      case 'xlsx': return '📊';\r\n      case 'ppt':\r\n      case 'pptx': return '📈';\r\n      case 'jpg':\r\n      case 'jpeg':\r\n      case 'png':\r\n      case 'gif': return '🖼️';\r\n      case 'txt': return '📃';\r\n      default: return '📎';\r\n    }\r\n  };\r\n\r\n  const getFileTypeBadge = (fileName) => {\r\n    const ext = fileName.split('.').pop()?.toLowerCase();\r\n    const typeMap = {\r\n      'pdf': { variant: 'danger', text: 'PDF' },\r\n      'doc': { variant: 'primary', text: 'DOC' },\r\n      'docx': { variant: 'primary', text: 'DOCX' },\r\n      'xls': { variant: 'success', text: 'XLS' },\r\n      'xlsx': { variant: 'success', text: 'XLSX' },\r\n      'ppt': { variant: 'warning', text: 'PPT' },\r\n      'pptx': { variant: 'warning', text: 'PPTX' },\r\n      'jpg': { variant: 'info', text: 'JPG' },\r\n      'jpeg': { variant: 'info', text: 'JPEG' },\r\n      'png': { variant: 'info', text: 'PNG' },\r\n      'gif': { variant: 'info', text: 'GIF' },\r\n      'txt': { variant: 'secondary', text: 'TXT' }\r\n    };\r\n    return typeMap[ext] || { variant: 'secondary', text: ext?.toUpperCase() || 'FILE' };\r\n  };\r\n\r\n  const getRoleBadge = (role) => {\r\n    const roleMap = {\r\n      'admin': { variant: 'danger', text: 'Admin' },\r\n      'jefa_comercial': { variant: 'primary', text: 'Jefa Comercial' },\r\n      'jefe_laboratorio': { variant: 'info', text: 'Jefe Lab' },\r\n      'vendedor_comercial': { variant: 'success', text: 'Vendedor' },\r\n      'usuario_laboratorio': { variant: 'warning', text: 'Lab User' }\r\n    };\r\n    return roleMap[role] || { variant: 'secondary', text: role || 'N/A' };\r\n  };\r\n\r\n  const getStatusBadge = (status) => {\r\n    const statusMap = {\r\n      'activo': { variant: 'success', text: 'Activo' },\r\n      'pendiente': { variant: 'warning', text: 'Pendiente' },\r\n      'completado': { variant: 'primary', text: 'Completado' },\r\n      'cancelado': { variant: 'danger', text: 'Cancelado' },\r\n      'pausado': { variant: 'secondary', text: 'Pausado' }\r\n    };\r\n    return statusMap[status] || { variant: 'secondary', text: status || 'N/A' };\r\n  };\r\n\r\n  const columns = useMemo(() => [\r\n    { \r\n      header: 'ID', \r\n      accessor: 'id', \r\n      width: 60 \r\n    },\r\n    { \r\n      header: 'Proyecto', \r\n      accessor: 'project_name',\r\n      render: (value, row) => (\r\n        <div>\r\n          <div className=\"fw-medium\">{value || 'Sin proyecto'}</div>\r\n          <div className=\"small text-muted\">\r\n            <div>📍 {row.project_location || 'Sin ubicación'}</div>\r\n            <div className=\"d-flex align-items-center gap-2 mt-1\">\r\n              <Badge bg={getStatusBadge(row.project_status).variant} className=\"small\">\r\n                {getStatusBadge(row.project_status).text}\r\n              </Badge>\r\n              {row.project_priority && (\r\n                <Badge bg={row.project_priority === 'urgent' ? 'danger' : row.project_priority === 'high' ? 'warning' : 'info'} className=\"small\">\r\n                  {row.project_priority}\r\n                </Badge>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )\r\n    },\r\n    { \r\n      header: 'Empresa', \r\n      accessor: 'company_name',\r\n      render: (value, row) => (\r\n        <div>\r\n          <div className=\"fw-medium\">{value || 'Sin empresa'}</div>\r\n          <small className=\"text-muted\">RUC: {row.company_ruc || 'N/A'}</small>\r\n        </div>\r\n      )\r\n    },\r\n    { \r\n      header: 'Archivo', \r\n      accessor: 'original_name',\r\n      render: (value, row) => {\r\n        const fileType = getFileTypeBadge(value);\r\n        return (\r\n          <div className=\"d-flex align-items-center\">\r\n            <span className=\"me-2\" style={{ fontSize: '1.2em' }}>\r\n              {getFileIcon(value)}\r\n            </span>\r\n            <div>\r\n              <div className=\"fw-medium\">{value}</div>\r\n              <Badge bg={fileType.variant} className=\"small\">\r\n                {fileType.text}\r\n              </Badge>\r\n            </div>\r\n          </div>\r\n        );\r\n      }\r\n    },\r\n    { \r\n      header: 'Categorías', \r\n      accessor: 'category_name',\r\n      render: (value, row) => (\r\n        <div>\r\n          {value && (\r\n            <div className=\"mb-1\">\r\n              <Badge bg=\"primary\" className=\"small\">\r\n                📁 {value}\r\n              </Badge>\r\n            </div>\r\n          )}\r\n          {row.subcategory_name && (\r\n            <div>\r\n              <Badge bg=\"info\" className=\"small\">\r\n                📂 {row.subcategory_name}\r\n              </Badge>\r\n            </div>\r\n          )}\r\n          {!value && !row.subcategory_name && (\r\n            <span className=\"text-muted small\">Sin categoría</span>\r\n          )}\r\n        </div>\r\n      )\r\n    },\r\n    { \r\n      header: 'Servicios', \r\n      accessor: 'requiere_laboratorio',\r\n      render: (value, row) => (\r\n        <div className=\"d-flex flex-wrap gap-1\">\r\n          {row.requiere_laboratorio && (\r\n            <Badge bg=\"warning\" className=\"small\">🧪 Lab</Badge>\r\n          )}\r\n          {row.requiere_ingenieria && (\r\n            <Badge bg=\"info\" className=\"small\">⚙️ Ing</Badge>\r\n          )}\r\n          {row.requiere_consultoria && (\r\n            <Badge bg=\"success\" className=\"small\">💼 Cons</Badge>\r\n          )}\r\n          {row.requiere_capacitacion && (\r\n            <Badge bg=\"primary\" className=\"small\">🎓 Cap</Badge>\r\n          )}\r\n          {row.requiere_auditoria && (\r\n            <Badge bg=\"secondary\" className=\"small\">📋 Aud</Badge>\r\n          )}\r\n          {!row.requiere_laboratorio && !row.requiere_ingenieria && !row.requiere_consultoria && !row.requiere_capacitacion && !row.requiere_auditoria && (\r\n            <span className=\"text-muted small\">Sin servicios</span>\r\n          )}\r\n        </div>\r\n      )\r\n    },\r\n    { \r\n      header: 'Roles', \r\n      accessor: 'vendedor_name',\r\n      render: (value, row) => (\r\n        <div>\r\n          {value && (\r\n            <div className=\"mb-1\">\r\n              <div className=\"small\">\r\n                <Badge bg={getRoleBadge(row.vendedor_role).variant} className=\"small me-1\">\r\n                  {getRoleBadge(row.vendedor_role).text}\r\n                </Badge>\r\n                <span className=\"text-muted\">{value}</span>\r\n              </div>\r\n            </div>\r\n          )}\r\n          {row.laboratorio_name && (\r\n            <div className=\"small\">\r\n              <Badge bg={getRoleBadge(row.laboratorio_role).variant} className=\"small me-1\">\r\n                {getRoleBadge(row.laboratorio_role).text}\r\n              </Badge>\r\n              <span className=\"text-muted\">{row.laboratorio_name}</span>\r\n            </div>\r\n          )}\r\n          {!value && !row.laboratorio_name && (\r\n            <span className=\"text-muted small\">Sin asignación</span>\r\n          )}\r\n        </div>\r\n      )\r\n    },\r\n    { \r\n      header: 'Subido por', \r\n      accessor: 'uploaded_by_name',\r\n      render: (value, row) => (\r\n        <div>\r\n          <div className=\"fw-medium\">{value || 'Usuario desconocido'}</div>\r\n          <div className=\"small\">\r\n            <Badge bg={getRoleBadge(row.uploaded_by_role).variant} className=\"small\">\r\n              {getRoleBadge(row.uploaded_by_role).text}\r\n            </Badge>\r\n          </div>\r\n        </div>\r\n      )\r\n    },\r\n    { \r\n      header: 'Fecha', \r\n      accessor: 'created_at',\r\n      render: (value) => (\r\n        <div>\r\n          <div>{new Date(value).toLocaleDateString()}</div>\r\n          <small className=\"text-muted\">{new Date(value).toLocaleTimeString()}</small>\r\n        </div>\r\n      ),\r\n      width: 120\r\n    },\r\n    { \r\n      header: 'Acciones', \r\n      accessor: 'actions',\r\n      width: 180,\r\n      render: (value, row) => (\r\n        <div className=\"d-flex gap-1\">\r\n          <Button\r\n            variant=\"outline-primary\"\r\n            size=\"sm\"\r\n            onClick={() => handleDownload(row)}\r\n            title=\"Descargar\"\r\n          >\r\n            <FiDownload />\r\n          </Button>\r\n          <Button\r\n            variant=\"outline-success\"\r\n            size=\"sm\"\r\n            onClick={() => handleEdit(row)}\r\n            title=\"Editar\"\r\n          >\r\n            <FiEdit />\r\n          </Button>\r\n          <Button\r\n            variant=\"outline-danger\"\r\n            size=\"sm\"\r\n            onClick={() => setDeletingAttachment(row)}\r\n            title=\"Eliminar\"\r\n          >\r\n            <FiTrash2 />\r\n          </Button>\r\n        </div>\r\n      )\r\n    },\r\n  ], []);\r\n\r\n  const rows = data?.data || [];\r\n  const total = data?.total || 0;\r\n  const totalPages = Math.max(1, Math.ceil(total / limit));\r\n\r\n  // Estadísticas calculadas\r\n  const stats = useMemo(() => {\r\n    const fileTypes = {};\r\n    const projects = new Set();\r\n    const categories = new Set();\r\n    const subcategories = new Set();\r\n    const roles = new Set();\r\n    let totalSize = 0;\r\n    \r\n    rows.forEach(row => {\r\n      const ext = row.original_name?.split('.').pop()?.toLowerCase() || 'unknown';\r\n      fileTypes[ext] = (fileTypes[ext] || 0) + 1;\r\n      if (row.project_id) projects.add(row.project_id);\r\n      if (row.category_name) categories.add(row.category_name);\r\n      if (row.subcategory_name) subcategories.add(row.subcategory_name);\r\n      if (row.vendedor_name) roles.add('vendedor');\r\n      if (row.laboratorio_name) roles.add('laboratorio');\r\n      if (row.file_size) totalSize += parseInt(row.file_size);\r\n    });\r\n\r\n    return {\r\n      total: total,\r\n      totalFiles: rows.length,\r\n      totalProjects: projects.size,\r\n      totalCategories: categories.size,\r\n      totalSubcategories: subcategories.size,\r\n      totalRoles: roles.size,\r\n      fileTypes: Object.keys(fileTypes).length,\r\n      totalSize: (totalSize / 1024 / 1024).toFixed(1) + ' MB'\r\n    };\r\n  }, [rows, total]);\r\n\r\n  const filterOptions = [\r\n    {\r\n      title: 'Por Proyecto',\r\n      options: projects.map(project => ({\r\n        label: `${project.name} - ${project.location}`,\r\n        filter: { project_id: project.id }\r\n      }))\r\n    },\r\n    {\r\n      title: 'Por Tipo de Archivo',\r\n      options: [\r\n        { label: '📄 PDF', filter: { file_type: 'pdf' } },\r\n        { label: '📝 Documentos', filter: { file_type: 'doc' } },\r\n        { label: '📊 Excel', filter: { file_type: 'xls' } },\r\n        { label: '🖼️ Imágenes', filter: { file_type: 'img' } }\r\n      ]\r\n    },\r\n    {\r\n      title: 'Por Estado de Proyecto',\r\n      options: [\r\n        { label: '🟢 Activos', filter: { project_status: 'activo' } },\r\n        { label: '🟡 Pendientes', filter: { project_status: 'pendiente' } },\r\n        { label: '🔵 Completados', filter: { project_status: 'completado' } },\r\n        { label: '🔴 Cancelados', filter: { project_status: 'cancelado' } }\r\n      ]\r\n    }\r\n  ];\r\n\r\n  return (\r\n    <>\r\n      <Container fluid className=\"py-4\">\r\n        <PageHeader\r\n          title=\"Gestión de Adjuntos\"\r\n          subtitle=\"Archivos relacionados a proyectos y cotizaciones\"\r\n          icon={FiFolder}\r\n        />\r\n\r\n        {/* Estadísticas */}\r\n        <Row className=\"mb-4\">\r\n          <Col md={6} lg={3}>\r\n            <StatsCard\r\n              title=\"Total Archivos\"\r\n              value={stats.total}\r\n              icon={FiFile}\r\n              color=\"primary\"\r\n              subtitle=\"Archivos en el sistema\"\r\n              loading={isLoading}\r\n            />\r\n          </Col>\r\n          <Col md={6} lg={3}>\r\n            <StatsCard\r\n              title=\"Proyectos\"\r\n              value={stats.totalProjects}\r\n              icon={FiFolder}\r\n              color=\"info\"\r\n              subtitle=\"Con archivos adjuntos\"\r\n              loading={isLoading}\r\n            />\r\n          </Col>\r\n          <Col md={6} lg={3}>\r\n            <StatsCard\r\n              title=\"Categorías\"\r\n              value={stats.totalCategories}\r\n              icon={FiUsers}\r\n              color=\"success\"\r\n              subtitle=\"Con archivos asignados\"\r\n              loading={isLoading}\r\n            />\r\n          </Col>\r\n          <Col md={6} lg={3}>\r\n            <StatsCard\r\n              title=\"Espacio Usado\"\r\n              value={stats.totalSize}\r\n              icon={FiAlertTriangle}\r\n              color=\"warning\"\r\n              subtitle=\"Almacenamiento total\"\r\n              loading={isLoading}\r\n            />\r\n          </Col>\r\n        </Row>\r\n\r\n        {/* Selector de Cliente y Proyecto */}\r\n        <Card className=\"mb-4\">\r\n          <Card.Body>\r\n            <Row>\r\n              <Col md={12}>\r\n                <h6 className=\"mb-3\">Filtro por Cliente y Proyecto</h6>\r\n                <CompanyProjectPicker \r\n                  value={clientProjectSelection} \r\n                  onChange={setClientProjectSelection} \r\n                />\r\n                {clientProjectSelection.project && (\r\n                  <div className=\"mt-3\">\r\n                    <Alert variant=\"info\" className=\"py-2\">\r\n                      <small>\r\n                        <strong>Proyecto seleccionado:</strong> {clientProjectSelection.project.name} | \r\n                        <strong> Cliente:</strong> {clientProjectSelection.company?.name} | \r\n                        <strong> Ubicación:</strong> {clientProjectSelection.project.location}\r\n                      </small>\r\n                    </Alert>\r\n                  </div>\r\n                )}\r\n              </Col>\r\n            </Row>\r\n          </Card.Body>\r\n        </Card>\r\n\r\n        {/* Barra de herramientas */}\r\n        <Card className=\"mb-4\">\r\n          <Card.Body>\r\n            <Row className=\"align-items-center\">\r\n              <Col md={6}>\r\n                <div className=\"d-flex gap-2\">\r\n                  <div className=\"position-relative flex-grow-1\">\r\n                    <FiSearch className=\"position-absolute top-50 start-0 translate-middle-y ms-3 text-muted\" />\r\n                    <Form.Control\r\n                      type=\"text\"\r\n                      placeholder=\"Buscar por archivo, proyecto...\"\r\n                      value={searchTerm}\r\n                      onChange={(e) => {\r\n                        setSearchTerm(e.target.value);\r\n                        setCurrentPage(1);\r\n                      }}\r\n                      className=\"ps-5\"\r\n                    />\r\n                  </div>\r\n                  <Button\r\n                    variant=\"outline-secondary\"\r\n                    onClick={() => refetch()}\r\n                    title=\"Actualizar\"\r\n                  >\r\n                    <FiRefreshCw />\r\n                  </Button>\r\n                </div>\r\n              </Col>\r\n              <Col md={6} className=\"text-end\">\r\n                <div className=\"d-flex gap-2 justify-content-end\">\r\n                  <Button\r\n                    variant=\"outline-primary\"\r\n                    onClick={() => setShowUploadModal(true)}\r\n                  >\r\n                    <FiUpload className=\"me-2\" />\r\n                    Subir Archivo\r\n                  </Button>\r\n                </div>\r\n              </Col>\r\n            </Row>\r\n          </Card.Body>\r\n        </Card>\r\n\r\n        {/* Tabla de adjuntos */}\r\n        <Card>\r\n          <Card.Body className=\"p-0\">\r\n            <DataTable\r\n              columns={columns}\r\n              data={rows}\r\n              loading={isLoading}\r\n              currentPage={currentPage}\r\n              totalPages={totalPages}\r\n              onPageChange={setCurrentPage}\r\n              totalItems={total}\r\n              itemsPerPage={limit}\r\n              filterOptions={filterOptions}\r\n              onFilter={handleFilter}\r\n              emptyMessage=\"No hay archivos adjuntos\"\r\n              emptyDescription=\"Sube tu primer archivo usando el botón 'Subir Archivo'\"\r\n            />\r\n          </Card.Body>\r\n        </Card>\r\n      </Container>\r\n\r\n      {/* Upload Modal */}\r\n      {showUploadModal && (\r\n        <Modal open={showUploadModal} onClose={() => setShowUploadModal(false)} size=\"xl\" className=\"adjuntos-modal\">\r\n          <div className=\"modal-header\">\r\n            <div className=\"d-flex align-items-center\">\r\n              <FiUpload className=\"me-2 text-primary\" size={24} />\r\n              <h4 className=\"mb-0\">Subir Archivo Adjunto</h4>\r\n            </div>\r\n            </div>\r\n          \r\n          <div className=\"modal-body\">\r\n            \r\n            <form onSubmit={handleUploadSubmit}>\r\n              <Row className=\"g-3\">\r\n                <Col md={12}>\r\n                  <Form.Label className=\"fw-medium\">Cliente y Proyecto *</Form.Label>\r\n                  <CompanyProjectPicker \r\n                    value={{\r\n                      company_id: uploadForm.company_id || null,\r\n                      company: uploadForm.company || null,\r\n                      project_id: uploadForm.project_id || null,\r\n                      project: uploadForm.project || null,\r\n                      project_name: uploadForm.project_name || '',\r\n                      location: uploadForm.location || ''\r\n                    }}\r\n                    onChange={(selection) => {\r\n                      setUploadForm(f => ({ \r\n                        ...f, \r\n                        company_id: selection.company_id,\r\n                        company: selection.company,\r\n                        project_id: selection.project_id,\r\n                        project: selection.project,\r\n                        project_name: selection.project_name,\r\n                        location: selection.location,\r\n                        category_id: selection.project?.category_id || '',\r\n                        subcategory_id: selection.project?.subcategory_id || ''\r\n                      }));\r\n                    }}\r\n                  />\r\n                </Col>\r\n\r\n                {/* Categorías disponibles */}\r\n                <Col md={12}>\r\n                  <div className=\"d-flex justify-content-between align-items-center mb-2\">\r\n                    <Form.Label className=\"fw-medium mb-0\">Categorías Disponibles</Form.Label>\r\n                    <Button \r\n                      variant=\"outline-secondary\" \r\n                      size=\"sm\"\r\n                      onClick={refreshCategoriesAndSubcategories}\r\n                      title=\"Actualizar lista de categorías\"\r\n                    >\r\n                      🔄 Actualizar\r\n                    </Button>\r\n                  </div>\r\n                  <div className=\"border rounded p-3 bg-light\" style={{ maxHeight: '200px', overflowY: 'auto' }}>\r\n                    {categories.length > 0 ? (\r\n                      categories.map(category => (\r\n                        <Form.Check\r\n                          key={category.id}\r\n                          type=\"checkbox\"\r\n                          id={`category-${category.id}`}\r\n                          label={`📁 ${category.name}`}\r\n                          checked={uploadForm.category_id === category.id}\r\n                          onChange={(e) => setUploadForm(f => ({ \r\n                            ...f, \r\n                            category_id: e.target.checked ? category.id : ''\r\n                          }))}\r\n                          className=\"mb-2\"\r\n                        />\r\n                      ))\r\n                    ) : (\r\n                      <p className=\"text-muted mb-0\">No hay categorías disponibles</p>\r\n                    )}\r\n                  </div>\r\n                  <Form.Text className=\"text-muted d-block mt-1\">\r\n                    Selecciona una categoría para asignar al archivo\r\n                  </Form.Text>\r\n                </Col>\r\n\r\n                {/* Subcategorías disponibles */}\r\n                <Col md={12}>\r\n                  <div className=\"d-flex justify-content-between align-items-center mb-2\">\r\n                    <Form.Label className=\"fw-medium mb-0\">Subcategorías Disponibles</Form.Label>\r\n                    <Button \r\n                      variant=\"outline-secondary\" \r\n                      size=\"sm\"\r\n                      onClick={refreshCategoriesAndSubcategories}\r\n                      title=\"Actualizar lista de subcategorías\"\r\n                    >\r\n                      🔄 Actualizar\r\n                    </Button>\r\n                  </div>\r\n                  <div className=\"border rounded p-3 bg-light\" style={{ maxHeight: '200px', overflowY: 'auto' }}>\r\n                    {subcategories.length > 0 ? (\r\n                      subcategories.map(subcategory => (\r\n                        <Form.Check\r\n                          key={subcategory.id}\r\n                          type=\"checkbox\"\r\n                          id={`subcategory-${subcategory.id}`}\r\n                          label={`📂 ${subcategory.name}`}\r\n                          checked={uploadForm.subcategory_id === subcategory.id}\r\n                          onChange={(e) => setUploadForm(f => ({ \r\n                            ...f, \r\n                            subcategory_id: e.target.checked ? subcategory.id : ''\r\n                          }))}\r\n                          className=\"mb-2\"\r\n                        />\r\n                      ))\r\n                    ) : (\r\n                      <p className=\"text-muted mb-0\">No hay subcategorías disponibles</p>\r\n                    )}\r\n                  </div>\r\n                  <Form.Text className=\"text-muted d-block mt-1\">\r\n                    Selecciona una subcategoría para asignar al archivo\r\n                  </Form.Text>\r\n                </Col>\r\n                \r\n                <Col md={12}>\r\n                  <Form.Label className=\"fw-medium\">Descripción (Opcional)</Form.Label>\r\n                  <Form.Control\r\n                    as=\"textarea\"\r\n                    rows={3}\r\n                    value={uploadForm.description}\r\n                    onChange={(e) => setUploadForm(f => ({ ...f, description: e.target.value }))}\r\n                    placeholder=\"Describe el contenido del archivo...\"\r\n                  />\r\n                </Col>\r\n\r\n                {/* Servicios del archivo */}\r\n                <Col md={12}>\r\n                  <Form.Label className=\"fw-medium\">Servicios Requeridos</Form.Label>\r\n                  <div className=\"border rounded p-3 bg-light\">\r\n                    <Row>\r\n                      <Col md={6}>\r\n                        <Form.Check\r\n                          type=\"checkbox\"\r\n                          id=\"upload-requiere-laboratorio\"\r\n                          label=\"🧪 Laboratorio\"\r\n                          checked={uploadForm.requiere_laboratorio}\r\n                          onChange={(e) => setUploadForm(f => ({ \r\n                            ...f, \r\n                            requiere_laboratorio: e.target.checked\r\n                          }))}\r\n                        />\r\n                      </Col>\r\n                      <Col md={6}>\r\n                        <Form.Check\r\n                          type=\"checkbox\"\r\n                          id=\"upload-requiere-ingenieria\"\r\n                          label=\"⚙️ Ingeniería\"\r\n                          checked={uploadForm.requiere_ingenieria}\r\n                          onChange={(e) => setUploadForm(f => ({ \r\n                            ...f, \r\n                            requiere_ingenieria: e.target.checked\r\n                          }))}\r\n                        />\r\n                      </Col>\r\n                      <Col md={6}>\r\n                        <Form.Check\r\n                          type=\"checkbox\"\r\n                          id=\"upload-requiere-consultoria\"\r\n                          label=\"💼 Consultoría\"\r\n                          checked={uploadForm.requiere_consultoria}\r\n                          onChange={(e) => setUploadForm(f => ({ \r\n                            ...f, \r\n                            requiere_consultoria: e.target.checked\r\n                          }))}\r\n                        />\r\n                      </Col>\r\n                      <Col md={6}>\r\n                        <Form.Check\r\n                          type=\"checkbox\"\r\n                          id=\"upload-requiere-capacitacion\"\r\n                          label=\"🎓 Capacitación\"\r\n                          checked={uploadForm.requiere_capacitacion}\r\n                          onChange={(e) => setUploadForm(f => ({ \r\n                            ...f, \r\n                            requiere_capacitacion: e.target.checked\r\n                          }))}\r\n                        />\r\n                      </Col>\r\n                      <Col md={6}>\r\n                        <Form.Check\r\n                          type=\"checkbox\"\r\n                          id=\"upload-requiere-auditoria\"\r\n                          label=\"📋 Auditoría\"\r\n                          checked={uploadForm.requiere_auditoria}\r\n                          onChange={(e) => setUploadForm(f => ({ \r\n                            ...f, \r\n                            requiere_auditoria: e.target.checked\r\n                          }))}\r\n                        />\r\n                      </Col>\r\n                    </Row>\r\n                    <Form.Text className=\"text-muted d-block mt-2\">\r\n                      Marca los servicios que requiere este archivo\r\n                    </Form.Text>\r\n                  </div>\r\n                </Col>\r\n                \r\n                <Col md={12}>\r\n                  <Form.Label className=\"fw-medium\">Archivo *</Form.Label>\r\n                  <div\r\n                    className={`border-2 border-dashed rounded p-4 text-center ${\r\n                      dragActive ? 'border-primary bg-light' : 'border-secondary'\r\n                    }`}\r\n                    onDragEnter={handleDragEnter}\r\n                    onDragLeave={handleDragLeave}\r\n                    onDragOver={handleDragOver}\r\n                    onDrop={handleDrop}\r\n                    style={{ minHeight: '120px', cursor: 'pointer' }}\r\n                    onClick={() => document.getElementById('fileInput').click()}\r\n                  >\r\n                    {uploadForm.file ? (\r\n                      <div>\r\n                        <FiCheckCircle className=\"text-success mb-2\" size={32} />\r\n                        <div className=\"fw-medium\">{uploadForm.file.name}</div>\r\n                        <small className=\"text-muted\">\r\n                          {(uploadForm.file.size / 1024 / 1024).toFixed(2)} MB\r\n                        </small>\r\n                      </div>\r\n                    ) : (\r\n                      <div>\r\n                        <FiUpload className=\"text-muted mb-2\" size={32} />\r\n                        <div className=\"fw-medium\">Arrastra y suelta tu archivo aquí</div>\r\n                        <small className=\"text-muted\">o haz clic para seleccionar</small>\r\n                        <div className=\"mt-2\">\r\n                          <small className=\"text-muted\">\r\n                            Formatos permitidos: PDF, DOC, DOCX, XLS, XLSX, PPT, PPTX, JPG, PNG, GIF, TXT\r\n                          </small>\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                  <Form.Control\r\n                    id=\"fileInput\"\r\n                    type=\"file\"\r\n                    className=\"d-none\"\r\n                    onChange={(e) => setUploadForm(f => ({ ...f, file: e.target.files[0] }))}\r\n                    accept=\".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.jpg,.jpeg,.png,.gif,.txt\"\r\n                    required\r\n                  />\r\n                </Col>\r\n              </Row>\r\n              \r\n              {createMutation.isLoading && (\r\n                <div className=\"mt-3\">\r\n                  <div className=\"d-flex justify-content-between align-items-center mb-2\">\r\n                    <small>Subiendo archivo...</small>\r\n                    <small>{uploadProgress}%</small>\r\n                  </div>\r\n                  <ProgressBar now={uploadProgress} animated />\r\n                </div>\r\n              )}\r\n              \r\n              <div className=\"d-flex justify-content-end gap-2 mt-4\">\r\n                <Button\r\n                  type=\"button\"\r\n                  variant=\"outline-secondary\"\r\n                  onClick={() => setShowUploadModal(false)}\r\n                  disabled={createMutation.isLoading}\r\n                >\r\n                  Cancelar\r\n                </Button>\r\n                <Button\r\n                  type=\"submit\"\r\n                  variant=\"primary\"\r\n                  disabled={createMutation.isLoading || !uploadForm.file || !uploadForm.project_id}\r\n                >\r\n                  {createMutation.isLoading ? (\r\n                    <>\r\n                      <Spinner size=\"sm\" className=\"me-2\" />\r\n                      Subiendo...\r\n                    </>\r\n                  ) : (\r\n                    <>\r\n                      <FiUpload className=\"me-2\" />\r\n                      Subir Archivo\r\n                    </>\r\n                  )}\r\n                </Button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n          \r\n          <div className=\"modal-footer\">\r\n            <div className=\"d-flex gap-2 justify-content-end\">\r\n              <Button\r\n                type=\"button\"\r\n                variant=\"outline-secondary\"\r\n                onClick={() => setShowUploadModal(false)}\r\n                disabled={createMutation.isLoading}\r\n              >\r\n                Cancelar\r\n              </Button>\r\n              <Button\r\n                type=\"submit\"\r\n                variant=\"primary\"\r\n                disabled={createMutation.isLoading}\r\n                onClick={handleUploadSubmit}\r\n              >\r\n                {createMutation.isLoading ? (\r\n                  <>\r\n                    <Spinner size=\"sm\" className=\"me-2\" />\r\n                    Subiendo...\r\n                  </>\r\n                ) : (\r\n                  <>\r\n                    <FiUpload className=\"me-2\" />\r\n                    Subir Archivo\r\n                  </>\r\n                )}\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </Modal>\r\n      )}\r\n\r\n      {/* Edit Modal */}\r\n      {showEditModal && editingAttachment && (\r\n        <Modal open={showEditModal} onClose={() => setShowEditModal(false)} size=\"xl\" className=\"adjuntos-modal\">\r\n          <div className=\"modal-header\">\r\n            <div className=\"d-flex align-items-center\">\r\n              <FiEdit className=\"me-2 text-success\" size={24} />\r\n              <h4 className=\"mb-0\">Editar Archivo Adjunto</h4>\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"modal-body\">\r\n            \r\n            <form onSubmit={handleEditSubmit}>\r\n              <Row className=\"g-3\">\r\n                <Col md={12}>\r\n                  <Form.Label className=\"fw-medium\">Proyecto</Form.Label>\r\n                  <Form.Control\r\n                    type=\"text\"\r\n                    value={editingAttachment.project_name || 'Sin proyecto'}\r\n                    readOnly\r\n                    className=\"bg-light\"\r\n                  />\r\n                </Col>\r\n                \r\n                <Col md={12}>\r\n                  <Form.Label className=\"fw-medium\">Archivo Actual</Form.Label>\r\n                  <div className=\"d-flex align-items-center p-3 bg-light rounded\">\r\n                    <span className=\"me-2\" style={{ fontSize: '1.2em' }}>\r\n                      {getFileIcon(editingAttachment.original_name)}\r\n                    </span>\r\n                    <div>\r\n                      <div className=\"fw-medium\">{editingAttachment.original_name}</div>\r\n                      <small className=\"text-muted\">\r\n                        {(editingAttachment.file_size / 1024 / 1024).toFixed(2)} MB\r\n                      </small>\r\n                    </div>\r\n                  </div>\r\n                </Col>\r\n                \r\n                <Col md={12}>\r\n                  <Form.Label className=\"fw-medium\">Nuevo Archivo (Opcional)</Form.Label>\r\n                  <Form.Control\r\n                    type=\"file\"\r\n                    onChange={(e) => setUploadForm(f => ({ ...f, file: e.target.files[0] }))}\r\n                    accept=\".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.jpg,.jpeg,.png,.gif,.txt\"\r\n                  />\r\n                  <Form.Text className=\"text-muted\">\r\n                    Deja vacío para mantener el archivo actual\r\n                  </Form.Text>\r\n                </Col>\r\n                \r\n                <Col md={12}>\r\n                  <Form.Label className=\"fw-medium\">Descripción</Form.Label>\r\n                  <Form.Control\r\n                    as=\"textarea\"\r\n                    rows={3}\r\n                    value={uploadForm.description}\r\n                    onChange={(e) => setUploadForm(f => ({ ...f, description: e.target.value }))}\r\n                    placeholder=\"Describe el contenido del archivo...\"\r\n                  />\r\n                </Col>\r\n\r\n                {/* Categorías disponibles en edición */}\r\n                <Col md={12}>\r\n                  <div className=\"d-flex justify-content-between align-items-center mb-2\">\r\n                    <Form.Label className=\"fw-medium mb-0\">Categorías Disponibles</Form.Label>\r\n                    <Button \r\n                      variant=\"outline-secondary\" \r\n                      size=\"sm\"\r\n                      onClick={refreshCategoriesAndSubcategories}\r\n                      title=\"Actualizar lista de categorías\"\r\n                    >\r\n                      🔄 Actualizar\r\n                    </Button>\r\n                  </div>\r\n                  <div className=\"border rounded p-3 bg-light\" style={{ maxHeight: '200px', overflowY: 'auto' }}>\r\n                    {categories.length > 0 ? (\r\n                      categories.map(category => (\r\n                        <Form.Check\r\n                          key={category.id}\r\n                          type=\"checkbox\"\r\n                          id={`edit-category-${category.id}`}\r\n                          label={`📁 ${category.name}`}\r\n                          checked={uploadForm.category_id === category.id}\r\n                          onChange={(e) => setUploadForm(f => ({ \r\n                            ...f, \r\n                            category_id: e.target.checked ? category.id : ''\r\n                          }))}\r\n                          className=\"mb-2\"\r\n                        />\r\n                      ))\r\n                    ) : (\r\n                      <p className=\"text-muted mb-0\">No hay categorías disponibles</p>\r\n                    )}\r\n                  </div>\r\n                  <Form.Text className=\"text-muted d-block mt-1\">\r\n                    Selecciona una categoría para asignar al archivo\r\n                  </Form.Text>\r\n                </Col>\r\n\r\n                {/* Subcategorías disponibles en edición */}\r\n                <Col md={12}>\r\n                  <div className=\"d-flex justify-content-between align-items-center mb-2\">\r\n                    <Form.Label className=\"fw-medium mb-0\">Subcategorías Disponibles</Form.Label>\r\n                    <Button \r\n                      variant=\"outline-secondary\" \r\n                      size=\"sm\"\r\n                      onClick={refreshCategoriesAndSubcategories}\r\n                      title=\"Actualizar lista de subcategorías\"\r\n                    >\r\n                      🔄 Actualizar\r\n                    </Button>\r\n                  </div>\r\n                  <div className=\"border rounded p-3 bg-light\" style={{ maxHeight: '200px', overflowY: 'auto' }}>\r\n                    {subcategories.length > 0 ? (\r\n                      subcategories.map(subcategory => (\r\n                        <Form.Check\r\n                          key={subcategory.id}\r\n                          type=\"checkbox\"\r\n                          id={`edit-subcategory-${subcategory.id}`}\r\n                          label={`📂 ${subcategory.name}`}\r\n                          checked={uploadForm.subcategory_id === subcategory.id}\r\n                          onChange={(e) => setUploadForm(f => ({ \r\n                            ...f, \r\n                            subcategory_id: e.target.checked ? subcategory.id : ''\r\n                          }))}\r\n                          className=\"mb-2\"\r\n                        />\r\n                      ))\r\n                    ) : (\r\n                      <p className=\"text-muted mb-0\">No hay subcategorías disponibles</p>\r\n                    )}\r\n                  </div>\r\n                  <Form.Text className=\"text-muted d-block mt-1\">\r\n                    Selecciona una subcategoría para asignar al archivo\r\n                  </Form.Text>\r\n                </Col>\r\n\r\n                {/* Servicios del archivo */}\r\n                <Col md={12}>\r\n                  <Form.Label className=\"fw-medium\">Servicios Requeridos</Form.Label>\r\n                  <div className=\"border rounded p-3 bg-light\">\r\n                    <Row>\r\n                      <Col md={6}>\r\n                        <Form.Check\r\n                          type=\"checkbox\"\r\n                          id=\"requiere-laboratorio\"\r\n                          label=\"🧪 Laboratorio\"\r\n                          checked={uploadForm.requiere_laboratorio}\r\n                          onChange={(e) => setUploadForm(f => ({ \r\n                            ...f, \r\n                            requiere_laboratorio: e.target.checked\r\n                          }))}\r\n                        />\r\n                      </Col>\r\n                      <Col md={6}>\r\n                        <Form.Check\r\n                          type=\"checkbox\"\r\n                          id=\"requiere-ingenieria\"\r\n                          label=\"⚙️ Ingeniería\"\r\n                          checked={uploadForm.requiere_ingenieria}\r\n                          onChange={(e) => setUploadForm(f => ({ \r\n                            ...f, \r\n                            requiere_ingenieria: e.target.checked\r\n                          }))}\r\n                        />\r\n                      </Col>\r\n                      <Col md={6}>\r\n                        <Form.Check\r\n                          type=\"checkbox\"\r\n                          id=\"requiere-consultoria\"\r\n                          label=\"💼 Consultoría\"\r\n                          checked={uploadForm.requiere_consultoria}\r\n                          onChange={(e) => setUploadForm(f => ({ \r\n                            ...f, \r\n                            requiere_consultoria: e.target.checked\r\n                          }))}\r\n                        />\r\n                      </Col>\r\n                      <Col md={6}>\r\n                        <Form.Check\r\n                          type=\"checkbox\"\r\n                          id=\"requiere-capacitacion\"\r\n                          label=\"🎓 Capacitación\"\r\n                          checked={uploadForm.requiere_capacitacion}\r\n                          onChange={(e) => setUploadForm(f => ({ \r\n                            ...f, \r\n                            requiere_capacitacion: e.target.checked\r\n                          }))}\r\n                        />\r\n                      </Col>\r\n                      <Col md={6}>\r\n                        <Form.Check\r\n                          type=\"checkbox\"\r\n                          id=\"requiere-auditoria\"\r\n                          label=\"📋 Auditoría\"\r\n                          checked={uploadForm.requiere_auditoria}\r\n                          onChange={(e) => setUploadForm(f => ({ \r\n                            ...f, \r\n                            requiere_auditoria: e.target.checked\r\n                          }))}\r\n                        />\r\n                      </Col>\r\n                    </Row>\r\n                    <Form.Text className=\"text-muted d-block mt-2\">\r\n                      Marca los servicios que requiere este archivo\r\n                    </Form.Text>\r\n                  </div>\r\n                </Col>\r\n              </Row>\r\n              \r\n              <div className=\"d-flex justify-content-end gap-2 mt-4\">\r\n                <Button\r\n                  type=\"button\"\r\n                  variant=\"outline-secondary\"\r\n                  onClick={() => setShowEditModal(false)}\r\n                  disabled={updateMutation.isLoading}\r\n                >\r\n                  Cancelar\r\n                </Button>\r\n                <Button\r\n                  type=\"submit\"\r\n                  variant=\"success\"\r\n                  disabled={updateMutation.isLoading}\r\n                >\r\n                  {updateMutation.isLoading ? (\r\n                    <>\r\n                      <Spinner size=\"sm\" className=\"me-2\" />\r\n                      Actualizando...\r\n                    </>\r\n                  ) : (\r\n                    <>\r\n                      <FiEdit className=\"me-2\" />\r\n                      Actualizar Archivo\r\n                    </>\r\n                  )}\r\n                </Button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n          \r\n          <div className=\"modal-footer\">\r\n            <div className=\"d-flex gap-2 justify-content-end\">\r\n              <Button\r\n                type=\"button\"\r\n                variant=\"outline-secondary\"\r\n                onClick={() => setShowEditModal(false)}\r\n                disabled={updateMutation.isLoading}\r\n              >\r\n                Cancelar\r\n              </Button>\r\n              <Button\r\n                type=\"submit\"\r\n                variant=\"success\"\r\n                disabled={updateMutation.isLoading}\r\n                onClick={handleEditSubmit}\r\n              >\r\n                {updateMutation.isLoading ? (\r\n                  <>\r\n                    <Spinner size=\"sm\" className=\"me-2\" />\r\n                    Actualizando...\r\n                  </>\r\n                ) : (\r\n                  <>\r\n                    <FiEdit className=\"me-2\" />\r\n                    Actualizar Archivo\r\n                  </>\r\n                )}\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </Modal>\r\n      )}\r\n\r\n      {/* Delete Confirmation Modal */}\r\n      {deletingAttachment && (\r\n        <Modal open={!!deletingAttachment} onClose={() => setDeletingAttachment(null)}>\r\n          <div>\r\n            <div className=\"d-flex align-items-center mb-4\">\r\n              <FiTrash2 className=\"me-2 text-danger\" size={24} />\r\n              <h4 className=\"mb-0\">Confirmar Eliminación</h4>\r\n            </div>\r\n            \r\n            <Alert variant=\"warning\" className=\"mb-4\">\r\n              <FiAlertTriangle className=\"me-2\" />\r\n              <strong>¡Atención!</strong> Esta acción no se puede deshacer.\r\n            </Alert>\r\n            \r\n            <div className=\"mb-4\">\r\n              <p>¿Estás seguro de que quieres eliminar el siguiente archivo?</p>\r\n              <Card className=\"bg-light\">\r\n                <Card.Body>\r\n                  <div className=\"d-flex align-items-center\">\r\n                    <span className=\"me-3\" style={{ fontSize: '1.5em' }}>\r\n                      {getFileIcon(deletingAttachment.original_name)}\r\n                    </span>\r\n                    <div>\r\n                      <div className=\"fw-medium\">{deletingAttachment.original_name}</div>\r\n                      <small className=\"text-muted\">\r\n                        Proyecto: {deletingAttachment.project_name || 'Sin proyecto'}\r\n                      </small>\r\n                    </div>\r\n                  </div>\r\n                </Card.Body>\r\n              </Card>\r\n            </div>\r\n            \r\n            <div className=\"d-flex justify-content-end gap-2\">\r\n              <Button\r\n                variant=\"outline-secondary\"\r\n                onClick={() => setDeletingAttachment(null)}\r\n                disabled={deleteMutation.isLoading}\r\n              >\r\n                Cancelar\r\n              </Button>\r\n              <Button\r\n                variant=\"danger\"\r\n                onClick={handleDeleteConfirm}\r\n                disabled={deleteMutation.isLoading}\r\n              >\r\n                {deleteMutation.isLoading ? (\r\n                  <>\r\n                    <Spinner size=\"sm\" className=\"me-2\" />\r\n                    Eliminando...\r\n                  </>\r\n                ) : (\r\n                  <>\r\n                    <FiTrash2 className=\"me-2\" />\r\n                    Eliminar Archivo\r\n                  </>\r\n                )}\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </Modal>\r\n      )}\r\n\r\n      <Toast \r\n        message={toast.message} \r\n        type={toast.type} \r\n        onClose={() => setToast({ message: '', type: 'success', show: false })} \r\n      />\r\n    </>\r\n  );\r\n}"],"names":["modalStyle","getCardStyle","size","className","baseStyle","Modal","open","onClose","children","cardStyle","jsx","e","listCategories","apiFetch","listSubcategories","categoryId","url","emptyForm","Adjuntos","currentPage","setCurrentPage","useState","limit","searchTerm","setSearchTerm","selectedProject","setSelectedProject","selectedFileType","setSelectedFileType","toast","setToast","location","useLocation","clientProjectSelection","setClientProjectSelection","showUploadModal","setShowUploadModal","showEditModal","setShowEditModal","uploadForm","setUploadForm","editingAttachment","setEditingAttachment","deletingAttachment","setDeletingAttachment","uploadProgress","setUploadProgress","dragActive","setDragActive","queryClient","useQueryClient","useEffect","_a","data","isLoading","refetch","useQuery","getAllAttachments","projectsData","listProjects","projects","useMemo","categoriesData","refetchCategories","categories","subcategoriesData","refetchSubcategories","subcategories","p","refreshCategoriesAndSubcategories","handleMutationSuccess","message","handleMutationError","error","defaultMessage","createMutation","useMutation","formData","uploadAttachment","err","updateMutation","id","updateAttachment","deleteMutation","deleteAttachment","handleUploadSubmit","handleEdit","attachment","handleEditSubmit","updateData","key","value","handleDeleteConfirm","handleDownload","downloadFile","handleDragEnter","handleDragLeave","handleDragOver","handleDrop","files","f","handleFilter","filters","getFileIcon","fileName","getFileTypeBadge","ext","getRoleBadge","role","getStatusBadge","status","columns","row","jsxs","Badge","fileType","Button","FiDownload","FiEdit","FiTrash2","rows","total","totalPages","stats","fileTypes","roles","totalSize","_b","filterOptions","project","Fragment","Container","PageHeader","FiFolder","Row","Col","StatsCard","FiFile","FiUsers","FiAlertTriangle","Card","CompanyProjectPicker","Alert","FiSearch","Form","FiRefreshCw","FiUpload","DataTable","selection","category","subcategory","FiCheckCircle","ProgressBar","Spinner","Toast"],"mappings":"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"}