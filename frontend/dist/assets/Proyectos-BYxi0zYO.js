import{r as o,e as je,j as e,Q as gs,p as y,w as $,S as Oe,T as bs,B as v,y as U,n as H,k as Y,b as vs,J as Ke,f as ee,o as J,g as Re,U as Ns,u as ys,V as fs,c as Ss,H as X,I as _s,W as Ue,L as Cs,m as $e,P as He,h as ws,X as Ve,x as ks,Y as we,s as Es,N as Ps}from"./index-D5j7Etbr.js";import{P as Fs}from"./PageHeader-BAMnoJ00.js";import{D as qs}from"./DataTable-BSDUXWv5.js";import{M as ke}from"./ModalForm-OWlJb50t.js";import{S as ue}from"./StatsCard-CrtJfzkh.js";import{d as Ts,c as As,u as Is,a as Ls,b as Ms,e as zs,f as Ds,l as Bs,g as Gs}from"./projects-C9osJ5rC.js";import{l as Ee,u as Rs,d as Us,a as $s}from"./attachments-BDNHx2oQ.js";import{l as Hs,a as Vs}from"./services-C2Sl43A8.js";import{a as n,R as M,C as f}from"./Row-BbCd5WYq.js";import{F as m}from"./InputGroup-CuAl69_P.js";import{S as Qe}from"./Spinner-DkvOZ9XA.js";import{A as pe}from"./Alert-5CgP0oJh.js";import{P as Qs}from"./ProgressBar-rK63zS-N.js";import{T as Os,a as W}from"./Tabs-cr3oJGkP.js";import"./Table-BrvfnYPw.js";/* empty css                     */import"./Modal-BtZGspVd.js";import"./ElementChildren-BZ8oKQvH.js";function Ks({selectedServices:w=[],onServicesChange:k,serviceType:p="laboratorio"}){const[P,i]=o.useState(""),[u,E]=o.useState(null),[b,q]=o.useState([]),{data:A,isLoading:N}=je(["services",p],()=>Hs({type:p}),{staleTime:5*60*1e3,cacheTime:10*60*1e3}),{data:L,isLoading:V}=je(["subservices",u==null?void 0:u.id],()=>u?Vs({service_id:u.id}):null,{enabled:!!u,staleTime:5*60*1e3,cacheTime:10*60*1e3}),z=(A==null?void 0:A.data)||(A==null?void 0:A.rows)||[],d=(L==null?void 0:L.data)||(L==null?void 0:L.rows)||[],T=z.filter(l=>{var j,_;return((j=l.name)==null?void 0:j.toLowerCase().includes(P.toLowerCase()))||((_=l.description)==null?void 0:_.toLowerCase().includes(P.toLowerCase()))}),se=l=>{E(l),q([])},Q=l=>{const j=b.some(_=>_.id===l.id);q(j?_=>_.filter(D=>D.id!==l.id):_=>[..._,l])},c=()=>{if(u&&b.length>0){const l={ensayo:u,subservices:b,total:b.reduce((j,_)=>j+(_.precio||0),0)};k([...w,l]),E(null),q([])}},h=l=>{const j=w.filter((_,D)=>D!==l);k(j)};return e.jsxs("div",{className:"service-selection",children:[e.jsxs(n,{className:"mb-4",children:[e.jsx(n.Header,{children:e.jsxs("h6",{className:"mb-0",children:[e.jsx(gs,{className:"me-2"}),"SelecciÃ³n de ",p==="laboratorio"?"Ensayos de Laboratorio":"Servicios de IngenierÃ­a"]})}),e.jsxs(n.Body,{children:[e.jsx("div",{className:"mb-3",children:e.jsx(m.Control,{type:"text",placeholder:`Buscar ${p==="laboratorio"?"ensayos":"servicios"}...`,value:P,onChange:l=>i(l.target.value)})}),N?e.jsxs("div",{className:"text-center py-4",children:[e.jsx(Qe,{animation:"border",variant:"primary"}),e.jsxs("p",{className:"mt-2 text-muted",children:["Cargando ",p==="laboratorio"?"ensayos":"servicios","..."]})]}):e.jsx(M,{className:"g-3",children:T.map(l=>e.jsx(f,{md:6,lg:4,children:e.jsx(n,{className:`h-100 cursor-pointer ${(u==null?void 0:u.id)===l.id?"border-primary":""}`,onClick:()=>se(l),children:e.jsxs(n.Body,{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[e.jsx("h6",{className:"mb-1",children:l.name}),(u==null?void 0:u.id)===l.id&&e.jsx(y,{bg:"primary",children:e.jsx($,{size:14})})]}),e.jsx("p",{className:"text-muted small mb-2",children:l.description||"Sin descripciÃ³n"}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("small",{className:"text-muted",children:[e.jsx(Oe,{className:"me-1",size:12}),l.norma||"N/A"]}),e.jsxs(y,{bg:"secondary",children:[l.subservices_count||0," subservicios"]})]})]})})},l.id))}),u&&e.jsxs(n,{className:"mt-4 border-primary",children:[e.jsx(n.Header,{children:e.jsxs("h6",{className:"mb-0",children:["Subservicios de: ",u.name]})}),e.jsxs(n.Body,{children:[V?e.jsxs("div",{className:"text-center py-3",children:[e.jsx(Qe,{animation:"border",size:"sm",variant:"primary"}),e.jsx("p",{className:"mt-2 text-muted small",children:"Cargando subservicios..."})]}):d.length>0?e.jsx(M,{className:"g-2",children:d.map(l=>{const j=b.some(_=>_.id===l.id);return e.jsx(f,{md:6,lg:4,children:e.jsx(n,{className:`h-100 cursor-pointer ${j?"border-success":""}`,onClick:()=>Q(l),children:e.jsxs(n.Body,{className:"p-3",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[e.jsx("h6",{className:"mb-1 small",children:l.codigo}),j&&e.jsx(y,{bg:"success",children:e.jsx($,{size:12})})]}),e.jsx("p",{className:"text-muted small mb-2",children:l.descripcion}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("small",{className:"text-muted",children:l.norma||"-"}),e.jsxs(y,{bg:l.precio>0?"success":"warning",children:[e.jsx(bs,{className:"me-1",size:10}),l.precio>0?`S/ ${l.precio}`:"Sujeto a evaluaciÃ³n"]})]})]})})},l.id)})}):e.jsxs(pe,{variant:"info",className:"mb-0",children:["No hay subservicios disponibles para este ",p==="laboratorio"?"ensayo":"servicio","."]}),b.length>0&&e.jsx("div",{className:"mt-3 text-center",children:e.jsxs(v,{variant:"success",onClick:c,disabled:b.length===0,children:[e.jsx($,{className:"me-1"}),"Agregar ",b.length," subservicio(s) seleccionado(s)"]})})]})]})]})]}),w.length>0&&e.jsxs(n,{className:"border-success",children:[e.jsx(n.Header,{children:e.jsxs("h6",{className:"mb-0 text-success",children:[e.jsx($,{className:"me-2"}),"Servicios Seleccionados (",w.length,")"]})}),e.jsx(n.Body,{children:w.map((l,j)=>e.jsx(n,{className:"mb-3",children:e.jsx(n.Body,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-start",children:[e.jsxs("div",{children:[e.jsx("h6",{className:"mb-1",children:l.ensayo.name}),e.jsx("p",{className:"text-muted small mb-2",children:l.ensayo.description}),e.jsx("div",{className:"d-flex flex-wrap gap-1",children:l.subservices.map((_,D)=>e.jsx(y,{bg:"info",className:"me-1",children:_.codigo},D))})]}),e.jsxs("div",{className:"text-end",children:[e.jsxs("h6",{className:"text-success mb-1",children:["S/ ",l.total.toFixed(2)]}),e.jsx(v,{variant:"outline-danger",size:"sm",onClick:()=>h(j),children:e.jsx(U,{size:14})})]})]})})},j))})]})]})}function Xe({onServicesChange:w,selectedServices:k=[],serviceType:p="laboratorio"}){const[P,i]=o.useState(p),u=b=>{i(b),w([])},E=b=>{w(b)};return e.jsxs(n,{className:"mb-4",children:[e.jsx(n.Header,{children:e.jsxs("h6",{className:"mb-0",children:[e.jsx(H,{className:"me-2"}),"ConfiguraciÃ³n de Servicios del Proyecto"]})}),e.jsxs(n.Body,{children:[e.jsx(M,{className:"mb-4",children:e.jsxs(f,{md:12,children:[e.jsx(m.Label,{className:"fw-bold",children:"Tipo de Servicio:"}),e.jsxs("div",{className:"d-flex gap-3",children:[e.jsx(m.Check,{type:"radio",id:"laboratorio",name:"serviceType",label:"Laboratorio",checked:P==="laboratorio",onChange:()=>u("laboratorio"),className:"d-flex align-items-center"}),e.jsx(m.Check,{type:"radio",id:"ingenieria",name:"serviceType",label:"IngenierÃ­a",checked:P==="ingenieria",onChange:()=>u("ingenieria"),className:"d-flex align-items-center"})]})]})}),P&&e.jsx(pe,{variant:"info",className:"mb-4",children:e.jsx("div",{className:"d-flex align-items-center",children:P==="laboratorio"?e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"me-2"}),e.jsxs("div",{children:[e.jsx("strong",{children:"Laboratorio:"})," Selecciona ensayos y sus subservicios especÃ­ficos.",e.jsx("br",{}),e.jsx("small",{className:"text-muted",children:"PodrÃ¡s elegir entre diferentes tipos de ensayos (ENSAYO ESTÃNDAR, ENSAYOS ESPECIALES, etc.) y sus subservicios correspondientes."})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"me-2"}),e.jsxs("div",{children:[e.jsx("strong",{children:"IngenierÃ­a:"})," Selecciona servicios de ingenierÃ­a y sus componentes.",e.jsx("br",{}),e.jsx("small",{className:"text-muted",children:"PodrÃ¡s elegir entre diferentes servicios de ingenierÃ­a y sus componentes especÃ­ficos."})]})]})})}),P&&e.jsx(Ks,{selectedServices:k,onServicesChange:E,serviceType:P}),k.length>0&&e.jsxs(n,{className:"border-success",children:[e.jsx(n.Header,{children:e.jsxs("h6",{className:"mb-0 text-success",children:[e.jsx($,{className:"me-2"}),"Resumen de Servicios Seleccionados"]})}),e.jsx(n.Body,{children:e.jsxs(M,{children:[e.jsxs(f,{md:6,children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Total de Servicios:"})," ",k.length]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Total de Subservicios:"})," ",k.reduce((b,q)=>b+q.subservices.length,0)]})]}),e.jsxs(f,{md:6,children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Subtotal:"})," S/ ",k.reduce((b,q)=>b+q.total,0).toFixed(2)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"IGV (18%):"})," S/ ",(k.reduce((b,q)=>b+q.total,0)*.18).toFixed(2)]}),e.jsxs("div",{className:"fw-bold text-success",children:[e.jsx("strong",{children:"Total:"})," S/ ",(k.reduce((b,q)=>b+q.total,0)*1.18).toFixed(2)]})]})]})})]})]})]})}const Xs=async(w,k)=>{try{const p=new URLSearchParams({type:w,q:k});return await vs(`/companies/search?${p.toString()}`)}catch(p){throw console.error("Error en bÃºsqueda de empresas:",p),p}};function Ws({data:w={},onSubmit:k,loading:p=!1,onCancel:P}){const[i,u]=o.useState({clientType:"",client_id:"",client_name:"",client_info:{},name:"",location:"",vendedor_id:"",laboratorio_id:"",contact_name:"",contact_phone:"",contact_email:"",queries:"",priority:"normal",marked:!1,selectedServices:[],serviceType:"laboratorio"}),[E,b]=o.useState(1),[q,A]=o.useState(!1),[N,L]=o.useState({}),[V,z]=o.useState(""),[d,T]=o.useState([]),[se,Q]=o.useState(!1),[c,h]=o.useState(!1),l=4;o.useEffect(()=>{w&&u(r=>({...r,...w,selectedServices:w.selectedServices||[],serviceType:w.serviceType||"laboratorio"}))},[w]);const j=(r,t)=>{u(F=>({...F,[r]:t})),N[r]&&L(F=>({...F,[r]:null}))},_=r=>{u(t=>({...t,selectedServices:r}))},D=async r=>{if(!r||r.length<2){T([]),h(!1);return}if(!i.clientType){T([]),h(!1);return}Q(!0);try{const t=await Xs(i.clientType,r);t.success?(T(t.data||[]),h(!0)):(T([]),h(!1))}catch(t){console.error("Error en bÃºsqueda:",t),T([]),h(!1)}finally{Q(!1)}},oe=r=>{u(t=>({...t,client_id:r.id,client_name:r.name,client_info:r})),z(r.name),h(!1)},ge=()=>{u(r=>({...r,client_id:"",client_name:"",client_info:{}})),z(""),T([]),h(!1)},Z=r=>{const t={};switch(r){case 1:i.clientType||(t.clientType="Selecciona el tipo de cliente"),i.client_id||(t.client_id="Selecciona un cliente"),i.name||(t.name="Nombre del proyecto es requerido"),i.location||(t.location="UbicaciÃ³n es requerida");break;case 2:i.contact_name||(t.contact_name="Persona de contacto es requerida"),i.contact_phone||(t.contact_phone="TelÃ©fono es requerido");break;case 3:i.selectedServices.length===0&&(t.services="Debes seleccionar al menos un servicio");break}return L(t),Object.keys(t).length===0},ae=()=>{Z(E)&&b(r=>Math.min(r+1,l))},ne=()=>{b(r=>Math.max(r-1,1))},re=()=>{Z(E)&&k(i)},B=r=>{switch(r){case 1:return e.jsx(J,{});case 2:return e.jsx(Re,{});case 3:return e.jsx(H,{});case 4:return e.jsx(ee,{});default:return e.jsx(J,{})}},de=r=>{switch(r){case 1:return"InformaciÃ³n BÃ¡sica";case 2:return"Contacto";case 3:return"Servicios";case 4:return"Resumen";default:return"Paso"}},I=()=>e.jsxs("div",{className:"step-content",children:[e.jsxs("h5",{className:"mb-4",children:[e.jsx(J,{className:"me-2"}),"InformaciÃ³n BÃ¡sica del Proyecto"]}),e.jsxs(M,{className:"g-3",children:[e.jsx(f,{md:12,children:e.jsxs(m.Group,{children:[e.jsx(m.Label,{className:"fw-bold",children:"Tipo de Cliente *"}),e.jsxs("div",{className:"d-flex gap-3",children:[e.jsx(m.Check,{type:"radio",id:"empresa",name:"clientType",label:"Empresa",checked:i.clientType==="empresa",onChange:()=>j("clientType","empresa"),className:"d-flex align-items-center"}),e.jsx(m.Check,{type:"radio",id:"persona_natural",name:"clientType",label:"Persona Natural",checked:i.clientType==="persona_natural",onChange:()=>j("clientType","persona_natural"),className:"d-flex align-items-center"})]}),N.clientType&&e.jsx(m.Control.Feedback,{type:"invalid",children:N.clientType})]})}),i.clientType&&e.jsx(f,{md:12,children:e.jsxs(m.Group,{children:[e.jsxs(m.Label,{className:"fw-bold",children:["Buscar ",i.clientType==="empresa"?"Empresa":"Persona Natural"," *"]}),e.jsxs("div",{className:"position-relative",children:[e.jsx(m.Control,{type:"text",value:V,onChange:r=>{const t=r.target.value;z(t),D(t)},placeholder:`Buscar ${i.clientType==="empresa"?"empresa":"persona natural"}...`,isInvalid:!!N.client_id}),se&&e.jsx("div",{className:"position-absolute top-50 end-0 translate-middle-y me-3",children:e.jsx("div",{className:"spinner-border spinner-border-sm",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Buscando..."})})}),c&&V&&e.jsx("div",{className:"position-absolute w-100 bg-white border rounded shadow-lg",style:{zIndex:1e3,maxHeight:"300px",overflowY:"auto"},children:d.length>0?d.map((r,t)=>e.jsxs("div",{className:"p-3 border-bottom cursor-pointer hover-bg-light",onClick:()=>oe(r),children:[e.jsx("div",{className:"fw-bold",children:r.name}),e.jsxs("div",{className:"text-muted small",children:[i.clientType==="empresa"?r.ruc:r.dni," â€¢ ",r.address]})]},t)):e.jsx("div",{className:"p-3 text-muted text-center",children:"No se encontraron resultados"})})]}),N.client_id&&e.jsx(m.Control.Feedback,{type:"invalid",children:N.client_id})]})}),i.client_id&&e.jsx(f,{md:12,children:e.jsxs(n,{className:"border-success",children:[e.jsxs(n.Header,{className:"bg-success text-white d-flex justify-content-between align-items-center",children:[e.jsxs("h6",{className:"mb-0",children:[e.jsx(ee,{className:"me-2"}),"Cliente Seleccionado"]}),e.jsxs(v,{variant:"outline-light",size:"sm",onClick:ge,className:"d-flex align-items-center",children:[e.jsx(U,{className:"me-1"}),"Cambiar"]})]}),e.jsx(n.Body,{children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("strong",{children:"Nombre:"})," ",i.client_name]}),e.jsxs("div",{className:"col-md-6",children:[e.jsxs("strong",{children:[i.clientType==="empresa"?"RUC":"DNI",":"]})," ",i.client_info.ruc||i.client_info.dni]}),e.jsxs("div",{className:"col-md-12 mt-2",children:[e.jsx("strong",{children:"DirecciÃ³n:"})," ",i.client_info.address]}),i.client_info.phone&&e.jsxs("div",{className:"col-md-6 mt-2",children:[e.jsx("strong",{children:"TelÃ©fono:"})," ",i.client_info.phone]}),i.client_info.email&&e.jsxs("div",{className:"col-md-6 mt-2",children:[e.jsx("strong",{children:"Email:"})," ",i.client_info.email]})]})})]})}),e.jsx(f,{md:12,children:e.jsxs(m.Group,{children:[e.jsx(m.Label,{className:"fw-bold",children:"Nombre del Proyecto *"}),e.jsx(m.Control,{type:"text",value:i.name,onChange:r=>j("name",r.target.value),placeholder:"Ingresa el nombre del proyecto",isInvalid:!!N.name}),N.name&&e.jsx(m.Control.Feedback,{type:"invalid",children:N.name})]})}),e.jsx(f,{md:12,children:e.jsxs(m.Group,{children:[e.jsx(m.Label,{className:"fw-bold",children:"UbicaciÃ³n *"}),e.jsx(m.Control,{type:"text",value:i.location,onChange:r=>j("location",r.target.value),placeholder:"Ingresa la ubicaciÃ³n del proyecto",isInvalid:!!N.location}),N.location&&e.jsx(m.Control.Feedback,{type:"invalid",children:N.location})]})})]})]}),me=()=>e.jsxs("div",{className:"step-content",children:[e.jsxs("h5",{className:"mb-4",children:[e.jsx(Re,{className:"me-2"}),"InformaciÃ³n de Contacto"]}),e.jsxs(M,{className:"g-3",children:[e.jsx(f,{md:6,children:e.jsxs(m.Group,{children:[e.jsx(m.Label,{className:"fw-bold",children:"Persona de Contacto *"}),e.jsx(m.Control,{type:"text",value:i.contact_name,onChange:r=>j("contact_name",r.target.value),placeholder:"Nombre completo",isInvalid:!!N.contact_name}),N.contact_name&&e.jsx(m.Control.Feedback,{type:"invalid",children:N.contact_name})]})}),e.jsx(f,{md:6,children:e.jsxs(m.Group,{children:[e.jsx(m.Label,{className:"fw-bold",children:"TelÃ©fono *"}),e.jsx(m.Control,{type:"tel",value:i.contact_phone,onChange:r=>j("contact_phone",r.target.value),placeholder:"NÃºmero de telÃ©fono",isInvalid:!!N.contact_phone}),N.contact_phone&&e.jsx(m.Control.Feedback,{type:"invalid",children:N.contact_phone})]})}),e.jsx(f,{md:12,children:e.jsxs(m.Group,{children:[e.jsx(m.Label,{className:"fw-bold",children:"Email"}),e.jsx(m.Control,{type:"email",value:i.contact_email,onChange:r=>j("contact_email",r.target.value),placeholder:"Email para comunicaciÃ³n"})]})}),e.jsx(f,{md:12,children:e.jsxs(m.Group,{children:[e.jsx(m.Label,{className:"fw-bold",children:"Consultas/Notas"}),e.jsx(m.Control,{as:"textarea",rows:4,value:i.queries,onChange:r=>j("queries",r.target.value),placeholder:"Consultas, notas o comentarios adicionales"})]})})]})]}),be=()=>e.jsxs("div",{className:"step-content",children:[e.jsxs("h5",{className:"mb-4",children:[e.jsx(H,{className:"me-2"}),"SelecciÃ³n de Servicios"]}),e.jsx(pe,{variant:"info",className:"mb-4",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(Ns,{className:"me-2"}),e.jsxs("div",{children:[e.jsx("strong",{children:"Selecciona los servicios que requiere este proyecto"}),e.jsx("br",{}),e.jsx("small",{children:"Puedes elegir entre servicios de Laboratorio o IngenierÃ­a"})]})]})}),e.jsxs("div",{className:"mb-4",children:[e.jsxs(v,{variant:"outline-primary",onClick:()=>A(!0),className:"w-100 py-3",size:"lg",children:[e.jsx(H,{className:"me-2"}),i.selectedServices.length>0?`Configurar Servicios (${i.selectedServices.length} seleccionados)`:"Seleccionar Servicios del Proyecto"]}),N.services&&e.jsx(pe,{variant:"danger",className:"mt-2",children:N.services})]}),i.selectedServices.length>0&&e.jsxs(n,{className:"border-success",children:[e.jsx(n.Header,{className:"bg-success text-white",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx(ee,{className:"me-2"}),"Servicios Seleccionados (",i.selectedServices.length,")"]})}),e.jsxs(n.Body,{children:[i.selectedServices.map((r,t)=>e.jsx("div",{className:"mb-3 p-3 border rounded bg-light",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-start",children:[e.jsxs("div",{children:[e.jsx("h6",{className:"mb-1",children:r.ensayo.name}),e.jsx("p",{className:"text-muted small mb-2",children:r.ensayo.description}),e.jsx("div",{className:"d-flex flex-wrap gap-1",children:r.subservices.map((F,G)=>e.jsx(y,{bg:"info",className:"me-1",children:F.codigo},G))})]}),e.jsxs("div",{className:"text-end",children:[e.jsxs("div",{className:"fw-bold text-success h5 mb-1",children:["S/ ",r.total.toFixed(2)]}),e.jsx(v,{variant:"outline-danger",size:"sm",onClick:()=>{const F=i.selectedServices.filter((G,O)=>O!==t);_(F)},children:e.jsx(U,{size:12})})]})]})},t)),e.jsx("div",{className:"mt-3 pt-3 border-top",children:e.jsxs(M,{children:[e.jsxs(f,{md:6,children:[e.jsxs("div",{className:"d-flex justify-content-between mb-2",children:[e.jsx("span",{children:"Subtotal:"}),e.jsxs("strong",{children:["S/ ",i.selectedServices.reduce((r,t)=>r+t.total,0).toFixed(2)]})]}),e.jsxs("div",{className:"d-flex justify-content-between mb-2",children:[e.jsx("span",{children:"IGV (18%):"}),e.jsxs("span",{children:["S/ ",(i.selectedServices.reduce((r,t)=>r+t.total,0)*.18).toFixed(2)]})]})]}),e.jsx(f,{md:6,children:e.jsxs("div",{className:"d-flex justify-content-between fw-bold text-success h5",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{children:["S/ ",(i.selectedServices.reduce((r,t)=>r+t.total,0)*1.18).toFixed(2)]})]})})]})})]})]})]}),ie=()=>e.jsxs("div",{className:"step-content",children:[e.jsxs("h5",{className:"mb-4",children:[e.jsx(ee,{className:"me-2"}),"Resumen del Proyecto"]}),e.jsxs(M,{className:"g-4",children:[e.jsx(f,{md:6,children:e.jsxs(n,{children:[e.jsx(n.Header,{children:e.jsx("h6",{className:"mb-0",children:"InformaciÃ³n BÃ¡sica"})}),e.jsxs(n.Body,{children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Proyecto:"})," ",i.name]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"UbicaciÃ³n:"})," ",i.location]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Contacto:"})," ",i.contact_name]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"TelÃ©fono:"})," ",i.contact_phone]}),i.contact_email&&e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Email:"})," ",i.contact_email]})]})]})}),e.jsx(f,{md:6,children:e.jsxs(n,{children:[e.jsx(n.Header,{children:e.jsx("h6",{className:"mb-0",children:"Servicios Seleccionados"})}),e.jsx(n.Body,{children:i.selectedServices.length>0?e.jsxs("div",{children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Total de Servicios:"})," ",i.selectedServices.length]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Total de Subservicios:"})," ",i.selectedServices.reduce((r,t)=>r+t.subservices.length,0)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Subtotal:"})," S/ ",i.selectedServices.reduce((r,t)=>r+t.total,0).toFixed(2)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"IGV (18%):"})," S/ ",(i.selectedServices.reduce((r,t)=>r+t.total,0)*.18).toFixed(2)]}),e.jsxs("div",{className:"fw-bold text-success h5",children:[e.jsx("strong",{children:"Total:"})," S/ ",(i.selectedServices.reduce((r,t)=>r+t.total,0)*1.18).toFixed(2)]})]}):e.jsxs("div",{className:"text-muted",children:[e.jsx(U,{className:"me-1"}),"No hay servicios seleccionados"]})})]})})]}),i.queries&&e.jsxs(n,{className:"mt-4",children:[e.jsx(n.Header,{children:e.jsx("h6",{className:"mb-0",children:"Consultas/Notas"})}),e.jsx(n.Body,{children:e.jsx("p",{className:"mb-0",children:i.queries})})]})]});return e.jsxs("div",{className:"project-form-redesigned",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[e.jsx("h6",{className:"mb-0",children:"Progreso del Formulario"}),e.jsxs("span",{className:"text-muted",children:[E," de ",l]})]}),e.jsx(Qs,{now:E/l*100,variant:"primary",style:{height:"8px"}})]}),e.jsx("div",{className:"mb-4",children:e.jsx(M,{className:"g-2",children:Array.from({length:l},(r,t)=>{const F=t+1,G=F===E,O=F<E;return e.jsx(f,{md:3,children:e.jsxs("div",{className:`step-indicator text-center p-3 rounded ${G?"bg-primary text-white":O?"bg-success text-white":"bg-light"}`,style:{cursor:"pointer"},onClick:()=>b(F),children:[e.jsx("div",{className:"mb-2",children:B(F)}),e.jsx("div",{className:"small fw-bold",children:de(F)})]})},F)})})}),e.jsx(n,{className:"mb-4",children:e.jsxs(n.Body,{children:[E===1&&I(),E===2&&me(),E===3&&be(),E===4&&ie()]})}),e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs(v,{variant:"outline-secondary",onClick:ne,disabled:E===1,children:[e.jsx(U,{className:"me-1"}),"Anterior"]}),e.jsxs("div",{children:[E<l?e.jsxs(v,{variant:"primary",onClick:ae,className:"me-2",children:["Siguiente",e.jsx(Ke,{className:"ms-1"})]}):e.jsxs(v,{variant:"success",onClick:re,disabled:p,className:"me-2",children:[p?"Creando...":"Crear Proyecto",e.jsx(ee,{className:"ms-1"})]}),e.jsx(v,{variant:"outline-danger",onClick:P,children:"Cancelar"})]})]}),q&&e.jsx("div",{className:"modal-backdrop",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",zIndex:1050,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{className:"modal-content bg-white rounded shadow-lg",style:{width:"90%",maxWidth:"1200px",maxHeight:"90vh",overflow:"auto"},children:[e.jsxs("div",{className:"modal-header p-4 border-bottom",children:[e.jsx("h5",{className:"mb-0",children:"Seleccionar Servicios del Proyecto"}),e.jsx(v,{variant:"outline-secondary",size:"sm",onClick:()=>A(!1),children:e.jsx(U,{})})]}),e.jsx("div",{className:"modal-body p-4",children:e.jsx(Xe,{selectedServices:i.selectedServices,onServicesChange:_,serviceType:i.serviceType})}),e.jsx("div",{className:"modal-footer p-4 border-top",children:e.jsxs(v,{variant:"success",onClick:()=>A(!1),children:[e.jsx($,{className:"me-1"}),"Confirmar SelecciÃ³n"]})})]})})]})}const Ys={company_id:"",name:"",location:"",vendedor_id:"",laboratorio_id:"",requiere_laboratorio:!1,requiere_ingenieria:!1,requiere_consultoria:!1,requiere_capacitacion:!1,requiere_auditoria:!1,contact_name:"",contact_phone:"",contact_email:"",queries:"",priority:"normal",marked:!1};function ga(){var ze,De,Be,Ge;const[w,k]=o.useState(!1),[p,P]=o.useState(null),[i,u]=o.useState(null),[E,b]=o.useState(!1),[q,A]=o.useState(!1),[N,L]=o.useState(!1),[V,z]=o.useState(!1),[d,T]=o.useState(null),[se,Q]=o.useState("view"),[c,h]=o.useState({}),[l,j]=o.useState(!1),[_,D]=o.useState(""),[oe,ge]=o.useState("success"),[Z,ae]=o.useState([]),[ne,re]=o.useState(!1),[B,de]=o.useState(null),[I,me]=o.useState([]),[be,ie]=o.useState(!1),[r,t]=o.useState(!0),[F,G]=o.useState(!1),[O,ve]=o.useState(1),[Pe,We]=o.useState(""),[Fe,Ye]=o.useState(""),[qe,Je]=o.useState(""),[Te,Ze]=o.useState(""),[Ae,es]=o.useState(""),[ss,Ie]=o.useState(!1);ys();const K=(ze=fs().state)==null?void 0:ze.selectedClient,he=Ss(),{data:C,isLoading:Le,refetch:as}=je(["projects",O,Pe,Fe,qe,Te,Ae],()=>Bs({page:O,limit:20,search:Pe,status:Fe,company_id:qe,project_type:Te,priority:Ae}),{keepPreviousData:!0,refetchOnWindowFocus:!1,refetchOnMount:!1,staleTime:3e4,cacheTime:3e5,retry:2,retryDelay:1e3}),{data:R,isLoading:xe}=je(["projectStats"],Gs,{refetchOnWindowFocus:!1,refetchOnMount:!1,staleTime:6e4,cacheTime:3e5,retry:1,onSuccess:s=>{console.log("ðŸ“Š Frontend - EstadÃ­sticas recibidas:",s),console.log("ðŸ“Š Frontend - alta_prioridad:",s==null?void 0:s.alta_prioridad)}});o.useEffect(()=>{(async()=>{if(d!=null&&d.id)try{const a=await Ee(d.id);ae(a)}catch(a){console.error("Error al cargar adjuntos:",a)}})()},[d==null?void 0:d.id,V]);const ce=s=>{he.invalidateQueries("projects"),he.invalidateQueries("projectStats"),k(!1),P(null),u(null)},g=(s,a="success")=>{D(s),ge(a),j(!0),setTimeout(()=>{j(!1)},5e3)},rs=s=>{console.log("ðŸ” handleSearch - BÃºsqueda:",s),We(s),ve(1),Ie(!0),setTimeout(()=>Ie(!1),1e3)},is=s=>{console.log("ðŸ” handleFilter - Filtros:",s),Ye(s.status||""),Je(s.company_id||""),Ze(s.project_type||""),es(s.priority||""),ve(1)},cs=s=>{const a=s.target.files[0];a&&de(a)},ls=async()=>{if(!B||!(d!=null&&d.id)){g("âŒ Por favor selecciona un archivo","danger");return}re(!0);try{const s=new FormData;s.append("file",B),s.append("description",`Archivo subido: ${B.name}`),await Rs(d.id,s);const a=await Ee(d.id);ae(a),de(null),re(!1),g("âœ… Archivo subido correctamente","success")}catch(s){console.error("Error al subir archivo:",s),re(!1),g("âŒ Error al subir archivo","danger")}},ts=async s=>{try{await Us(s),g("âœ… Archivo descargado correctamente","success")}catch(a){console.error("Error al descargar archivo:",a),g("âŒ Error al descargar archivo","danger")}},os=async s=>{if(window.confirm("Â¿EstÃ¡s seguro de que quieres eliminar este archivo?"))try{await $s(s);const a=await Ee(d.id);ae(a),g("âœ… Archivo eliminado correctamente","success")}catch(a){console.error("Error al eliminar archivo:",a),g("âŒ Error al eliminar archivo","danger")}},ns=[{title:"Por Estado",options:[{label:"Pendientes",filter:{status:"pendiente"}},{label:"Activos",filter:{status:"activo"}},{label:"Completados",filter:{status:"completado"}},{label:"Cancelados",filter:{status:"cancelado"}}]},{title:"Por Prioridad",options:[{label:"ðŸ”´ Urgente",filter:{priority:"urgent"}},{label:"ðŸŸ  Alta",filter:{priority:"high"}},{label:"ðŸ”µ Activo",filter:{priority:"active"}},{label:"ðŸŸ¢ Normal",filter:{priority:"normal"}},{label:"ðŸ”µ Baja",filter:{priority:"low"}}]},{title:"Por Tipo de Proyecto",options:[{label:"AnÃ¡lisis de Suelos",filter:{project_type:"AnÃ¡lisis de Suelos"}},{label:"Estudio GeotÃ©cnico",filter:{project_type:"Estudio GeotÃ©cnico"}},{label:"EvaluaciÃ³n Ambiental",filter:{project_type:"EvaluaciÃ³n Ambiental"}},{label:"Control de Calidad",filter:{project_type:"Control de Calidad"}},{label:"AnÃ¡lisis de Agua",filter:{project_type:"AnÃ¡lisis de Agua"}},{label:"Estudio de Impacto",filter:{project_type:"Estudio de Impacto"}},{label:"AnÃ¡lisis QuÃ­mico",filter:{project_type:"AnÃ¡lisis QuÃ­mico"}},{label:"Pruebas de Laboratorio",filter:{project_type:"Pruebas de Laboratorio"}},{label:"InspecciÃ³n TÃ©cnica",filter:{project_type:"InspecciÃ³n TÃ©cnica"}},{label:"CertificaciÃ³n de Materiales",filter:{project_type:"CertificaciÃ³n de Materiales"}}]}],Ne=X(As,{onSuccess:()=>ce(),onError:s=>console.error("Error creating project:",s)}),le=X(({id:s,data:a})=>Is(s,a),{onSuccess:s=>{console.log("âœ… updateMutation - Success:",s),T(s),h(s),g("âœ… Proyecto actualizado exitosamente!","success"),he.invalidateQueries("projects")},onError:s=>{console.error("âŒ updateMutation - Error:",s),g("âŒ Error al actualizar proyecto","danger")}}),ds=X(Ts,{onSuccess:()=>ce(),onError:s=>console.error("Error deleting project:",s)}),ye=X(({id:s,...a})=>Ls(s,a),{onSuccess:s=>{T(s),h(s),ce()},onError:s=>console.error("Error updating project status:",s)}),fe=X(({id:s,...a})=>Ms(s,a),{onSuccess:s=>{console.log("âœ… updateCategoriesMutation - Success:",s),T(s),h(s),g("âœ… CategorÃ­as guardadas correctamente!","success"),he.invalidateQueries("projects")},onError:s=>{console.error("âŒ updateCategoriesMutation - Error:",s),g("âŒ Error al guardar categorÃ­as","danger")}}),Se=X(({id:s,...a})=>zs(s,a),{onSuccess:s=>{T(s),h(s),ce()},onError:s=>console.error("Error updating project queries:",s)}),_e=X(({id:s,...a})=>Ds(s,a),{onSuccess:s=>{T(s),h(s),ce()},onError:s=>console.error("Error updating project mark:",s)}),ms=s=>{P(s),k(!0)},Me=s=>{window.confirm(`Â¿EstÃ¡s seguro de que quieres eliminar el proyecto "${s.name}"?`)&&ds.mutate(s.id)},hs=s=>{console.log("ðŸ” handleViewProject - Project recibido:",s),console.log("ðŸ” handleViewProject - Project.id:",s==null?void 0:s.id),console.log("ðŸ” handleViewProject - Type of project.id:",typeof(s==null?void 0:s.id)),T(s);const a={...s,requiere_laboratorio:s.requiere_laboratorio||!1,requiere_ingenieria:s.requiere_ingenieria||!1,requiere_consultoria:s.requiere_consultoria||!1,requiere_capacitacion:s.requiere_capacitacion||!1,requiere_auditoria:s.requiere_auditoria||!1,marked:s.marked||!1,priority:s.priority||"normal",queries:s.queries||"",contact_name:s.contact_name||"",contact_phone:s.contact_phone||"",contact_email:s.contact_email||"",category_id:s.category_id||"",subcategory_id:s.subcategory_id||"",category_name:s.category_name||"",subcategory_name:s.subcategory_name||""};console.log("ðŸ” handleViewProject - editingData inicializado:",a),h(a),Q("view"),z(!0)},xs=async s=>{p.id?await le.mutateAsync({id:p.id,...s}):await Ne.mutateAsync(s)},us=s=>{const x={activo:{bg:"success",text:"Activo"},pendiente:{bg:"warning",text:"Pendiente"},completado:{bg:"primary",text:"Completado"},cancelado:{bg:"danger",text:"Cancelado"}}[s]||{bg:"secondary",text:s};return e.jsx(y,{bg:x.bg,className:"status-badge",children:x.text})},js=[{header:"ID",accessor:"id",width:"80px"},{header:"Proyecto",accessor:"name",render:(s,a)=>e.jsxs("div",{children:[e.jsx("div",{className:"fw-medium",children:a.name}),a.location&&e.jsxs("small",{className:"text-muted",children:[e.jsx(Ps,{size:12,className:"me-1"}),a.location]})]})},{header:"Tipo de Proyecto",accessor:"project_type",render:(s,a)=>{const x=a.project_type||"General";let S="secondary";switch(x){case"AnÃ¡lisis de Suelos":S="success";break;case"Estudio GeotÃ©cnico":S="primary";break;case"EvaluaciÃ³n Ambiental":S="info";break;case"Control de Calidad":S="warning";break;case"AnÃ¡lisis de Agua":S="info";break;case"Estudio de Impacto":S="danger";break;case"AnÃ¡lisis QuÃ­mico":S="primary";break;case"Pruebas de Laboratorio":S="success";break;case"InspecciÃ³n TÃ©cnica":S="warning";break;case"CertificaciÃ³n de Materiales":S="info";break;default:S="secondary"}return e.jsx(y,{bg:S,className:"px-2 py-1",children:x})}},{header:"CategorÃ­a",accessor:"category_name",render:(s,a)=>e.jsxs("div",{children:[a.category_name&&e.jsx(y,{bg:"primary",className:"px-2 py-1 mb-1 d-block",children:a.category_name}),a.subcategory_name&&e.jsx(y,{bg:"secondary",className:"px-2 py-1 d-block",children:a.subcategory_name}),!a.category_name&&e.jsx("span",{className:"text-muted",children:"Sin categorÃ­a"})]})},{header:"Empresa",accessor:"company_name",render:(s,a)=>e.jsxs("div",{children:[e.jsx("div",{className:"fw-medium",children:a.company_name||"Sin empresa"}),a.company_ruc&&e.jsxs("small",{className:"text-muted",children:["RUC: ",a.company_ruc]})]})},{header:"Estado",accessor:"status",render:s=>us(s||"activo")},{header:"Servicios Requeridos",accessor:"services",render:(s,a)=>e.jsxs("div",{className:"d-flex flex-wrap gap-1",children:[a.requiere_laboratorio&&e.jsxs(y,{bg:"info",className:"px-2 py-1",children:[e.jsx(Y,{size:12,className:"me-1"}),"Laboratorio"]}),a.requiere_ingenieria&&e.jsxs(y,{bg:"primary",className:"px-2 py-1",children:[e.jsx(J,{size:12,className:"me-1"}),"IngenierÃ­a"]}),!a.requiere_laboratorio&&!a.requiere_ingenieria&&e.jsx(y,{bg:"secondary",className:"px-2 py-1",children:"Sin servicios"})]})},{header:"Prioridad",accessor:"priority",render:(s,a)=>{const S=(Ce=>{switch(Ce){case"urgent":return{emoji:"ðŸ”´",text:"Urgente",color:"text-danger",bgColor:"bg-danger"};case"high":return{emoji:"ðŸŸ ",text:"Alta",color:"text-warning",bgColor:"bg-warning"};case"active":return{emoji:"ðŸ”µ",text:"Activo",color:"text-info",bgColor:"bg-info"};case"low":return{emoji:"ðŸ”µ",text:"Baja",color:"text-primary",bgColor:"bg-primary"};case"normal":default:return{emoji:"ðŸŸ¢",text:"Normal",color:"text-success",bgColor:"bg-success"}}})(a.priority);return e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("span",{className:"me-2",style:{fontSize:"1.2em"},children:S.emoji}),e.jsx("span",{className:`small ${S.color} fw-medium`,children:S.text}),(a.priority==="urgent"||a.priority==="high")&&a.requiere_laboratorio&&e.jsx("span",{className:"ms-2",title:"Requiere atenciÃ³n prioritaria del laboratorio",children:e.jsx(Ue,{className:"text-warning",size:14})})]})}},{header:"Contacto",accessor:"contacto",render:(s,a)=>e.jsxs("div",{className:"small",children:[a.contact_name&&e.jsx("div",{children:e.jsx("strong",{children:a.contact_name})}),a.contact_phone&&e.jsx("div",{className:"text-muted",children:a.contact_phone}),a.contact_email&&e.jsx("div",{className:"text-muted",children:a.contact_email}),!a.contact_name&&!a.contact_phone&&!a.contact_email&&e.jsx("span",{className:"text-muted",children:"Sin contacto"})]})},{header:"Asignado a",accessor:"vendedor_name",render:(s,a)=>e.jsxs("div",{children:[a.vendedor_name&&e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(J,{size:14,className:"me-1 text-muted"}),e.jsx("span",{children:a.vendedor_name})]}),a.laboratorio_name&&e.jsxs("div",{className:"d-flex align-items-center mt-1",children:[e.jsx(Y,{size:14,className:"me-1 text-muted"}),e.jsx("span",{className:"small text-muted",children:a.laboratorio_name})]})]})},{header:"Fecha CreaciÃ³n",accessor:"created_at",type:"date"}],ps=[{name:"company_id",label:"Empresa/Cliente",type:"select",required:!0,options:((De=C==null?void 0:C.companies)==null?void 0:De.map(s=>({value:s.id,label:`${s.name} (${s.ruc||s.dni||"Sin RUC/DNI"})`})))||[],description:"Selecciona un cliente existente o crea uno nuevo desde el mÃ³dulo de clientes"},{name:"name",label:"Nombre del Proyecto",type:"text",required:!0,placeholder:"Ingresa el nombre del proyecto"},{name:"location",label:"UbicaciÃ³n del Proyecto",type:"text",placeholder:"Ingresa la ubicaciÃ³n del proyecto",required:!0},{name:"contact_name",label:"Persona de Contacto",type:"text",placeholder:"Nombre de la persona con quien negociar",description:"Persona responsable del proyecto en el cliente"},{name:"contact_phone",label:"TelÃ©fono de Contacto",type:"text",placeholder:"TelÃ©fono para comunicaciÃ³n directa",description:"NÃºmero para llamadas urgentes o seguimiento"},{name:"contact_email",label:"Email de Contacto",type:"email",placeholder:"Email para comunicaciÃ³n",description:"Email para envÃ­o de reportes y documentos"},{name:"requiere_laboratorio",label:"Requiere Laboratorio",type:"checkbox",description:"Marcar si el proyecto necesita servicios de laboratorio"},{name:"requiere_ingenieria",label:"Requiere IngenierÃ­a",type:"checkbox",description:"Marcar si el proyecto necesita servicios de ingenierÃ­a"},{name:"requiere_consultoria",label:"Requiere ConsultorÃ­a",type:"checkbox",description:"Marcar si el proyecto necesita servicios de consultorÃ­a"},{name:"requiere_capacitacion",label:"Requiere CapacitaciÃ³n",type:"checkbox",description:"Marcar si el proyecto necesita servicios de capacitaciÃ³n"},{name:"requiere_auditoria",label:"Requiere AuditorÃ­a",type:"checkbox",description:"Marcar si el proyecto necesita servicios de auditorÃ­a"},{name:"queries",label:"Consultas del Cliente",type:"textarea",placeholder:"Ingresa las consultas o dudas del cliente...",description:"Preguntas o dudas especÃ­ficas del cliente sobre el proyecto"},{name:"services",label:"Servicios del Proyecto",type:"custom",component:e.jsxs("div",{children:[e.jsx("div",{className:"mb-3",children:e.jsxs(v,{variant:"outline-primary",onClick:()=>ie(!0),className:"w-100",children:[e.jsx(H,{className:"me-2"}),I.length>0?`Configurar Servicios (${I.length} seleccionados)`:"Seleccionar Servicios"]})}),I.length>0&&e.jsxs("div",{className:"border rounded p-3 bg-light",children:[e.jsx("h6",{className:"mb-2",children:"Servicios Seleccionados:"}),I.map((s,a)=>e.jsx("div",{className:"mb-2 p-2 border rounded bg-white",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-start",children:[e.jsxs("div",{children:[e.jsx("strong",{children:s.ensayo.name}),e.jsx("div",{className:"small text-muted",children:s.subservices.map(x=>x.codigo).join(", ")})]}),e.jsxs("div",{className:"text-end",children:[e.jsxs("div",{className:"fw-bold text-success",children:["S/ ",s.total.toFixed(2)]}),e.jsx(v,{variant:"outline-danger",size:"sm",onClick:()=>{const x=I.filter((S,Ce)=>Ce!==a);me(x)},children:e.jsx(U,{size:12})})]})]})},a)),e.jsxs("div",{className:"mt-2 pt-2 border-top",children:[e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("strong",{children:"Subtotal:"}),e.jsxs("strong",{children:["S/ ",I.reduce((s,a)=>s+a.total,0).toFixed(2)]})]}),e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("span",{children:"IGV (18%):"}),e.jsxs("span",{children:["S/ ",(I.reduce((s,a)=>s+a.total,0)*.18).toFixed(2)]})]}),e.jsxs("div",{className:"d-flex justify-content-between fw-bold text-success",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{children:["S/ ",(I.reduce((s,a)=>s+a.total,0)*1.18).toFixed(2)]})]})]})]})]})},{name:"priority",label:"Prioridad del Proyecto",type:"select",options:[{value:"low",label:"Baja"},{value:"normal",label:"Normal"},{value:"high",label:"Alta"},{value:"urgent",label:"Urgente"}],description:"Nivel de prioridad para la ejecuciÃ³n del proyecto"},{name:"vendedor_id",label:"Vendedor Asignado",type:"select",options:((Be=C==null?void 0:C.users)==null?void 0:Be.filter(s=>["vendedor_comercial","jefa_comercial"].includes(s.role)).map(s=>({value:s.id,label:`${s.name} ${s.apellido}`})))||[]},{name:"laboratorio_id",label:"Responsable de Laboratorio",type:"select",options:((Ge=C==null?void 0:C.users)==null?void 0:Ge.filter(s=>["jefe_laboratorio","usuario_laboratorio","laboratorio"].includes(s.role)).map(s=>({value:s.id,label:`${s.name} ${s.apellido}`})))||[]}],te=o.useMemo(()=>{if(R)return console.log("ðŸ“Š Stats - Usando estadÃ­sticas reales del backend:",R),{total:R.total||0,activos:R.activos||0,completados:R.completados||0,pendientes:R.pendientes||0,cancelados:R.cancelados||0,alta_prioridad:R.alta_prioridad||0};const s=(C==null?void 0:C.data)||[];return console.log("ðŸ“Š Stats - Fallback: calculando desde pÃ¡gina actual:",s),{total:s.length,activos:s.filter(a=>a.status==="activo").length,completados:s.filter(a=>a.status==="completado").length,pendientes:s.filter(a=>a.status==="pendiente").length,cancelados:s.filter(a=>a.status==="cancelado").length,alta_prioridad:s.filter(a=>a.priority==="urgent"||a.priority==="high").length}},[R,C]);return e.jsxs(e.Fragment,{children:[e.jsx(_s,{fluid:!0,className:"py-4",children:e.jsxs("div",{className:"fade-in",children:[e.jsx(Fs,{title:"GestiÃ³n de Proyectos",subtitle:K?`Crear proyecto para: ${K.name}`:"Crear, editar y gestionar proyectos del sistema",icon:Y,actions:e.jsxs("div",{className:"d-flex gap-2",children:[K&&e.jsxs(y,{bg:"info",className:"px-3 py-2 d-flex align-items-center",children:[e.jsx(J,{className:"me-1"}),"Cliente: ",K.name]}),e.jsxs(v,{variant:"primary",onClick:()=>G(!0),children:[e.jsx(Ke,{className:"me-2"}),K?"Crear Proyecto":"Nuevo Proyecto"]})]})}),e.jsxs(M,{className:"g-4 mb-4",children:[e.jsx(f,{md:6,lg:3,children:e.jsx(ue,{title:"Total Proyectos",value:te.total,icon:Y,color:"primary",subtitle:"Proyectos registrados",loading:xe})}),e.jsx(f,{md:6,lg:3,children:e.jsx(ue,{title:"Proyectos Activos",value:te.activos,icon:ee,color:"success",subtitle:"En desarrollo",loading:xe})}),e.jsx(f,{md:6,lg:3,children:e.jsx(ue,{title:"Alta Prioridad",value:te.alta_prioridad||0,icon:Ue,color:"danger",subtitle:"ðŸ”´ Urgente + ðŸŸ  Alta",loading:xe})}),e.jsx(f,{md:6,lg:3,children:e.jsx(ue,{title:"Pendientes",value:te.pendientes,icon:Oe,color:"warning",subtitle:"Por iniciar",loading:xe})})]}),e.jsxs(n,{className:"shadow-sm border-0",children:[e.jsx(n.Header,{className:"bg-white border-bottom",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("h5",{className:"mb-0",children:[e.jsx(Y,{className:"me-2 text-primary"}),"Lista de Proyectos"]}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx(v,{variant:"outline-secondary",size:"sm",onClick:()=>as(),className:"d-flex align-items-center",title:"Actualizar datos",children:e.jsx(Cs,{className:`${Le?"spinning":""}`})}),e.jsxs(y,{bg:"light",text:"dark",className:"px-3 py-2",children:[te.total," proyectos"]})]})]})}),e.jsx(n.Body,{className:"p-0",children:e.jsx(qs,{data:(C==null?void 0:C.data)||[],columns:js,loading:Le||ss,onEdit:ms,onDelete:Me,actions:[{label:"Gestionar",icon:$e,onClick:hs,variant:"outline-primary"},{label:"Eliminar",icon:He,onClick:Me,variant:"outline-danger"}],emptyMessage:"No hay proyectos registrados",totalItems:(C==null?void 0:C.total)||0,itemsPerPage:20,currentPage:O,onPageChange:ve,onSearch:rs,onFilter:is,filterOptions:ns,getRowClassName:s=>s.status==="cancelado"?"table-secondary opacity-50 text-muted":""})})]}),e.jsx(ke,{show:w,onHide:()=>k(!1),title:p!=null&&p.id?"Editar Proyecto":"Nuevo Proyecto",data:p||Ys,fields:ps,onSubmit:xs,loading:Ne.isLoading||le.isLoading,submitText:p!=null&&p.id?"Actualizar":"Crear"}),e.jsx(ke,{show:V,onHide:()=>z(!1),title:`Gestionar Proyecto - ${(d==null?void 0:d.name)||""}`,data:c,fields:[{name:"project_management",label:"GestiÃ³n del Proyecto",type:"custom",render:s=>e.jsxs(Os,{activeKey:se,onSelect:a=>Q(a),className:"mb-3",children:[e.jsx(W,{eventKey:"view",title:e.jsxs("span",{children:[e.jsx($e,{className:"me-1"}),"Ver"]}),children:e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"border rounded p-3 h-100",children:[e.jsxs("h6",{className:"text-primary mb-3",children:[e.jsx(Y,{className:"me-2"}),"Datos Generales"]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"ID:"})," ",s.id]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Nombre:"})," ",s.name]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"UbicaciÃ³n:"})," ",s.location]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Tipo:"}),e.jsx(y,{bg:"info",className:"ms-2",children:s.project_type})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Estado:"}),e.jsx(y,{bg:"primary",className:"ms-2",children:s.status})]})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"border rounded p-3 h-100",children:[e.jsxs("h6",{className:"text-success mb-3",children:[e.jsx(J,{className:"me-2"}),"InformaciÃ³n de Contacto"]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Empresa:"})," ",s.company_name]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"RUC:"})," ",s.company_ruc]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Contacto:"})," ",s.contact_name||"Sin contacto"]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"TelÃ©fono:"})," ",s.contact_phone||"Sin telÃ©fono"]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Email:"})," ",s.contact_email||"Sin email"]})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"border rounded p-3 h-100",children:[e.jsxs("h6",{className:"text-warning mb-3",children:[e.jsx(H,{className:"me-2"}),"Servicios Requeridos"]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Laboratorio:"}),s.requiere_laboratorio?e.jsx(y,{bg:"info",className:"ms-2",children:"Requerido"}):e.jsx(y,{bg:"secondary",className:"ms-2",children:"No requerido"})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"IngenierÃ­a:"}),s.requiere_ingenieria?e.jsx(y,{bg:"success",className:"ms-2",children:"Requerido"}):e.jsx(y,{bg:"secondary",className:"ms-2",children:"No requerido"})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Estado Lab:"}),e.jsx(y,{bg:"info",className:"ms-2",children:s.laboratorio_status})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Estado Ing:"}),e.jsx(y,{bg:"success",className:"ms-2",children:s.ingenieria_status})]})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"border rounded p-3 h-100",children:[e.jsxs("h6",{className:"text-info mb-3",children:[e.jsx(ws,{className:"me-2"}),"Asignaciones"]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Vendedor:"})," ",s.vendedor_name||"Sin asignar"]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Laboratorio:"})," ",s.laboratorio_name||"Sin asignar"]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Fecha CreaciÃ³n:"})," ",new Date(s.created_at).toLocaleDateString()]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Ãšltima ActualizaciÃ³n:"})," ",new Date(s.updated_at).toLocaleDateString()]})]})}),s.status_notes&&e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"border rounded p-3",children:[e.jsxs("h6",{className:"text-muted mb-3",children:[e.jsx(Ve,{className:"me-2"}),"Notas del Estado"]}),e.jsx("p",{className:"mb-0",children:s.status_notes})]})})]})}),e.jsx(W,{eventKey:"edit",title:e.jsxs("span",{children:[e.jsx(ks,{className:"me-1"}),"Editar"]}),children:e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Nombre del Proyecto"}),e.jsx("input",{type:"text",className:"form-control",value:c.name||"",onChange:a=>h({...c,name:a.target.value})})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"UbicaciÃ³n"}),e.jsx("input",{type:"text",className:"form-control",value:c.location||"",onChange:a=>h({...c,location:a.target.value})})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Persona de Contacto"}),e.jsx("input",{type:"text",className:"form-control",value:c.contact_name||"",onChange:a=>h({...c,contact_name:a.target.value})})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"TelÃ©fono de Contacto"}),e.jsx("input",{type:"text",className:"form-control",value:c.contact_phone||"",onChange:a=>h({...c,contact_phone:a.target.value})})]})}),e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Email de Contacto"}),e.jsx("input",{type:"email",className:"form-control",value:c.contact_email||"",onChange:a=>h({...c,contact_email:a.target.value})})]})}),e.jsx("div",{className:"col-12",children:e.jsx(v,{variant:"primary",onClick:()=>{const a=d==null?void 0:d.id;if(!a){console.error("No se encontrÃ³ el ID del proyecto"),g("âŒ Error: No se encontrÃ³ el ID del proyecto","danger");return}const x=typeof a=="object"?a.id:a;le.mutate({id:x,data:c},{onSuccess:S=>{g("âœ… Proyecto actualizado exitosamente!","success")},onError:S=>{console.error("âŒ Guardar Cambios - Error:",S),g("âŒ Error al actualizar proyecto","danger")}})},disabled:le.isLoading,children:le.isLoading?"Guardando...":"Guardar Cambios"})})]})}),e.jsx(W,{eventKey:"status",title:e.jsxs("span",{children:[e.jsx(H,{className:"me-1"}),"Estado"]}),children:e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Estado del Proyecto"}),e.jsxs("select",{className:"form-select",value:c.status||"",onChange:a=>h({...c,status:a.target.value}),children:[e.jsx("option",{value:"pendiente",children:"Pendiente"}),e.jsx("option",{value:"activo",children:"Activo"}),e.jsx("option",{value:"en_proceso",children:"En Proceso"}),e.jsx("option",{value:"completado",children:"Completado"}),e.jsx("option",{value:"pausado",children:"Pausado"}),e.jsx("option",{value:"cancelado",children:"Cancelado"})]})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Estado del Laboratorio"}),e.jsxs("select",{className:"form-select",value:c.laboratorio_status||"",onChange:a=>h({...c,laboratorio_status:a.target.value}),children:[e.jsx("option",{value:"no_requerido",children:"No Requerido"}),e.jsx("option",{value:"pendiente",children:"Pendiente"}),e.jsx("option",{value:"en_proceso",children:"En Proceso"}),e.jsx("option",{value:"completado",children:"Completado"}),e.jsx("option",{value:"pausado",children:"Pausado"}),e.jsx("option",{value:"cancelado",children:"Cancelado"})]})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Estado de IngenierÃ­a"}),e.jsxs("select",{className:"form-select",value:c.ingenieria_status||"",onChange:a=>h({...c,ingenieria_status:a.target.value}),children:[e.jsx("option",{value:"no_requerido",children:"No Requerido"}),e.jsx("option",{value:"pendiente",children:"Pendiente"}),e.jsx("option",{value:"en_proceso",children:"En Proceso"}),e.jsx("option",{value:"completado",children:"Completado"}),e.jsx("option",{value:"pausado",children:"Pausado"}),e.jsx("option",{value:"cancelado",children:"Cancelado"})]})]})}),e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Notas del Estado"}),e.jsx("textarea",{className:"form-control",rows:"3",value:c.status_notes||"",onChange:a=>h({...c,status_notes:a.target.value}),placeholder:"Agrega comentarios sobre el cambio de estado..."})]})}),e.jsx("div",{className:"col-12",children:e.jsx(v,{variant:"success",onClick:()=>{const a=d==null?void 0:d.id;if(!a){console.error("No se encontrÃ³ el ID del proyecto"),g("âŒ Error: No se encontrÃ³ el ID del proyecto","danger");return}ye.mutate({id:a,...c},{onSuccess:x=>{console.log("âœ… Actualizar Estado - Ã‰xito:",x),g("âœ… Estado actualizado correctamente!","success")},onError:x=>{console.error("âŒ Actualizar Estado - Error:",x),g("âŒ Error al actualizar estado","danger")}})},disabled:ye.isLoading,children:ye.isLoading?"Actualizando...":"Actualizar Estado"})})]})}),e.jsx(W,{eventKey:"categories",title:e.jsxs("span",{children:[e.jsx(we,{className:"me-1"}),"CategorÃ­as"]}),children:e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12",children:[e.jsx("h6",{className:"mb-3",children:"CategorÃ­as del Proyecto"}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:"cat_laboratorio",checked:c.requiere_laboratorio||!1,onChange:a=>{console.log("ðŸ” requiere_laboratorio onChange:",a.target.checked),h({...c,requiere_laboratorio:a.target.checked})}}),e.jsx("label",{className:"form-check-label",htmlFor:"cat_laboratorio",children:"Laboratorio"})]}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:"cat_ingenieria",checked:c.requiere_ingenieria||!1,onChange:a=>h({...c,requiere_ingenieria:a.target.checked})}),e.jsx("label",{className:"form-check-label",htmlFor:"cat_ingenieria",children:"IngenierÃ­a"})]}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:"cat_consultoria",checked:c.requiere_consultoria||!1,onChange:a=>h({...c,requiere_consultoria:a.target.checked})}),e.jsx("label",{className:"form-check-label",htmlFor:"cat_consultoria",children:"ConsultorÃ­a"})]}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:"cat_capacitacion",checked:c.requiere_capacitacion||!1,onChange:a=>h({...c,requiere_capacitacion:a.target.checked})}),e.jsx("label",{className:"form-check-label",htmlFor:"cat_capacitacion",children:"CapacitaciÃ³n"})]}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:"cat_auditoria",checked:c.requiere_auditoria||!1,onChange:a=>h({...c,requiere_auditoria:a.target.checked})}),e.jsx("label",{className:"form-check-label",htmlFor:"cat_auditoria",children:"AuditorÃ­a"})]})]}),e.jsx("div",{className:"col-12",children:e.jsx(v,{variant:"info",onClick:()=>{const a=d==null?void 0:d.id;if(!a){console.error("No se encontrÃ³ el ID del proyecto"),g("âŒ Error: No se encontrÃ³ el ID del proyecto","danger");return}fe.mutate({id:a,requiere_laboratorio:c.requiere_laboratorio||!1,requiere_ingenieria:c.requiere_ingenieria||!1,requiere_consultoria:c.requiere_consultoria||!1,requiere_capacitacion:c.requiere_capacitacion||!1,requiere_auditoria:c.requiere_auditoria||!1},{onSuccess:x=>{console.log("âœ… Guardar CategorÃ­as - Ã‰xito:",x),g("âœ… CategorÃ­as guardadas correctamente!","success")},onError:x=>{console.error("âŒ Guardar CategorÃ­as - Error:",x),g("âŒ Error al guardar categorÃ­as","danger")}})},disabled:fe.isLoading,children:fe.isLoading?"Guardando...":"Guardar CategorÃ­as"})})]})}),e.jsx(W,{eventKey:"queries",title:e.jsxs("span",{children:[e.jsx(Ve,{className:"me-1"}),"Consultas"]}),children:e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Consultas y Dudas del Cliente"}),e.jsx("textarea",{className:"form-control",rows:"8",value:c.queries||"",onChange:a=>h({...c,queries:a.target.value}),placeholder:"Ingresa las consultas o dudas del cliente..."})]})}),e.jsx("div",{className:"col-12",children:e.jsx(v,{variant:"warning",onClick:()=>{const a=d==null?void 0:d.id;if(!a){console.error("No se encontrÃ³ el ID del proyecto"),g("âŒ Error: No se encontrÃ³ el ID del proyecto","danger");return}Se.mutate({id:a,queries:c.queries||""},{onSuccess:x=>{console.log("âœ… Guardar Consultas - Ã‰xito:",x),g("âœ… Consultas guardadas correctamente!","success")},onError:x=>{console.error("âŒ Guardar Consultas - Error:",x),g("âŒ Error al guardar consultas","danger")}})},disabled:Se.isLoading,children:Se.isLoading?"Guardando...":"Guardar Consultas"})})]})}),e.jsx(W,{eventKey:"mark",title:e.jsxs("span",{children:[e.jsx($,{className:"me-1"}),"Marcar"]}),children:e.jsx("div",{className:"row g-3",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h6",{className:"mb-3",children:"Marcar Proyecto"}),e.jsx("p",{className:"text-muted mb-4",children:"Marca este proyecto para seguimiento especial o prioridad alta."}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Prioridad"}),e.jsxs("select",{className:"form-select",value:c.priority||"normal",onChange:a=>h({...c,priority:a.target.value}),children:[e.jsx("option",{value:"low",children:"Baja"}),e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"active",children:"Activo"}),e.jsx("option",{value:"high",children:"Alta"}),e.jsx("option",{value:"urgent",children:"Urgente"})]})]}),e.jsxs(v,{variant:"success",size:"lg",onClick:()=>{const a=d==null?void 0:d.id;if(!a){console.error("No se encontrÃ³ el ID del proyecto"),g("âŒ Error: No se encontrÃ³ el ID del proyecto","danger");return}_e.mutate({id:a,marked:!c.marked,priority:c.priority||"normal"},{onSuccess:x=>{console.log("âœ… Marcar Proyecto - Ã‰xito:",x);const S=c.marked?"desmarcado":"marcado";g(`âœ… Proyecto ${S} correctamente!`,"success")},onError:x=>{console.error("âŒ Marcar Proyecto - Error:",x),g("âŒ Error al marcar proyecto","danger")}})},disabled:_e.isLoading,children:[e.jsx($,{className:"me-2"}),_e.isLoading?"Procesando...":c.marked?"Desmarcar Proyecto":"Marcar Proyecto"]})]})})})}),e.jsx(W,{eventKey:"attachments",title:e.jsxs("span",{children:[e.jsx(we,{className:"me-1"}),"Adjuntos"]}),children:e.jsx("div",{className:"row g-3",children:e.jsxs("div",{className:"col-12",children:[e.jsx("h6",{className:"mb-3",children:"GestiÃ³n de Archivos"}),e.jsxs("div",{className:"card mb-4",children:[e.jsx("div",{className:"card-header",children:e.jsx("h6",{className:"mb-0",children:"Subir Nuevo Archivo"})}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Seleccionar Archivo"}),e.jsx("input",{type:"file",className:"form-control",onChange:cs,accept:".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.jpg,.jpeg,.png,.gif,.txt"}),e.jsx("div",{className:"form-text",children:"Formatos permitidos: PDF, DOC, DOCX, XLS, XLSX, PPT, PPTX, JPG, JPEG, PNG, GIF, TXT (mÃ¡x. 10MB)"})]}),B&&e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"alert alert-info",children:[e.jsx("strong",{children:"Archivo seleccionado:"})," ",B.name,e.jsx("br",{}),e.jsxs("small",{children:["TamaÃ±o: ",(B.size/1024/1024).toFixed(2)," MB"]})]})}),e.jsx(v,{variant:"primary",onClick:ls,disabled:!B||ne,children:ne?"Subiendo...":"Subir Archivo"})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h6",{className:"mb-0",children:["Archivos Adjuntos (",Z.length,")"]})}),e.jsx("div",{className:"card-body",children:Z.length===0?e.jsxs("div",{className:"text-center text-muted py-4",children:[e.jsx(we,{size:48,className:"mb-3"}),e.jsx("p",{children:"No hay archivos adjuntos"}),e.jsx("small",{children:"Sube archivos como cotizaciones, documentos tÃ©cnicos, etc."})]}):e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-hover",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Archivo"}),e.jsx("th",{children:"TamaÃ±o"}),e.jsx("th",{children:"Fecha"}),e.jsx("th",{children:"Subido por"}),e.jsx("th",{children:"Acciones"})]})}),e.jsx("tbody",{children:Z.map(a=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{children:[e.jsx("strong",{children:a.original_name}),a.description&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("small",{className:"text-muted",children:a.description})]})]})}),e.jsx("td",{children:a.file_size?`${(a.file_size/1024/1024).toFixed(2)} MB`:"N/A"}),e.jsx("td",{children:new Date(a.created_at).toLocaleDateString()}),e.jsx("td",{children:a.uploaded_by_name||"Usuario"}),e.jsx("td",{children:e.jsxs("div",{className:"btn-group btn-group-sm",children:[e.jsx(v,{variant:"outline-primary",size:"sm",onClick:()=>ts(a),title:"Descargar",children:e.jsx(Es,{size:14})}),e.jsx(v,{variant:"outline-danger",size:"sm",onClick:()=>os(a.id),title:"Eliminar",children:e.jsx(He,{size:14})})]})})]},a.id))})]})})})]})]})})})]})}],onSubmit:()=>z(!1),submitText:"Cerrar",size:"xl"})]})}),l&&e.jsxs("div",{style:{position:"fixed",top:"20px",right:"20px",zIndex:99999,backgroundColor:oe==="success"?"#28a745":"#dc3545",color:"white",padding:"15px 20px",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.3)",minWidth:"300px",border:"none"},onClick:()=>j(!1),children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"5px"},children:oe==="success"?"âœ… Ã‰xito":"âŒ Error"}),e.jsx("div",{children:_})]}),e.jsx(ke,{show:be,onHide:()=>ie(!1),title:"Seleccionar Servicios del Proyecto",size:"xl",data:{},fields:[],onSubmit:()=>ie(!1),loading:!1,submitText:"Cerrar",customBody:e.jsx(Xe,{selectedServices:I,onServicesChange:me,serviceType:"laboratorio"})}),F&&e.jsx("div",{className:"modal-backdrop",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",zIndex:1050,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{className:"modal-content bg-white rounded shadow-lg",style:{width:"90%",maxWidth:"1200px",maxHeight:"90vh",overflow:"auto"},children:[e.jsxs("div",{className:"modal-header p-4 border-bottom d-flex justify-content-between align-items-center",children:[e.jsx("h5",{className:"mb-0",children:"Crear Nuevo Proyecto"}),e.jsx(v,{variant:"outline-secondary",size:"sm",onClick:()=>G(!1),children:e.jsx(U,{})})]}),e.jsx("div",{className:"modal-body p-4",children:e.jsx(Ws,{data:K?{company_id:K.id}:{},onSubmit:s=>{console.log("Datos del formulario:",s),G(!1)},onCancel:()=>G(!1),loading:Ne.isLoading})})]})})]})}export{ga as default};
//# sourceMappingURL=Proyectos-BYxi0zYO.js.map
