import{r as c,ae as te,Z as S,j as a,_ as y,af as Ee,ag as Be,ah as Te,ai as P,aj as De,ak as ee,al as Ie,am as $e,Y as se,an as Ae,ao as Le,ap as Oe,aq as Ue,B as ae,w as qe,D as Ge}from"./index-sJ-fqi2A.js";import{F as l}from"./Form-CC49TUrP.js";import{R as ze,C as He}from"./PageHeader-CKES-3QI.js";import{S as We}from"./Spinner-ROzCSctr.js";function _e(n){const t=c.useRef(n);return t.current=n,t}function Ke(n){const t=_e(n);c.useEffect(()=>()=>t.current(),[])}var I;function ne(n){if((!I&&I!==0||n)&&te){var t=document.createElement("div");t.style.position="absolute",t.style.top="-9999px",t.style.width="50px",t.style.height="50px",t.style.overflow="scroll",document.body.appendChild(t),I=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return I}function Ve(){return c.useState(null)}const re=c.forwardRef(({className:n,bsPrefix:t,as:h="div",...i},u)=>(t=S(t,"modal-body"),a.jsx(h,{ref:u,className:y(n,t),...i})));re.displayName="ModalBody";const z=c.forwardRef(({bsPrefix:n,className:t,contentClassName:h,centered:i,size:u,fullscreen:x,children:b,scrollable:F,...k},f)=>{n=S(n,"modal");const p=`${n}-dialog`,E=typeof x=="string"?`${n}-fullscreen-${x}`:`${n}-fullscreen`;return a.jsx("div",{...k,ref:f,className:y(p,t,u&&`${n}-${u}`,i&&`${p}-centered`,F&&`${p}-scrollable`,x&&E),children:a.jsx("div",{className:y(`${n}-content`,h),children:b})})});z.displayName="ModalDialog";const oe=c.forwardRef(({className:n,bsPrefix:t,as:h="div",...i},u)=>(t=S(t,"modal-footer"),a.jsx(h,{ref:u,className:y(n,t),...i})));oe.displayName="ModalFooter";const le=c.forwardRef(({bsPrefix:n,className:t,closeLabel:h="Close",closeButton:i=!1,...u},x)=>(n=S(n,"modal-header"),a.jsx(Ee,{ref:x,...u,className:y(t,n),closeLabel:h,closeButton:i})));le.displayName="ModalHeader";const Xe=Be("h4"),ce=c.forwardRef(({className:n,bsPrefix:t,as:h=Xe,...i},u)=>(t=S(t,"modal-title"),a.jsx(h,{ref:u,className:y(n,t),...i})));ce.displayName="ModalTitle";function Ye(n){return a.jsx(se,{...n,timeout:null})}function Ze(n){return a.jsx(se,{...n,timeout:null})}const de=c.forwardRef(({bsPrefix:n,className:t,style:h,dialogClassName:i,contentClassName:u,children:x,dialogAs:b=z,"data-bs-theme":F,"aria-labelledby":k,"aria-describedby":f,"aria-label":p,show:E=!1,animation:m=!0,backdrop:N=!0,keyboard:g=!0,onEscapeKeyDown:v,onShow:$,onHide:C,container:M,autoFocus:w=!0,enforceFocus:A=!0,restoreFocus:L=!0,restoreFocusOptions:O,onEntered:e,onExit:r,onExiting:o,onEnter:j,onEntering:d,onExited:H,backdropClassName:W,manager:_,...ue},me)=>{const[ie,he]=c.useState({}),[pe,K]=c.useState(!1),U=c.useRef(!1),q=c.useRef(!1),B=c.useRef(null),[T,xe]=Ve(),ge=Te(me,xe),V=P(C),je=De();n=S(n,"modal");const ye=c.useMemo(()=>({onHide:V}),[V]);function X(){return _||Ae({isRTL:je})}function Y(s){if(!te)return;const R=X().getScrollbarWidth()>0,Q=s.scrollHeight>Oe(s).documentElement.clientHeight;he({paddingRight:R&&!Q?ne():void 0,paddingLeft:!R&&Q?ne():void 0})}const G=P(()=>{T&&Y(T.dialog)});Ke(()=>{ee(window,"resize",G),B.current==null||B.current()});const be=()=>{U.current=!0},Ne=s=>{U.current&&T&&s.target===T.dialog&&(q.current=!0),U.current=!1},Z=()=>{K(!0),B.current=Ue(T.dialog,()=>{K(!1)})},ve=s=>{s.target===s.currentTarget&&Z()},Ce=s=>{if(N==="static"){ve(s);return}if(q.current||s.target!==s.currentTarget){q.current=!1;return}C==null||C()},Me=s=>{g?v==null||v(s):(s.preventDefault(),N==="static"&&Z())},we=(s,R)=>{s&&Y(s),j==null||j(s,R)},Re=s=>{B.current==null||B.current(),r==null||r(s)},Se=(s,R)=>{d==null||d(s,R),Le(window,"resize",G)},Fe=s=>{s&&(s.style.display=""),H==null||H(s),ee(window,"resize",G)},ke=c.useCallback(s=>a.jsx("div",{...s,className:y(`${n}-backdrop`,W,!m&&"show")}),[m,W,n]),J={...h,...ie};J.display="block";const fe=s=>a.jsx("div",{role:"dialog",...s,style:J,className:y(t,n,pe&&`${n}-static`,!m&&"show"),onClick:N?Ce:void 0,onMouseUp:Ne,"data-bs-theme":F,"aria-label":p,"aria-labelledby":k,"aria-describedby":f,children:a.jsx(b,{...ue,onMouseDown:be,className:i,contentClassName:u,children:x})});return a.jsx(Ie.Provider,{value:ye,children:a.jsx($e,{show:E,ref:ge,backdrop:N,container:M,keyboard:!0,autoFocus:w,enforceFocus:A,restoreFocus:L,restoreFocusOptions:O,onEscapeKeyDown:Me,onShow:$,onHide:C,onEnter:we,onEntering:Se,onEntered:e,onExit:Re,onExiting:o,onExited:Fe,manager:X(),transition:m?Ye:void 0,backdropTransition:m?Ze:void 0,renderBackdrop:ke,renderDialog:fe})})});de.displayName="Modal";const D=Object.assign(de,{Body:re,Header:le,Title:ce,Footer:oe,Dialog:z,TRANSITION_DURATION:300,BACKDROP_TRANSITION_DURATION:150}),aa=({show:n,onHide:t,title:h,data:i={},fields:u=[],onSubmit:x,loading:b=!1,size:F="lg",submitText:k="Guardar",cancelText:f="Cancelar",validation:p={},className:E=""})=>{const[m,N]=c.useState({}),[g,v]=c.useState({}),[$,C]=c.useState({});c.useEffect(()=>{n&&(N(i),v({}),C({}))},[n,i]);const M=(e,r)=>{N(o=>({...o,[e]:r})),g[e]&&v(o=>({...o,[e]:null}))},w=e=>{if(C(r=>({...r,[e]:!0})),p[e]){const r=p[e](m[e],m);r&&v(o=>({...o,[e]:r}))}},A=()=>{const e={};let r=!0;return u.forEach(o=>{if(o.required&&(!m[o.name]||m[o.name]===""))e[o.name]=`${o.label} es requerido`,r=!1;else if(p[o.name]){const j=p[o.name](m[o.name],m);j&&(e[o.name]=j,r=!1)}}),v(e),r},L=async e=>{if(e.preventDefault(),A())try{await x(m),t()}catch(r){console.error("Error submitting form:",r)}},O=e=>{var j;const r=$[e.name]&&g[e.name],o=m[e.name]||"";switch(e.type){case"text":case"email":case"password":return a.jsxs(l.Group,{className:"mb-3",children:[a.jsxs(l.Label,{children:[e.label,e.required&&a.jsx("span",{className:"text-danger ms-1",children:"*"})]}),a.jsx(l.Control,{type:e.type,name:e.name,value:o,onChange:d=>M(e.name,d.target.value),onBlur:()=>w(e.name),isInvalid:r,placeholder:e.placeholder,disabled:e.disabled}),r&&a.jsx(l.Control.Feedback,{type:"invalid",children:g[e.name]}),e.help&&a.jsx(l.Text,{className:"text-muted",children:e.help})]},e.name);case"textarea":return a.jsxs(l.Group,{className:"mb-3",children:[a.jsxs(l.Label,{children:[e.label,e.required&&a.jsx("span",{className:"text-danger ms-1",children:"*"})]}),a.jsx(l.Control,{as:"textarea",rows:e.rows||3,name:e.name,value:o,onChange:d=>M(e.name,d.target.value),onBlur:()=>w(e.name),isInvalid:r,placeholder:e.placeholder}),r&&a.jsx(l.Control.Feedback,{type:"invalid",children:g[e.name]})]},e.name);case"select":return a.jsxs(l.Group,{className:"mb-3",children:[a.jsxs(l.Label,{children:[e.label,e.required&&a.jsx("span",{className:"text-danger ms-1",children:"*"})]}),a.jsxs(l.Select,{name:e.name,value:o,onChange:d=>M(e.name,d.target.value),onBlur:()=>w(e.name),isInvalid:r,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(j=e.options)==null?void 0:j.map(d=>a.jsx("option",{value:d.value,children:d.label},d.value))]}),r&&a.jsx(l.Control.Feedback,{type:"invalid",children:g[e.name]})]},e.name);case"number":return a.jsxs(l.Group,{className:"mb-3",children:[a.jsxs(l.Label,{children:[e.label,e.required&&a.jsx("span",{className:"text-danger ms-1",children:"*"})]}),a.jsx(l.Control,{type:"number",name:e.name,value:o,onChange:d=>M(e.name,parseFloat(d.target.value)||""),onBlur:()=>w(e.name),isInvalid:r,placeholder:e.placeholder,min:e.min,max:e.max,step:e.step}),r&&a.jsx(l.Control.Feedback,{type:"invalid",children:g[e.name]})]},e.name);case"checkbox":return a.jsx(l.Group,{className:"mb-3",children:a.jsx(l.Check,{type:"checkbox",name:e.name,checked:!!o,onChange:d=>M(e.name,d.target.checked),label:e.label})},e.name);case"custom":return a.jsx("div",{className:"mb-3",children:e.render&&e.render(m)},e.name);default:return null}};return a.jsxs(D,{show:n,onHide:t,size:F,className:E,children:[a.jsx(D.Header,{closeButton:!0,className:"border-0 pb-0",children:a.jsx(D.Title,{className:"fw-bold",children:h})}),a.jsxs(l,{onSubmit:L,children:[a.jsx(D.Body,{className:"pt-0",children:a.jsx(ze,{children:u.map(e=>a.jsx(He,{md:e.col||12,children:O(e)},e.name))})}),a.jsxs(D.Footer,{className:"border-0 pt-0",children:[a.jsxs(ae,{variant:"outline-secondary",onClick:t,disabled:b,children:[a.jsx(qe,{className:"me-1"}),f]}),a.jsx(ae,{type:"submit",variant:"primary",disabled:b,children:b?a.jsxs(a.Fragment,{children:[a.jsx(We,{size:"sm",className:"me-1"}),"Guardando..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Ge,{className:"me-1"}),k]})})]})]})]})};export{aa as M};
//# sourceMappingURL=ModalForm-DaUBSj0Z.js.map
