import{r as h,j as e,S as A,G as r,a2 as U,R as X,B as S,C as Y,m as q,I as Q,J as Z,T as F,H as P}from"./index-ACE2z3o6.js";/* empty css                  */import{R as H}from"./Row-DR7Snyel.js";import{C as R}from"./Col-DolGQwSC.js";import{I as V}from"./InputGroup-DueyeE6m.js";import{F as ee}from"./Form-DLwAlTjb.js";import{T as se}from"./Table-BW8--UG8.js";const ae=({actions:v,item:o,onEdit:u,onDelete:C,onView:b})=>{const[p,j]=h.useState(!1),[I,E]=h.useState({top:0,left:0}),N=h.useRef(null),k=h.useRef(null),m=()=>{if(!p&&N.current){const i=N.current.getBoundingClientRect();E({top:i.bottom+window.scrollY+5,left:i.left+window.scrollX})}j(!p)},f=i=>{i.onClick&&i.onClick(o),j(!1)},d=i=>{k.current&&!k.current.contains(i.target)&&N.current&&!N.current.contains(i.target)&&j(!1)};h.useEffect(()=>{if(p)return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[p]);const c=p&&e.jsx("div",{ref:k,className:"portal-dropdown-menu",style:{position:"absolute",top:I.top,left:I.left,zIndex:9999,minWidth:"160px",backgroundColor:"white",border:"1px solid rgba(0, 0, 0, 0.15)",borderRadius:"8px",boxShadow:"0 8px 25px rgba(0, 0, 0, 0.25)",padding:"4px 0"},children:v.length>0?v.map((i,a)=>e.jsxs("button",{className:`portal-dropdown-item ${i.variant==="outline-danger"?"text-danger":""}`,onClick:()=>f(i),children:[i.icon&&e.jsx(i.icon,{className:"me-2"}),i.label]},a)):e.jsxs(e.Fragment,{children:[b&&e.jsxs("button",{className:"portal-dropdown-item",onClick:()=>{b(o),j(!1)},children:[e.jsx(q,{className:"me-2"}),"Ver"]}),u&&e.jsxs("button",{className:"portal-dropdown-item",onClick:()=>{u(o),j(!1)},children:[e.jsx(Q,{className:"me-2"}),"Editar"]}),C&&e.jsxs("button",{className:"portal-dropdown-item text-danger",onClick:()=>{C(o),j(!1)},children:[e.jsx(Z,{className:"me-2"}),"Eliminar"]})]})});return e.jsxs(e.Fragment,{children:[e.jsx("button",{ref:N,className:"portal-dropdown-toggle",onClick:m,style:{border:"none",background:"transparent",color:"#6c757d",padding:"0.25rem 0.5rem",borderRadius:"4px",cursor:"pointer"},children:e.jsx(P,{})}),p&&F.createPortal(c,document.body)]})},oe=({data:v=[],columns:o=[],searchable:u=!0,filterable:C=!0,actions:b=[],onEdit:p,onDelete:j,onView:I,loading:E=!1,emptyMessage:N="No hay datos disponibles",className:k="",totalItems:m=0,itemsPerPage:f=20,currentPage:d=1,onPageChange:c,onSearch:i,onFilter:a,filterOptions:L=null,getRowClassName:z=null,sortable:w=!0,useFlexbox:M=!1})=>{const[T,_]=h.useState(""),[g,J]=h.useState(""),[y,$]=h.useState("asc"),D=h.useMemo(()=>{let s=v;return m>0||(T&&u&&(s=s.filter(t=>o.some(l=>{const n=l.accessor?t[l.accessor]:"";return String(n).toLowerCase().includes(T.toLowerCase())}))),w&&g&&(s=[...s].sort((t,l)=>{const n=t[g],G=l[g];return n<G?y==="asc"?-1:1:n>G?y==="asc"?1:-1:0}))),s},[v,T,g,y,o,u,m]),x=m>0?Math.ceil(m/f):Math.ceil(D.length/f),B=m>0?v:D.slice((d-1)*f,d*f),W=s=>{w&&(g===s?$(y==="asc"?"desc":"asc"):(J(s),$("asc")))},K=s=>g!==s?null:y==="asc"?"↑":"↓",O=(s,t)=>{const l=t.accessor?s[t.accessor]:"";return t.render?t.render(l,s):t.type==="badge"?e.jsx(Y,{bg:t.badgeColor||"secondary",children:l}):t.type==="date"?new Date(l).toLocaleDateString("es-ES"):l};return E?e.jsxs("div",{className:"text-center py-5",children:[e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}),e.jsx("p",{className:"mt-2 text-muted",children:"Cargando datos..."})]}):e.jsxs("div",{className:`data-table ${M?"d-flex flex-column h-100":""} ${k}`,children:[(u||C)&&e.jsx("div",{className:"table-controls bg-light p-3 rounded-top border",children:e.jsxs(H,{className:"align-items-center",children:[u&&e.jsx(R,{md:6,children:e.jsxs(V,{children:[e.jsx(V.Text,{children:e.jsx(A,{})}),e.jsx(ee.Control,{type:"text",placeholder:"Buscar por nombre, email, rol...",value:T,onChange:s=>{_(s.target.value),i&&(clearTimeout(window.searchTimeout),window.searchTimeout=setTimeout(()=>{i(s.target.value)},500))}})]})}),C&&e.jsx(R,{md:6,className:"text-end",children:e.jsxs(r,{children:[e.jsxs(r.Toggle,{variant:"outline-secondary",size:"sm",children:[e.jsx(U,{className:"me-1"}),"Filtros"]}),e.jsxs(r.Menu,{className:"data-table-filter-dropdown",style:{zIndex:9999},children:[e.jsx(r.Item,{className:"data-table-filter-item",onClick:()=>{console.log("🔍 DataTable - Limpiando filtros"),a&&a({})},children:"Limpiar filtros"}),e.jsx(r.Divider,{}),L?L.map((s,t)=>e.jsxs(X.Fragment,{children:[e.jsx(r.Header,{className:"data-table-filter-header",children:s.title}),s.options.map((l,n)=>e.jsx(r.Item,{onClick:()=>{console.log("🔍 DataTable - Aplicando filtro:",l.filter),a&&a(l.filter)},className:"data-table-filter-item",children:l.label},n)),t<L.length-1&&e.jsx(r.Divider,{})]},t)):e.jsxs(e.Fragment,{children:[e.jsx(r.Header,{className:"data-table-filter-header",children:"Por Rol"}),e.jsx(r.Item,{className:"data-table-filter-item",onClick:()=>a&&a({role:"admin"}),children:"Administradores"}),e.jsx(r.Item,{className:"data-table-filter-item",onClick:()=>a&&a({role:"vendedor_comercial"}),children:"Vendedores Comerciales"}),e.jsx(r.Item,{className:"data-table-filter-item",onClick:()=>a&&a({role:"jefa_comercial"}),children:"Jefas Comerciales"}),e.jsx(r.Item,{className:"data-table-filter-item",onClick:()=>a&&a({role:"jefe_laboratorio"}),children:"Jefes de Laboratorio"}),e.jsx(r.Item,{className:"data-table-filter-item",onClick:()=>a&&a({role:"usuario_laboratorio"}),children:"Usuarios de Laboratorio"}),e.jsx(r.Item,{className:"data-table-filter-item",onClick:()=>a&&a({role:"soporte"}),children:"Soporte"}),e.jsx(r.Item,{className:"data-table-filter-item",onClick:()=>a&&a({role:"gerencia"}),children:"Gerencia"}),e.jsx(r.Divider,{}),e.jsx(r.Header,{className:"data-table-filter-header",children:"Por Área"}),e.jsx(r.Item,{className:"data-table-filter-item",onClick:()=>a&&a({area:"Comercial"}),children:"Comercial"}),e.jsx(r.Item,{className:"data-table-filter-item",onClick:()=>a&&a({area:"Laboratorio"}),children:"Laboratorio"}),e.jsx(r.Item,{className:"data-table-filter-item",onClick:()=>a&&a({area:"Sistemas"}),children:"Sistemas"}),e.jsx(r.Item,{className:"data-table-filter-item",onClick:()=>a&&a({area:"Gerencia"}),children:"Gerencia"}),e.jsx(r.Item,{className:"data-table-filter-item",onClick:()=>a&&a({area:"Soporte"}),children:"Soporte"})]})]})]})})]})}),e.jsx("div",{className:`table-responsive ${M?"flex-grow-1":""}`,children:e.jsxs(se,{hover:!0,className:"mb-0",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[o.map((s,t)=>e.jsx("th",{className:`${s.sortable&&w?"cursor-pointer":""} ${s.className||""}`,onClick:()=>s.sortable&&w&&W(s.accessor),style:{minWidth:s.width||"auto"},children:e.jsxs("div",{className:"d-flex align-items-center",children:[s.header,s.sortable&&w&&e.jsx("span",{className:"ms-1 text-muted",children:K(s.accessor)})]})},t)),b.length>0&&e.jsx("th",{width:"120",className:"text-center",children:"Acciones"})]})}),e.jsx("tbody",{children:B.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:o.length+(b.length>0?1:0),className:"text-center py-5",children:e.jsxs("div",{className:"text-muted",children:[e.jsx(A,{size:48,className:"mb-3 opacity-50"}),e.jsx("p",{className:"mb-0",children:N})]})})}):B.map((s,t)=>e.jsxs("tr",{className:z?z(s):"",children:[o.map((l,n)=>e.jsx("td",{className:l.className||"",children:O(s,l)},n)),b.length>0&&e.jsx("td",{className:"text-center",children:e.jsx(ae,{actions:b,item:s,onEdit:p,onDelete:j,onView:I})})]},s.id||t))})]})}),x>1&&e.jsx("div",{className:"table-footer bg-light p-3 rounded-bottom border border-top-0",children:e.jsxs(H,{className:"align-items-center",children:[e.jsx(R,{children:e.jsxs("small",{className:"text-muted",children:["Mostrando ",(d-1)*f+1," a ",Math.min(d*f,m||D.length)," de ",m||D.length," registros"]})}),e.jsx(R,{xs:"auto",children:e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx(S,{variant:"outline-secondary",size:"sm",disabled:d===1,onClick:()=>c&&c(1),title:"Primera página",children:"««"}),e.jsx(S,{variant:"outline-secondary",size:"sm",disabled:d===1,onClick:()=>c&&c(d-1),title:"Página anterior",children:"«"}),(()=>{const s=[],t=Math.max(1,d-1),l=Math.min(x,t+2);for(let n=t;n<=l;n++)s.push(e.jsx(S,{variant:d===n?"primary":"outline-secondary",size:"sm",onClick:()=>c&&c(n),className:"px-3",children:n},n));return s})(),e.jsx(S,{variant:"outline-secondary",size:"sm",disabled:d===x,onClick:()=>c&&c(d+1),title:"Página siguiente",children:"»"}),e.jsx(S,{variant:"outline-secondary",size:"sm",disabled:d===x,onClick:()=>c&&c(x),title:"Última página",children:"»»"}),e.jsxs("div",{className:"d-flex align-items-center gap-1 ms-3",children:[e.jsx("span",{className:"text-muted small",children:"Ir a:"}),e.jsx("input",{type:"number",min:"1",max:x,className:"form-control form-control-sm",style:{width:"60px"},placeholder:"...",onKeyPress:s=>{if(s.key==="Enter"){const t=parseInt(s.target.value);t>=1&&t<=x?(c&&c(t),s.target.value=""):(c&&c(x),s.target.value="")}},title:`Ingresa un número del 1 al ${x}`})]})]})})]})})]})};export{oe as D};
//# sourceMappingURL=DataTable-Bq1A8Kk-.js.map
