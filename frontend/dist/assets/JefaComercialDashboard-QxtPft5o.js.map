{"version":3,"file":"JefaComercialDashboard-QxtPft5o.js","sources":["../../src/pages/dashboards/JefaComercialDashboard.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Container, Row, Col, Card, Alert, Spinner } from 'react-bootstrap';\r\nimport { FiTrendingUp, FiUsers, FiDollarSign, FiTarget, FiBarChart, FiActivity } from 'react-icons/fi';\r\nimport PageHeader from '../../components/common/PageHeader';\r\nimport StatsCard from '../../components/common/StatsCard';\r\nimport apiFetch from '../../services/api';\r\n\r\nexport default function JefaComercialDashboard() {\r\n  const [stats, setStats] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n\r\n  useEffect(() => {\r\n    fetchDashboardData();\r\n  }, []);\r\n\r\n  const fetchDashboardData = async () => {\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n      const data = await apiFetch('/api/role-dashboard/jefa-comercial');\r\n      setStats(data);\r\n    } catch (err) {\r\n      console.error('Error fetching dashboard data:', err);\r\n      setError('Error al cargar los datos del dashboard');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <Container fluid className=\"p-4\">\r\n        <div className=\"d-flex justify-content-center align-items-center\" style={{ height: '400px' }}>\r\n          <Spinner animation=\"border\" size=\"lg\" />\r\n        </div>\r\n      </Container>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <Container fluid className=\"p-4\">\r\n        <Alert variant=\"danger\">{error}</Alert>\r\n      </Container>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Container fluid className=\"p-4\">\r\n      <PageHeader\r\n        title=\"Dashboard Jefa Comercial\"\r\n        subtitle=\"Métricas de embudo, vendedores y conversiones\"\r\n        icon={FiBarChart}\r\n      />\r\n\r\n      {/* Métricas principales */}\r\n      <Row className=\"mb-4\">\r\n        <Col lg={3} md={6} className=\"mb-3\">\r\n          <StatsCard\r\n            title=\"Total Vendedores\"\r\n            value={stats?.totalVendedores || 0}\r\n            icon={FiUsers}\r\n            color=\"primary\"\r\n            subtitle=\"Vendedores activos\"\r\n          />\r\n        </Col>\r\n        <Col lg={3} md={6} className=\"mb-3\">\r\n          <StatsCard\r\n            title=\"Cotizaciones Totales\"\r\n            value={stats?.totalCotizaciones || 0}\r\n            icon={FiTarget}\r\n            color=\"info\"\r\n            subtitle={`${stats?.cotizacionesAprobadas || 0} aprobadas`}\r\n          />\r\n        </Col>\r\n        <Col lg={3} md={6} className=\"mb-3\">\r\n          <StatsCard\r\n            title=\"Ingresos Generados\"\r\n            value={`$${(stats?.totalIngresos || 0).toLocaleString()}`}\r\n            icon={FiDollarSign}\r\n            color=\"success\"\r\n            subtitle={`${stats?.cotizacionesFacturadas || 0} facturadas`}\r\n          />\r\n        </Col>\r\n        <Col lg={3} md={6} className=\"mb-3\">\r\n          <StatsCard\r\n            title=\"Tasa de Conversión\"\r\n            value={`${stats?.conversionRate || 0}%`}\r\n            icon={FiTrendingUp}\r\n            color=\"warning\"\r\n            subtitle=\"Cotizaciones aprobadas\"\r\n          />\r\n        </Col>\r\n      </Row>\r\n\r\n      {/* Métricas mensuales */}\r\n      <Row className=\"mb-4\">\r\n        <Col lg={6} md={6} className=\"mb-3\">\r\n          <StatsCard\r\n            title=\"Cotizaciones Este Mes\"\r\n            value={stats?.cotizacionesEsteMes || 0}\r\n            icon={FiActivity}\r\n            color=\"primary\"\r\n            subtitle=\"Nuevas cotizaciones\"\r\n          />\r\n        </Col>\r\n        <Col lg={6} md={6} className=\"mb-3\">\r\n          <StatsCard\r\n            title=\"Ingresos Este Mes\"\r\n            value={`$${(stats?.ingresosEsteMes || 0).toLocaleString()}`}\r\n            icon={FiDollarSign}\r\n            color=\"success\"\r\n            subtitle=\"Ingresos del mes actual\"\r\n          />\r\n        </Col>\r\n      </Row>\r\n\r\n      {/* Embudo por categoría */}\r\n      <Row className=\"mb-4\">\r\n        <Col lg={6}>\r\n          <Card className=\"shadow-sm\">\r\n            <Card.Header>\r\n              <h5 className=\"mb-0\">Embudo por Categoría</h5>\r\n            </Card.Header>\r\n            <Card.Body>\r\n              {stats?.embudoPorCategoria?.length > 0 ? (\r\n                <div className=\"table-responsive\">\r\n                  <table className=\"table table-sm\">\r\n                    <thead>\r\n                      <tr>\r\n                        <th>Categoría</th>\r\n                        <th>Total</th>\r\n                        <th>Aprobadas</th>\r\n                        <th>Conversión</th>\r\n                        <th>Ingresos</th>\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                      {stats.embudoPorCategoria.map((item, index) => (\r\n                        <tr key={index}>\r\n                          <td>{item.categoria}</td>\r\n                          <td>{item.total}</td>\r\n                          <td>{item.aprobadas}</td>\r\n                          <td>\r\n                            <span className={`badge ${item.conversionRate > 20 ? 'bg-success' : item.conversionRate > 10 ? 'bg-warning' : 'bg-danger'}`}>\r\n                              {item.conversionRate}%\r\n                            </span>\r\n                          </td>\r\n                          <td>${item.ingresos.toLocaleString()}</td>\r\n                        </tr>\r\n                      ))}\r\n                    </tbody>\r\n                  </table>\r\n                </div>\r\n              ) : (\r\n                <p className=\"text-muted\">No hay datos de embudo disponibles</p>\r\n              )}\r\n            </Card.Body>\r\n          </Card>\r\n        </Col>\r\n\r\n        {/* Rendimiento de vendedores */}\r\n        <Col lg={6}>\r\n          <Card className=\"shadow-sm\">\r\n            <Card.Header>\r\n              <h5 className=\"mb-0\">Rendimiento de Vendedores</h5>\r\n            </Card.Header>\r\n            <Card.Body>\r\n              {stats?.rendimientoVendedores?.length > 0 ? (\r\n                <div className=\"table-responsive\">\r\n                  <table className=\"table table-sm\">\r\n                    <thead>\r\n                      <tr>\r\n                        <th>Vendedor</th>\r\n                        <th>Cotizaciones</th>\r\n                        <th>Aprobadas</th>\r\n                        <th>Conversión</th>\r\n                        <th>Ingresos</th>\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                      {stats.rendimientoVendedores.map((vendedor, index) => (\r\n                        <tr key={index}>\r\n                          <td>{vendedor.nombre}</td>\r\n                          <td>{vendedor.totalCotizaciones}</td>\r\n                          <td>{vendedor.cotizacionesAprobadas}</td>\r\n                          <td>\r\n                            <span className={`badge ${vendedor.conversionRate > 20 ? 'bg-success' : vendedor.conversionRate > 10 ? 'bg-warning' : 'bg-danger'}`}>\r\n                              {vendedor.conversionRate}%\r\n                            </span>\r\n                          </td>\r\n                          <td>${vendedor.ingresosGenerados.toLocaleString()}</td>\r\n                        </tr>\r\n                      ))}\r\n                    </tbody>\r\n                  </table>\r\n                </div>\r\n              ) : (\r\n                <p className=\"text-muted\">No hay datos de vendedores disponibles</p>\r\n              )}\r\n            </Card.Body>\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n\r\n      {/* Cotizaciones recientes */}\r\n      <Row>\r\n        <Col>\r\n          <Card className=\"shadow-sm\">\r\n            <Card.Header>\r\n              <h5 className=\"mb-0\">Cotizaciones Recientes</h5>\r\n            </Card.Header>\r\n            <Card.Body>\r\n              {stats?.cotizacionesRecientes?.length > 0 ? (\r\n                <div className=\"table-responsive\">\r\n                  <table className=\"table table-sm\">\r\n                    <thead>\r\n                      <tr>\r\n                        <th>Código</th>\r\n                        <th>Cliente</th>\r\n                        <th>Empresa</th>\r\n                        <th>Monto</th>\r\n                        <th>Estado</th>\r\n                        <th>Fecha</th>\r\n                        <th>Vendedor</th>\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                      {stats.cotizacionesRecientes.map((cotizacion, index) => (\r\n                        <tr key={index}>\r\n                          <td>{cotizacion.quote_number}</td>\r\n                          <td>{cotizacion.client_contact}</td>\r\n                          <td>{cotizacion.company_name || 'N/A'}</td>\r\n                          <td>${cotizacion.total_amount?.toLocaleString() || 0}</td>\r\n                          <td>\r\n                            <span className={`badge ${\r\n                              cotizacion.status === 'aprobada' ? 'bg-success' :\r\n                              cotizacion.status === 'facturada' ? 'bg-primary' :\r\n                              cotizacion.status === 'pendiente' ? 'bg-warning' : 'bg-secondary'\r\n                            }`}>\r\n                              {cotizacion.status}\r\n                            </span>\r\n                          </td>\r\n                          <td>{new Date(cotizacion.created_at).toLocaleDateString()}</td>\r\n                          <td>{cotizacion.created_by_name}</td>\r\n                        </tr>\r\n                      ))}\r\n                    </tbody>\r\n                  </table>\r\n                </div>\r\n              ) : (\r\n                <p className=\"text-muted\">No hay cotizaciones recientes</p>\r\n              )}\r\n            </Card.Body>\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n    </Container>\r\n  );\r\n}\r\n"],"names":["JefaComercialDashboard","stats","setStats","useState","loading","setLoading","error","setError","useEffect","fetchDashboardData","data","apiFetch","err","jsx","Container","Spinner","Alert","jsxs","PageHeader","FiBarChart","Row","Col","StatsCard","FiUsers","FiTarget","FiDollarSign","FiTrendingUp","FiActivity","Card","item","index","vendedor","cotizacion","_a"],"mappings":"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"}