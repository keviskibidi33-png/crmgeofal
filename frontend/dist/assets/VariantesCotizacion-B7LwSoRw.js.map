{"version":3,"file":"VariantesCotizacion-B7LwSoRw.js","sources":["../../src/pages/VariantesCotizacion.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport ModuloBase from '../components/ModuloBase';\r\nimport { listVariants, createVariant, updateVariant, deleteVariant } from '../services/quoteVariants';\r\n\r\nconst emptyForm = { code: '', title: '', description: '', conditions: '' };\r\n\r\nconst VariantesCotizacion = () => {\r\n  const [variants, setVariants] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState('');\r\n  const [showForm, setShowForm] = useState(false);\r\n  const [editing, setEditing] = useState(null);\r\n  const [form, setForm] = useState(emptyForm);\r\n\r\n  const load = async () => {\r\n    setLoading(true);\r\n    setError('');\r\n    try {\r\n      const data = await listVariants();\r\n      setVariants(data || []);\r\n    } catch (e) {\r\n      setError(e.message || 'Error al cargar variantes');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => { load(); }, []);\r\n\r\n  const onSubmit = async (e) => {\r\n    e.preventDefault();\r\n    try {\r\n      if (editing) {\r\n        await updateVariant(editing.id, form);\r\n      } else {\r\n        await createVariant(form);\r\n      }\r\n      setShowForm(false);\r\n      setEditing(null);\r\n      setForm(emptyForm);\r\n      await load();\r\n    } catch (e) {\r\n      alert(e.message || 'Error al guardar');\r\n    }\r\n  };\r\n\r\n  const onEdit = (v) => {\r\n    setEditing(v);\r\n    setForm({ code: v.code || '', title: v.title || '', description: v.description || '', conditions: v.conditions || '' });\r\n    setShowForm(true);\r\n  };\r\n\r\n  const onDelete = async (v) => {\r\n    if (!confirm(`Eliminar variante ${v.title}?`)) return;\r\n    try {\r\n      await deleteVariant(v.id);\r\n      await load();\r\n    } catch (e) {\r\n      alert(e.message || 'Error al eliminar');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <ModuloBase titulo=\"Variantes de Cotización\" descripcion=\"Administra plantillas base para cotizaciones (código, condiciones, etc.)\">\r\n      <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: 12 }}>\r\n        <div>\r\n          {loading && <span>Cargando...</span>}\r\n          {error && <span style={{ color: 'red' }}>{error}</span>}\r\n        </div>\r\n        <button className=\"btn btn-primary\" onClick={() => { setShowForm(true); setEditing(null); setForm(emptyForm); }}>Nueva variante</button>\r\n      </div>\r\n\r\n      <div className=\"table-responsive\">\r\n        <table className=\"table table-striped\">\r\n          <thead>\r\n            <tr>\r\n              <th>ID</th>\r\n              <th>Código</th>\r\n              <th>Título</th>\r\n              <th>Descripción</th>\r\n              <th>Condiciones</th>\r\n              <th>Activo</th>\r\n              <th>Acciones</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {(variants || []).map((v) => (\r\n              <tr key={v.id}>\r\n                <td>{v.id}</td>\r\n                <td>{v.code}</td>\r\n                <td>{v.title}</td>\r\n                <td>{v.description}</td>\r\n                <td style={{ maxWidth: 320, whiteSpace: 'pre-wrap' }}>{v.conditions}</td>\r\n                <td>{String(v.active ?? true)}</td>\r\n                <td>\r\n                  <button className=\"btn btn-sm btn-secondary\" onClick={() => onEdit(v)}>Editar</button>{' '}\r\n                  <button className=\"btn btn-sm btn-danger\" onClick={() => onDelete(v)}>Eliminar</button>\r\n                </td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n      {showForm && (\r\n        <div style={{ border: '1px solid #eee', borderRadius: 8, padding: 16, marginTop: 16 }}>\r\n          <h5>{editing ? 'Editar variante' : 'Nueva variante'}</h5>\r\n          <form onSubmit={onSubmit}>\r\n            <div className=\"mb-2\">\r\n              <label className=\"form-label\">Código</label>\r\n              <input className=\"form-control\" value={form.code} onChange={(e) => setForm({ ...form, code: e.target.value })} required />\r\n            </div>\r\n            <div className=\"mb-2\">\r\n              <label className=\"form-label\">Título</label>\r\n              <input className=\"form-control\" value={form.title} onChange={(e) => setForm({ ...form, title: e.target.value })} required />\r\n            </div>\r\n            <div className=\"mb-2\">\r\n              <label className=\"form-label\">Descripción</label>\r\n              <textarea className=\"form-control\" rows={2} value={form.description} onChange={(e) => setForm({ ...form, description: e.target.value })} />\r\n            </div>\r\n            <div className=\"mb-3\">\r\n              <label className=\"form-label\">Condiciones (texto libre)</label>\r\n              <textarea className=\"form-control\" rows={4} value={form.conditions} onChange={(e) => setForm({ ...form, conditions: e.target.value })} />\r\n            </div>\r\n            <div>\r\n              <button type=\"submit\" className=\"btn btn-success\">Guardar</button>{' '}\r\n              <button type=\"button\" className=\"btn btn-outline-secondary\" onClick={() => { setShowForm(false); setEditing(null); }}>Cancelar</button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      )}\r\n    </ModuloBase>\r\n  );\r\n};\r\n\r\nexport default VariantesCotizacion;\r\n"],"names":["emptyForm","VariantesCotizacion","variants","setVariants","useState","loading","setLoading","error","setError","showForm","setShowForm","editing","setEditing","form","setForm","load","data","listVariants","e","useEffect","onSubmit","updateVariant","createVariant","onEdit","v","onDelete","deleteVariant","jsxs","ModuloBase","jsx"],"mappings":"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"}