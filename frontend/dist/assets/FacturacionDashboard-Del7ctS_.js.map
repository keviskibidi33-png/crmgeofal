{"version":3,"file":"FacturacionDashboard-Del7ctS_.js","sources":["../../src/pages/dashboards/FacturacionDashboard.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Container, Row, Col, Card, Alert, Spinner } from 'react-bootstrap';\r\nimport { FiDollarSign, FiCheckCircle, FiXCircle, FiClock, FiTrendingUp, FiFileText } from 'react-icons/fi';\r\nimport PageHeader from '../../components/common/PageHeader';\r\nimport StatsCard from '../../components/common/StatsCard';\r\nimport apiFetch from '../../services/api';\r\n\r\nexport default function FacturacionDashboard() {\r\n  const [stats, setStats] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n\r\n  useEffect(() => {\r\n    fetchDashboardData();\r\n  }, []);\r\n\r\n  const fetchDashboardData = async () => {\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n      const data = await apiFetch('/api/role-dashboard/facturacion');\r\n      setStats(data);\r\n    } catch (err) {\r\n      console.error('Error fetching dashboard data:', err);\r\n      setError('Error al cargar los datos del dashboard');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <Container fluid className=\"p-4\">\r\n        <div className=\"d-flex justify-content-center align-items-center\" style={{ height: '400px' }}>\r\n          <Spinner animation=\"border\" size=\"lg\" />\r\n        </div>\r\n      </Container>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <Container fluid className=\"p-4\">\r\n        <Alert variant=\"danger\">{error}</Alert>\r\n      </Container>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Container fluid className=\"p-4\">\r\n      <PageHeader\r\n        title=\"Dashboard Facturación\"\r\n        subtitle=\"Comprobantes de pago y gestión financiera\"\r\n        icon={FiDollarSign}\r\n      />\r\n\r\n      {/* Métricas principales */}\r\n      <Row className=\"mb-4\">\r\n        <Col lg={3} md={6} className=\"mb-3\">\r\n          <StatsCard\r\n            title=\"Comprobantes Pendientes\"\r\n            value={stats?.comprobantesPendientes || 0}\r\n            icon={FiClock}\r\n            color=\"warning\"\r\n            subtitle={`$${(stats?.montoTotalPendiente || 0).toLocaleString()}`}\r\n          />\r\n        </Col>\r\n        <Col lg={3} md={6} className=\"mb-3\">\r\n          <StatsCard\r\n            title=\"Comprobantes Aprobados\"\r\n            value={stats?.comprobantesAprobados || 0}\r\n            icon={FiCheckCircle}\r\n            color=\"success\"\r\n            subtitle={`$${(stats?.montoTotalAprobado || 0).toLocaleString()}`}\r\n          />\r\n        </Col>\r\n        <Col lg={3} md={6} className=\"mb-3\">\r\n          <StatsCard\r\n            title=\"Comprobantes Rechazados\"\r\n            value={stats?.comprobantesRechazados || 0}\r\n            icon={FiXCircle}\r\n            color=\"danger\"\r\n            subtitle={`$${(stats?.montoTotalRechazado || 0).toLocaleString()}`}\r\n          />\r\n        </Col>\r\n        <Col lg={3} md={6} className=\"mb-3\">\r\n          <StatsCard\r\n            title=\"Total Comprobantes\"\r\n            value={stats?.totalComprobantes || 0}\r\n            icon={FiFileText}\r\n            color=\"info\"\r\n            subtitle=\"Todos los estados\"\r\n          />\r\n        </Col>\r\n      </Row>\r\n\r\n      {/* Métricas mensuales */}\r\n      <Row className=\"mb-4\">\r\n        <Col lg={6} md={6} className=\"mb-3\">\r\n          <StatsCard\r\n            title=\"Comprobantes Este Mes\"\r\n            value={stats?.comprobantesEsteMes || 0}\r\n            icon={FiTrendingUp}\r\n            color=\"primary\"\r\n            subtitle=\"Nuevos comprobantes\"\r\n          />\r\n        </Col>\r\n        <Col lg={6} md={6} className=\"mb-3\">\r\n          <StatsCard\r\n            title=\"Monto Este Mes\"\r\n            value={`$${(stats?.montoEsteMes || 0).toLocaleString()}`}\r\n            icon={FiDollarSign}\r\n            color=\"success\"\r\n            subtitle=\"Ingresos del mes\"\r\n          />\r\n        </Col>\r\n      </Row>\r\n\r\n      {/* Comprobantes recientes */}\r\n      <Row className=\"mb-4\">\r\n        <Col lg={6}>\r\n          <Card className=\"shadow-sm\">\r\n            <Card.Header>\r\n              <h5 className=\"mb-0\">Comprobantes Recientes</h5>\r\n            </Card.Header>\r\n            <Card.Body>\r\n              {stats?.comprobantesRecientes?.length > 0 ? (\r\n                <div className=\"table-responsive\">\r\n                  <table className=\"table table-sm\">\r\n                    <thead>\r\n                      <tr>\r\n                        <th>Monto</th>\r\n                        <th>Empresa</th>\r\n                        <th>Estado</th>\r\n                        <th>Fecha</th>\r\n                        <th>Subido por</th>\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                      {stats.comprobantesRecientes.map((comprobante, index) => (\r\n                        <tr key={index}>\r\n                          <td>${comprobante.amount?.toLocaleString() || 0}</td>\r\n                          <td>{comprobante.company_name}</td>\r\n                          <td>\r\n                            <span className={`badge ${\r\n                              comprobante.status === 'aprobado' ? 'bg-success' :\r\n                              comprobante.status === 'rechazado' ? 'bg-danger' :\r\n                              comprobante.status === 'pendiente' ? 'bg-warning' : 'bg-secondary'\r\n                            }`}>\r\n                              {comprobante.status}\r\n                            </span>\r\n                          </td>\r\n                          <td>{new Date(comprobante.created_at).toLocaleDateString()}</td>\r\n                          <td>{comprobante.uploaded_by_name}</td>\r\n                        </tr>\r\n                      ))}\r\n                    </tbody>\r\n                  </table>\r\n                </div>\r\n              ) : (\r\n                <p className=\"text-muted\">No hay comprobantes recientes</p>\r\n              )}\r\n            </Card.Body>\r\n          </Card>\r\n        </Col>\r\n\r\n        {/* Pagos recientes */}\r\n        <Col lg={6}>\r\n          <Card className=\"shadow-sm\">\r\n            <Card.Header>\r\n              <h5 className=\"mb-0\">Pagos Aprobados Recientes</h5>\r\n            </Card.Header>\r\n            <Card.Body>\r\n              {stats?.pagosRecientes?.length > 0 ? (\r\n                <div className=\"table-responsive\">\r\n                  <table className=\"table table-sm\">\r\n                    <thead>\r\n                      <tr>\r\n                        <th>Monto</th>\r\n                        <th>Empresa</th>\r\n                        <th>Fecha Aprobación</th>\r\n                        <th>Aprobado por</th>\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                      {stats.pagosRecientes.map((pago, index) => (\r\n                        <tr key={index}>\r\n                          <td>${pago.amount?.toLocaleString() || 0}</td>\r\n                          <td>{pago.company_name}</td>\r\n                          <td>{new Date(pago.approved_at).toLocaleDateString()}</td>\r\n                          <td>{pago.approved_by_name}</td>\r\n                        </tr>\r\n                      ))}\r\n                    </tbody>\r\n                  </table>\r\n                </div>\r\n              ) : (\r\n                <p className=\"text-muted\">No hay pagos recientes</p>\r\n              )}\r\n            </Card.Body>\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n\r\n      {/* Resumen de estados */}\r\n      <Row>\r\n        <Col>\r\n          <Card className=\"shadow-sm\">\r\n            <Card.Header>\r\n              <h5 className=\"mb-0\">Resumen de Estados de Comprobantes</h5>\r\n            </Card.Header>\r\n            <Card.Body>\r\n              <Row>\r\n                <Col md={4}>\r\n                  <div className=\"text-center p-3\">\r\n                    <div className=\"display-6 text-warning\">{stats?.comprobantesPendientes || 0}</div>\r\n                    <div className=\"text-muted\">Pendientes</div>\r\n                    <small className=\"text-muted\">${(stats?.montoTotalPendiente || 0).toLocaleString()}</small>\r\n                  </div>\r\n                </Col>\r\n                <Col md={4}>\r\n                  <div className=\"text-center p-3\">\r\n                    <div className=\"display-6 text-success\">{stats?.comprobantesAprobados || 0}</div>\r\n                    <div className=\"text-muted\">Aprobados</div>\r\n                    <small className=\"text-muted\">${(stats?.montoTotalAprobado || 0).toLocaleString()}</small>\r\n                  </div>\r\n                </Col>\r\n                <Col md={4}>\r\n                  <div className=\"text-center p-3\">\r\n                    <div className=\"display-6 text-danger\">{stats?.comprobantesRechazados || 0}</div>\r\n                    <div className=\"text-muted\">Rechazados</div>\r\n                    <small className=\"text-muted\">${(stats?.montoTotalRechazado || 0).toLocaleString()}</small>\r\n                  </div>\r\n                </Col>\r\n              </Row>\r\n            </Card.Body>\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n    </Container>\r\n  );\r\n}\r\n"],"names":["FacturacionDashboard","stats","setStats","useState","loading","setLoading","error","setError","useEffect","fetchDashboardData","data","apiFetch","err","jsx","Container","Spinner","Alert","jsxs","PageHeader","FiDollarSign","Row","Col","StatsCard","FiClock","FiCheckCircle","FiXCircle","FiFileText","FiTrendingUp","Card","comprobante","index","_a","pago"],"mappings":"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"}