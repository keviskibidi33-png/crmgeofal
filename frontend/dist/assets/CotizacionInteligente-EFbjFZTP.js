import{r as c,j as e}from"./index-xQVByYRi.js";import{M as he}from"./ModuloBase-uxYeg0t6.js";import{c as ge}from"./quotes-B0lnb_TG.js";import{l as Ne,c as be}from"./projects-B4CBwGKg.js";import{l as je,b as xe}from"./companies-P0mPl86d.js";import{S as fe}from"./SubserviceAutocomplete-BNw3rrJ6.js";/* empty css                     */import"./subservices-BpjbwGE9.js";import"./Form-BAZkilfb.js";import"./ElementChildren-BP-7Da5j.js";import"./Col-Dz9zKzWQ.js";import"./Spinner-C2jXaFYJ.js";const W={company_name:"",ruc:"",contact_name:"",contact_phone:"",contact_email:"",project_location:"",project_name:""},Ce={request_date:"",issue_date:"",commercial_name:"",commercial_phone:"",payment_terms:"adelantado",reference:"",reference_type:["email","phone"],igv:!0,delivery_days:4,category_main:"laboratorio"},ee={code:"",description:"",norm:"",unit_price:0,quantity:1};function ae(i){const p=Number(i.unit_price||0),d=Number(i.quantity||0);return Number((p*d).toFixed(2))}function ye(){const i=new Date().getFullYear(),p=String(new Date().getMonth()+1).padStart(2,"0"),d=String(new Date().getDate()).padStart(2,"0"),E=Math.floor(Math.random()*1e3).toString().padStart(3,"0");return`COT-${i}${p}${d}-${E}`}const x=(i="")=>(i||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toUpperCase().trim(),M={[x("MUESTRA DE SUELO Y AGREGADO")]:`CONDICIONES ESPECÃFICAS:
- El cliente debe enviar al laboratorio, para los ensayo en suelo y agregados, la cantidad minima de 100 kg por cada muestra.
- El cliente deberÃ¡ de entregar las muestras debidamente identificadas.
- El cliente deberÃ¡ especificar la Norma a ser utilizada para la ejecuciÃ³n del ensayo, caso contrario se considera Norma ASTM o NTP vigente de acuerdo con el alcance del laboratorio.
- El cliente deberÃ¡ entregar las muestras en las instalaciones del LEM, ubicado en la Av. MaraÃ±Ã³n NÂ° 763, Los Olivos, Lima.`,[x("PROBETAS")]:`CONDICIONES ESPECÃFICAS:
- El cliente debe proporcionar las probetas antes del ingreso a obra.
- El cliente deberÃ¡ de entregar las muestras debidamente identificadas.
- El cliente deberÃ¡ especificar la Norma a ser utilizada para la ejecuciÃ³n del ensayo, caso contrario se considera Norma ASTM o NTP vigente de acuerdo con el alcance del laboratorio.
- El cliente deberÃ¡ entregar las muestras en las instalaciones del LEM, ubicado en la Av. MaraÃ±Ã³n NÂ° 763, Los Olivos, Lima.`,[x("DENSIDAD DE CAMPO Y MUESTREO")]:`CONDICIONES ESPECÃFICAS:
- El cliente deberÃ¡ enviar al laboratorio, para los ensayo en suelo y agregados, la cantidad minima de 100 kg por cada muestra.
- Para el ensayo de Densidad de campo, la cantidad de puntos/salida minimo 4 und.
- El cliente deberÃ¡ de programar el servicio, Densidad de campo, con 24 horas de anticipaciÃ³n.
- El cliente deberÃ¡ especificar la Norma a ser utilizada para la ejecuciÃ³n del ensayo, caso contrario se considera Norma ASTM o NTP vigente de acuerdo con el alcance del laboratorio.
- El cliente deberÃ¡ entregar las muestras en las instalaciones del LEM, ubicado en la Av. MaraÃ±Ã³n NÂ° 763, Los Olivos, Lima.`,[x("EXTRACCIÃ“N DE DIAMANTINA")]:`CONDICIONES ESPECÃFICAS:
- MovilizaciÃ³n y desmovilizaciÃ³n de equipos y del personal tÃ©cnico, estara a cargo de GEOFAL.
- Resane de estructura de concreto con sika rep 500 y Sikadur 32, estara a cargo de GEOFAL.
- El servicio no incluye trabajos de acabados como pintura, mayolica y otros.
- El area de trabajo, zona de extracciÃ³n de diamantina, tiene que estar libre de interferencia.
- La extracciÃ³n de diamantina se realizara en 2 dia en campo, en laboratorio se realizarÃ¡ el tallado y refrentado de diamantina, el ensayo de resistencia a la compresiÃ³n de testigo de diamantina se realizara en 5 dias (el tiempo de ensayo obedece a la normativa vigente).
- Costo de resane insumos 250 soles, este costo se distribuira de acuerdo con el numero de perforaciones Donde se hara las extracciones de diamantina`,[x("DIAMANTINA PARA PASES")]:`CONDICIONES ESPECÃFICAS:
- El cliente deberÃ¡ de programar el servicio, ExtracciÃ³n diamantina, con 24 horas de anticipaciÃ³n.
- El area de trabajo, zona de extraccion de diamantina, debera estar libre de interferencia.
- Para extraer la diamantina, se ubicara el acero con un escaneador.
- Movilizacion y desmovilizacion de equipos y del personal tecnico, estara a cargo de Geofal.`,[x("ALBAÃ‘ILERÃA")]:`CONDICIONES ESPECÃFICAS:
- El cliente deberÃ¡ enviar al laboratorio, 20 ladrillo de cada tipo, en buen estado y sin presentar fisuras.
- El cliente deberÃ¡ de entregar las muestras debidamente identificadas.
- El cliente deberÃ¡ especificar la Norma a ser utilizada para la ejecuciÃ³n del ensayo, caso contrario se considera Norma ASTM o NTP vigente de acuerdo con el alcance del laboratorio.
- El cliente deberÃ¡ entregar las muestras en las instalaciones del LEM, ubicado en la Av. MaraÃ±Ã³n NÂ° 763, Los Olivos, Lima`,[x("VIGA BECKELMAN")]:`CONDICIONES ESPECÃFICAS:
- El cliente deberÃ¡ de programar el servicio, Ensayo de DeflexiÃ³n, con 24 horas de anticipaciÃ³n.
- El area de trabajo tiene que estar habilitado.
- El cliente deberÃ¡ especificar la Norma a ser utilizada para la ejecuciÃ³n del ensayo, caso contrario se considera Norma ASTM o NTP o MTC vigente de acuerdo con el alcance del laboratorio.
- Especificar las caracteristicas del camion`,[x("CONTROL DE CALIDAD DE CONCRETO FRESCO EN OBRA")]:`CONDICIONES ESPECÃFICAS:
- El cliente deberÃ¡ de programar el servicio, con 24 horas de anticipaciÃ³n.
- Para el ensayo de control de calidad de concreto fresco en obra, se moldeara 6 probetas, ensayo slump, control de temperatura, en laboratorio las probetas se colocara en camara de curado, el ensayo de compresiÃ³n de las probetas seran 3 a 7 dias y 3 a 28 dias.
- El control de calidad del concreto fresco se sacara cada 50m3 a uno de los mixer donde se hara todos los ensayos respectivos mencionados, o por dia asi no se halla llegado los 50m3.
- El cliente deberÃ¡ especificar la Norma a ser utilizada para la ejecuciÃ³n del ensayo, caso contrario se considera Norma ASTM o NTP vigente de acuerdo con el alcance del laboratorio.`},j=i=>{const p=x((i==null?void 0:i.title)||"");if(M[p])return M[p];const d=Object.entries(M).find(([E])=>p.includes(E)||E.includes(p));return d?d[1]:""};function Ve(){const[i,p]=c.useState([]),[d,E]=c.useState(""),[o,h]=c.useState(W),[m,ve]=c.useState({company_id:null,project_id:null,company:null,project:null}),[s,u]=c.useState(Ce),[N,L]=c.useState([{...ee}]),[P,F]=c.useState(!1),[k,T]=c.useState(""),[z,q]=c.useState(""),[V,te]=c.useState(null),[Ee,U]=c.useState([]),[Se,$]=c.useState([]),[_e,Ae]=c.useState(!1),[oe,Ie]=c.useState(""),[ne,G]=c.useState([]),[S,B]=c.useState([]),[O,R]=c.useState(""),[v,Y]=c.useState(null),[K,I]=c.useState(!1);c.useEffect(()=>{const a=[{id:"V1",code:"V1",title:"MUESTRA DE SUELO Y AGREGADO",description:j({title:"MUESTRA DE SUELO Y AGREGADO"})},{id:"V2",code:"V2",title:"PROBETAS",description:j({title:"PROBETAS"})},{id:"V3",code:"V3",title:"DENSIDAD DE CAMPO Y MUESTREO",description:j({title:"DENSIDAD DE CAMPO Y MUESTREO"})},{id:"V4",code:"V4",title:"EXTRACCIÃ“N DE DIAMANTINA",description:j({title:"EXTRACCIÃ“N DE DIAMANTINA"})},{id:"V5",code:"V5",title:"DIAMANTINA PARA PASES",description:j({title:"DIAMANTINA PARA PASES"})},{id:"V6",code:"V6",title:"ALBAÃ‘ILERÃA",description:j({title:"ALBAÃ‘ILERÃA"})},{id:"V7",code:"V7",title:"VIGA BECKELMAN",description:j({title:"VIGA BECKELMAN"})},{id:"V8",code:"V8",title:"CONTROL DE CALIDAD DE CONCRETO FRESCO EN OBRA",description:j({title:"CONTROL DE CALIDAD DE CONCRETO FRESCO EN OBRA"})}];p(a)},[]),c.useEffect(()=>{(async()=>{try{const t=(await Ne({page:1,limit:100})).data||[];U(t),$(t)}catch(a){console.warn("No se pudieron cargar proyectos existentes:",a),U([]),$([])}})()},[]),c.useEffect(()=>{m.company&&h(a=>{var t,n;return{...a,company_name:m.company.name||a.company_name,ruc:m.company.ruc||a.ruc,contact_name:m.company.contact_name||a.contact_name,contact_phone:m.company.phone||a.contact_phone,contact_email:m.company.email||a.contact_email,project_location:((t=m.project)==null?void 0:t.location)||a.project_location,project_name:((n=m.project)==null?void 0:n.name)||a.project_name}})},[m.company,m.project]),c.useEffect(()=>{const a=localStorage.getItem("token");if(a)try{const t=JSON.parse(atob(a.split(".")[1]));t.name&&u(n=>({...n,commercial_name:t.name,commercial_phone:t.phone||""}))}catch(t){console.warn("No se pudo decodificar el token:",t)}},[]),c.useEffect(()=>{if(!d)return;const a=(i||[]).find(r=>String(r.id)===String(d));if(!a)return;const t=a.conditions||{};u(r=>({...r,payment_terms:t.default_payment_terms||r.payment_terms,igv:typeof t.default_igv=="boolean"?t.default_igv:r.igv,reference:t.default_reference||r.reference}));const n=j(a)||a.description||"";n&&q(n)},[d]);const _=c.useMemo(()=>N.reduce((a,t)=>a+ae(t),0),[N]),D=c.useMemo(()=>s.igv?Number((_*.18).toFixed(2)):0,[_,s.igv]),Q=c.useMemo(()=>Number((_+D).toFixed(2)),[_,D]),se=()=>L([...N,{...ee}]),ce=a=>L(N.filter((t,n)=>n!==a)),A=(a,t)=>L(N.map((n,r)=>r===a?{...n,...t}:n)),re=async()=>{try{console.log("ğŸ” fetchClients - Llamando a /api/companies");const a=await je({limit:500});console.log("ğŸ” fetchClients - Respuesta recibida:",a);const t=(a==null?void 0:a.data)||a||[];console.log("ğŸ” fetchClients - Lista de clientes:",t.length,"clientes"),G(t)}catch(a){console.error("âŒ Error fetching clients:",a),T("Error al cargar los clientes: "+(a.message||"Error desconocido")),G([])}},le=a=>{if(console.log("ğŸ” handleClientSearch - TÃ©rmino de bÃºsqueda:",a),R(a),!a.trim()){B([]),I(!1);return}const t=a.toLowerCase();console.log("ğŸ” handleClientSearch - BÃºsqueda en minÃºsculas:",t);const n=ne.filter(r=>{var y,X,J,Z,H;const f=(y=r.name)==null?void 0:y.toLowerCase().includes(t),l=(X=r.ruc)==null?void 0:X.toLowerCase().includes(t),C=(J=r.email)==null?void 0:J.toLowerCase().includes(t),b=(Z=r.phone)==null?void 0:Z.toLowerCase().includes(t),g=(H=r.name)==null?void 0:H.toLowerCase().split(" ").some(pe=>pe.includes(t)),w=f||l||C||b||g;return w&&console.log("âœ… Cliente encontrado:",r.name,"- Match:",{nameMatch:f,nameWordsMatch:g,rucMatch:l,emailMatch:C,phoneMatch:b}),w});console.log("ğŸ” handleClientSearch - Resultados encontrados:",n.length),B(n),I(!0)},ie=a=>{console.log("ğŸ” handleClientSelect - Cliente seleccionado:",a.name,"ID:",a.id),Y(a),R(a.name),I(!1),h(t=>({...t,company_name:a.name||"",ruc:a.ruc||"",contact_name:a.contact_name||"",contact_phone:a.phone||"",contact_email:a.email||"",project_location:a.address||""})),console.log("âœ… Campos del cliente llenados automÃ¡ticamente:",{company_name:a.name,ruc:a.ruc,contact_name:a.contact_name,contact_phone:a.phone,contact_email:a.email,project_location:a.address})},de=()=>{console.log("ğŸ” handleClientClear - Limpiando selecciÃ³n de cliente"),Y(null),R(""),I(!1),h(W)};c.useEffect(()=>{re()},[]);const me=async a=>{var t,n,r,f;a.preventDefault(),F(!0),T("");try{if(!o.company_name)throw new Error("Debe ingresar al menos el nombre de la empresa");let l=((t=m.project)==null?void 0:t.id)||m.project_id,C=(n=m.company)==null?void 0:n.id;if(!C){if(!o.ruc)throw new Error("Debe ingresar el RUC de la empresa");const y=await xe({type:"empresa",ruc:o.ruc,name:o.company_name,address:o.project_location||"",email:o.contact_email||"",phone:o.contact_phone||"",contact_name:o.contact_name||"",city:o.project_location||"",sector:"servicios"});C=y.id,console.log("âœ… Empresa obtenida/creada:",y)}if(!l){const y=await be({company_id:C,name:o.project_name||`Proyecto ${o.company_name}`,location:o.project_location||"Por definir",contact_name:o.contact_name,contact_phone:o.contact_phone,contact_email:o.contact_email,status:"activo",project_type:"cotizacion",priority:"normal"});l=y.id,console.log("âœ… Proyecto creado automÃ¡ticamente:",y)}const b=ye(),g={project_id:l,variant_id:d||null,client_contact:o.contact_name,client_email:o.contact_email,client_phone:o.contact_phone,issue_date:s.issue_date||new Date().toISOString().slice(0,10),subtotal:_,igv:D,total:Q,status:"borrador",reference:s.reference,reference_type:JSON.stringify(s.reference_type),category_main:s.category_main,quote_code:b,meta:JSON.stringify({customer:o,quote:{...s,request_date:s.request_date||new Date().toISOString().slice(0,10),delivery_days:s.delivery_days||4,reference:s.reference,category_main:s.category_main,quote_code:b},items:N,conditions_text:z,payment_terms:s.payment_terms,file_name:oe||`CotizaciÃ³n ${new Date().getFullYear()}-${String(new Date().getMonth()+1).padStart(2,"0")}${String(new Date().getDate()).padStart(2,"0")} LEM-GEOFAL-${((r=o.company_name)==null?void 0:r.toUpperCase())||"CLIENTE"}`})},w=await ge(g);alert(`âœ… CotizaciÃ³n creada exitosamente
ğŸ“‹ CÃ³digo: ${b}
ğŸ·ï¸ CategorÃ­a: ${s.category_main==="laboratorio"?"ğŸ§ª Laboratorio":"âš™ï¸ IngenierÃ­a"}
ğŸ“Š Ãtems guardados: ${N.length} Ã­tems
ğŸ’° Total: S/ ${((f=s.total)==null?void 0:f.toLocaleString())||"0.00"}`),te(w.id)}catch(l){console.error("Error:",l),T(l.message||"Error al crear cotizaciÃ³n")}finally{F(!1)}},ue=async()=>{try{const a=V;if(!a)return alert("Guarde la cotizaciÃ³n antes de generar el borrador");const t="http://localhost:4000/api".replace(/\/$/,"")||"",n=`/api/quotes/${a}/export/pdf-draft`,r=t&&/\/api$/i.test(t)?`${t}${n.replace(/^\/api/,"")}`:`${t}${n}`,f=localStorage.getItem("token");if(!f)throw new Error("No se encontrÃ³ token de autenticaciÃ³n");const l=await fetch(r,{method:"GET",headers:{Authorization:`Bearer ${f}`,"Content-Type":"application/json"}});if(!l.ok)throw new Error(`Error ${l.status}: ${l.statusText}`);const C=await l.blob(),b=window.URL.createObjectURL(C),g=document.createElement("a");g.href=b,g.download=`cotizacion-borrador-${a}.pdf`,document.body.appendChild(g),g.click(),document.body.removeChild(g),window.URL.revokeObjectURL(b)}catch(a){console.error("Error al exportar borrador:",a),alert(`No se pudo exportar borrador: ${a.message}`)}};return e.jsxs(he,{titulo:"ğŸ“‹ CotizaciÃ³n Inteligente",descripcion:"Formulario unificado para crear cotizaciones de forma rÃ¡pida e intuitiva",children:[k&&e.jsx("div",{className:"alert alert-danger",children:k}),e.jsxs("form",{onSubmit:me,className:"intelligent-quote-form",children:[e.jsxs("div",{className:"alert alert-light border mt-3 intelligent-intro",children:[e.jsx("h5",{children:"ğŸš€ Flujo Simplificado"}),e.jsx("p",{className:"mb-0",children:'Completa los datos del cliente, proyecto y cotizaciÃ³n. Usa el botÃ³n "ğŸ’¾ GUARDAR COTIZACIÃ“N" para guardar tu trabajo.'})]}),e.jsxs("div",{className:"intelligent-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("span",{className:"section-icon",children:"ğŸ¢"}),e.jsx("h4",{children:"CLIENTE"}),e.jsx("span",{className:"section-status",children:o.company_name?"âœ… Cliente configurado":"â³ Pendiente"})]}),e.jsxs("div",{className:"section-content",children:[e.jsx("div",{className:"row g-3 mb-4",children:e.jsxs("div",{className:"col-md-12",children:[e.jsx("label",{className:"form-label",children:"Buscar Cliente Existente"}),e.jsxs("div",{className:"position-relative",children:[e.jsx("input",{type:"text",className:"form-control",value:O,onChange:a=>le(a.target.value),onFocus:()=>I(!0),placeholder:"Buscar por nombre, RUC, email o telÃ©fono..."}),v&&e.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm position-absolute end-0 top-50 translate-middle-y me-2",onClick:de,children:"âœ•"})]}),O&&K&&S.length>0&&e.jsxs("div",{className:"border rounded mt-2",style:{maxHeight:"200px",overflowY:"auto"},children:[e.jsx("div",{className:"p-2 bg-light border-bottom",children:e.jsxs("small",{className:"text-muted",children:[S.length," cliente",S.length!==1?"s":""," encontrado",S.length!==1?"s":""]})}),S.map(a=>e.jsxs("div",{className:"p-2 border-bottom cursor-pointer hover-bg-light",onClick:()=>ie(a),style:{cursor:"pointer"},children:[e.jsx("div",{className:"fw-bold",children:a.name}),e.jsxs("small",{className:"text-muted",children:["RUC: ",a.ruc," | Email: ",a.email,a.phone&&` | Tel: ${a.phone}`]})]},a.id))]}),O&&K&&S.length===0&&e.jsx("div",{className:"border rounded mt-2 p-3 text-center",children:e.jsxs("small",{className:"text-muted",children:['No se encontraron clientes con "',O,'"']})}),v&&e.jsxs("div",{className:"mt-2 p-2 bg-light rounded",children:[e.jsx("strong",{children:"Cliente seleccionado:"})," ",v.name,e.jsx("br",{}),e.jsxs("small",{className:"text-muted",children:["RUC: ",v.ruc," | Email: ",v.email,v.phone&&` | Tel: ${v.phone}`]})]})]})}),e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Empresa"}),e.jsx("input",{className:"form-control",value:o.company_name,onChange:a=>h({...o,company_name:a.target.value}),required:!0,placeholder:"Nombre de la empresa"})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"R.U.C. *"}),e.jsx("input",{className:"form-control",value:o.ruc,onChange:a=>h({...o,ruc:a.target.value}),placeholder:"RUC de la empresa",required:!0})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Contacto"}),e.jsx("input",{className:"form-control",value:o.contact_name,onChange:a=>h({...o,contact_name:a.target.value}),required:!0,placeholder:"Nombre del contacto"})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"TelÃ©fono"}),e.jsx("input",{className:"form-control",value:o.contact_phone,onChange:a=>h({...o,contact_phone:a.target.value}),placeholder:"TelÃ©fono del contacto"})]}),e.jsxs("div",{className:"col-md-12",children:[e.jsx("label",{className:"form-label",children:"Correo"}),e.jsx("input",{type:"email",className:"form-control",value:o.contact_email,onChange:a=>h({...o,contact_email:a.target.value}),placeholder:"Correo del contacto"})]})]})]})]}),e.jsxs("div",{className:"intelligent-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("span",{className:"section-icon",children:"ğŸ“"}),e.jsx("h4",{children:"PROYECTO"}),e.jsx("span",{className:"section-status",children:o.project_name?"âœ… Proyecto configurado":"â³ Pendiente"})]}),e.jsx("div",{className:"section-content",children:e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Nombre del Proyecto"}),e.jsx("input",{className:"form-control",value:o.project_name,onChange:a=>h({...o,project_name:a.target.value}),required:!0,placeholder:"Nombre del proyecto"})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"UbicaciÃ³n"}),e.jsx("input",{className:"form-control",value:o.project_location,onChange:a=>h({...o,project_location:a.target.value}),placeholder:"UbicaciÃ³n del proyecto"})]})]})})]}),e.jsxs("div",{className:"intelligent-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("span",{className:"section-icon",children:"ğŸ“‹"}),e.jsx("h4",{children:"COTIZACIÃ“N"}),e.jsx("span",{className:"section-status",children:d?"âœ… Variante seleccionada":"â³ Pendiente"})]}),e.jsxs("div",{className:"section-content",children:[e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Fecha de Solicitud"}),e.jsx("input",{type:"date",className:"form-control",value:s.request_date,onChange:a=>u({...s,request_date:a.target.value})})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Fecha de EmisiÃ³n"}),e.jsx("input",{type:"date",className:"form-control",value:s.issue_date,onChange:a=>u({...s,issue_date:a.target.value})})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Comercial"}),e.jsx("input",{className:"form-control",value:s.commercial_name,onChange:a=>u({...s,commercial_name:a.target.value}),placeholder:"Nombre del comercial"})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"TelÃ©fono Comercial"}),e.jsx("input",{type:"tel",className:"form-control",value:s.commercial_phone,onChange:a=>u({...s,commercial_phone:a.target.value}),required:!0,placeholder:"TelÃ©fono del comercial"})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Variante"}),e.jsxs("select",{className:"form-select",value:d,onChange:a=>E(a.target.value),children:[e.jsx("option",{value:"",children:"Seleccionar variante"}),(i||[]).map(a=>e.jsxs("option",{value:a.id,children:[a.code," - ",a.title]},a.id))]})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Forma de Pago"}),e.jsxs("select",{className:"form-select",value:s.payment_terms,onChange:a=>u({...s,payment_terms:a.target.value}),children:[e.jsx("option",{value:"adelantado",children:"Adelantado"}),e.jsx("option",{value:"50%",children:"Adelanto 50% y saldo previo al informe"}),e.jsx("option",{value:"credito7",children:"CrÃ©dito 7 dÃ­as con OS"}),e.jsx("option",{value:"credito15",children:"CrÃ©dito 15 dÃ­as con OS"}),e.jsx("option",{value:"credito30",children:"CrÃ©dito 30 dÃ­as con OS"})]})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"DÃ­as HÃ¡biles"}),e.jsx("input",{type:"number",className:"form-control",value:s.delivery_days,onChange:a=>u({...s,delivery_days:parseInt(a.target.value)||4}),min:"1",max:"30"})]}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-check mt-4",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:"igv",checked:s.igv,onChange:a=>u({...s,igv:a.target.checked})}),e.jsx("label",{className:"form-check-label",htmlFor:"igv",children:"Aplicar IGV 18%"})]})})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"form-label",children:"Referencia"}),e.jsx("input",{className:"form-control",value:s.reference,onChange:a=>u({...s,reference:a.target.value}),placeholder:"SEGÃšN LO SOLICITADO VÃA CORREO ELECTRÃ“NICO / LLAMADA TELEFÃ“NICA"})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"form-label",children:"Condiciones EspecÃ­ficas"}),e.jsx("textarea",{className:"form-control",rows:4,placeholder:"Las condiciones se auto-completan segÃºn la variante seleccionada",value:z,onChange:a=>q(a.target.value)})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"form-label",children:"CategorÃ­a Principal"}),e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"radio",name:"categoryMain",id:"laboratorio",value:"laboratorio",checked:s.category_main==="laboratorio",onChange:a=>u({...s,category_main:a.target.value})}),e.jsx("label",{className:"form-check-label",htmlFor:"laboratorio",children:"ğŸ§ª Laboratorio"})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"radio",name:"categoryMain",id:"ingenieria",value:"ingenieria",checked:s.category_main==="ingenieria",onChange:a=>u({...s,category_main:a.target.value})}),e.jsx("label",{className:"form-check-label",htmlFor:"ingenieria",children:"âš™ï¸ IngenierÃ­a"})]})})]}),e.jsx("div",{className:"alert alert-info mt-2",children:e.jsxs("small",{children:[e.jsx("strong",{children:"ğŸ’¡ Importante:"})," Selecciona la categorÃ­a principal para que el sistema pueda categorizar automÃ¡ticamente los Ã­tems y alimentar el embudo de ventas."]})})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"form-label",children:"Ãtems de la CotizaciÃ³n"}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-bordered table-striped",children:[e.jsx("thead",{className:"table-dark",children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"10%"},children:"CÃ³digo"}),e.jsx("th",{style:{width:"35%"},children:"DescripciÃ³n"}),e.jsx("th",{style:{width:"15%"},children:"Norma"}),e.jsx("th",{style:{width:"12%"},children:"Precio Unit."}),e.jsx("th",{style:{width:"10%"},children:"Cantidad"}),e.jsx("th",{style:{width:"12%"},children:"Parcial"}),e.jsx("th",{style:{width:"6%"}})]})}),e.jsx("tbody",{children:N.map((a,t)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("input",{className:"form-control form-control-sm",value:a.code,onChange:n=>A(t,{code:n.target.value}),placeholder:"CÃ³digo"})}),e.jsx("td",{children:e.jsx(fe,{value:a.description,onChange:n=>A(t,{description:n}),onSelect:n=>{n&&A(t,{code:n.codigo,description:n.descripcion,norm:n.norma,unit_price:n.precio})},placeholder:"Buscar servicio...",size:"sm"})}),e.jsx("td",{children:e.jsx("input",{className:"form-control form-control-sm",value:a.norm,onChange:n=>A(t,{norm:n.target.value}),placeholder:"Norma"})}),e.jsx("td",{children:e.jsx("input",{type:"number",step:"0.01",className:"form-control form-control-sm",value:a.unit_price,onChange:n=>A(t,{unit_price:n.target.value}),placeholder:"0.00"})}),e.jsx("td",{children:e.jsx("input",{type:"number",className:"form-control form-control-sm",value:a.quantity,onChange:n=>A(t,{quantity:n.target.value}),min:"1"})}),e.jsx("td",{children:e.jsxs("span",{className:"fw-bold text-success",children:["S/ ",ae(a).toFixed(2)]})}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>ce(t),disabled:N.length===1,title:"Eliminar Ã­tem",children:"ğŸ—‘ï¸"})})]},t))})]})}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-3",children:[e.jsx("button",{type:"button",className:"btn btn-outline-primary",onClick:se,children:"â• Agregar Ã­tem"}),e.jsxs("div",{className:"text-end",children:[e.jsxs("div",{className:"h6 mb-1",children:["Subtotal: ",e.jsxs("span",{className:"text-primary",children:["S/ ",_.toFixed(2)]})]}),e.jsxs("div",{className:"h6 mb-1",children:["IGV 18%: ",e.jsxs("span",{className:"text-primary",children:["S/ ",D.toFixed(2)]})]}),e.jsxs("div",{className:"h5 mb-0",children:["Total: ",e.jsxs("span",{className:"text-success fw-bold",children:["S/ ",Q.toFixed(2)]})]})]})]})]})]})]}),e.jsxs("div",{className:"intelligent-actions",children:[e.jsx("button",{type:"submit",className:"btn btn-success btn-lg",disabled:P||!o.company_name||!o.ruc,children:P?"ğŸ’¾ Guardando...":"ğŸ’¾ GUARDAR COTIZACIÃ“N"}),e.jsx("button",{type:"button",className:"btn btn-outline-primary btn-lg",onClick:()=>window.print(),children:"ğŸ‘ï¸ Vista Previa"}),e.jsx("button",{type:"button",className:"btn btn-outline-warning btn-lg",onClick:ue,disabled:!V,children:"ğŸ“„ PDF Borrador"})]})]})]})}export{Ve as default};
//# sourceMappingURL=CotizacionInteligente-EFbjFZTP.js.map
