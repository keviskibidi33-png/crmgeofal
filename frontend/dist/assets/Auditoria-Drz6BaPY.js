import{R as p,r as c,j as s}from"./index-Vrmn15ab.js";import{M as b}from"./ModuloBase-BWIoHr2q.js";import{D as g}from"./DataTable-BW3K9Pm5.js";import{T as x}from"./Toolbar-BZWX08af.js";import{u as f}from"./useQuery-C0PUex0E.js";const y=(e={})=>{const o=new URLSearchParams;e.page&&o.set("page",e.page),e.limit&&o.set("limit",e.limit);const i=o.toString(),a=i?`/api/audit?${i}`:"/api/audit";return p(a)};function M(){const[e,o]=c.useState(1),[i]=c.useState(20),{data:a,isLoading:r}=f(["audit",{page:e,limit:i}],async()=>{const t=await y({page:e,limit:i}),l=Array.isArray(t==null?void 0:t.data)?t.data:(t==null?void 0:t.rows)||t||[],h=Number((t==null?void 0:t.total)||l.length||0);return{rows:l,total:h}},{keepPreviousData:!0}),u=c.useMemo(()=>[{header:"ID",key:"id",width:80},{header:"Acción",key:"action"},{header:"Usuario",key:"user_name",render:t=>t.user_name||t.performed_by||t.user_id},{header:"Fecha",key:"performed_at",render:t=>t.performed_at?String(t.performed_at).slice(0,19).replace("T"," "):t.created_at?String(t.created_at).slice(0,19).replace("T"," "):"—",width:160},{header:"Notas",key:"notes"}],[]),d=(a==null?void 0:a.total)||0,m=(a==null?void 0:a.rows)||[],n=Math.max(1,Math.ceil(d/i));return s.jsxs(b,{titulo:"Auditoría",descripcion:"Registro de acciones relevantes del sistema.",children:[s.jsx(x,{compact:!0,left:s.jsxs("div",{className:"text-muted",children:["Total: ",d]}),right:s.jsxs("div",{className:"btn-group",children:[s.jsx("button",{className:"btn btn-outline-secondary",disabled:e<=1||r,onClick:()=>o(t=>Math.max(1,t-1)),children:"Anterior"}),s.jsxs("span",{className:"btn btn-outline-secondary disabled",children:[e,"/",n]}),s.jsx("button",{className:"btn btn-outline-secondary",disabled:e>=n||r,onClick:()=>o(t=>Math.min(n,t+1)),children:"Siguiente"})]})}),s.jsx(g,{columns:u,rows:m,loading:r})]})}export{M as default};
//# sourceMappingURL=Auditoria-Drz6BaPY.js.map
