import{r as d,b as C,j as e,ao as v,h as y,aq as S,a0 as u,$ as R,l as $}from"./index-_ax5caxz.js";import{P as E}from"./PageHeader-D9ORK77W.js";import{S as l}from"./StatsCard-yUry652J.js";import{C as t,R as c}from"./Row-DUT7dzcT.js";import{S as w}from"./Spinner-CWz_2665.js";import{A as F}from"./Alert-e0x4JDT9.js";import{C as r}from"./Col-DhWa0-63.js";import{C as n}from"./Card-DX68ND5N.js";function T(){var j,m,b;const[s,p]=d.useState(null),[N,o]=d.useState(!0),[h,x]=d.useState(null);d.useEffect(()=>{f()},[]);const f=async()=>{try{o(!0),x(null);const a=await C("/api/role-dashboard/jefa-comercial");p(a)}catch(a){console.error("Error fetching dashboard data:",a),x("Error al cargar los datos del dashboard")}finally{o(!1)}};return N?e.jsx(t,{fluid:!0,className:"p-4",children:e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"400px"},children:e.jsx(w,{animation:"border",size:"lg"})})}):h?e.jsx(t,{fluid:!0,className:"p-4",children:e.jsx(F,{variant:"danger",children:h})}):e.jsxs(t,{fluid:!0,className:"p-4",children:[e.jsx(E,{title:"Dashboard Jefa Comercial",subtitle:"Métricas de embudo, vendedores y conversiones",icon:v}),e.jsxs(c,{className:"mb-4",children:[e.jsx(r,{lg:3,md:6,className:"mb-3",children:e.jsx(l,{title:"Total Vendedores",value:(s==null?void 0:s.totalVendedores)||0,icon:y,color:"primary",subtitle:"Vendedores activos"})}),e.jsx(r,{lg:3,md:6,className:"mb-3",children:e.jsx(l,{title:"Cotizaciones Totales",value:(s==null?void 0:s.totalCotizaciones)||0,icon:S,color:"info",subtitle:`${(s==null?void 0:s.cotizacionesAprobadas)||0} aprobadas`})}),e.jsx(r,{lg:3,md:6,className:"mb-3",children:e.jsx(l,{title:"Ingresos Generados",value:`$${((s==null?void 0:s.totalIngresos)||0).toLocaleString()}`,icon:u,color:"success",subtitle:`${(s==null?void 0:s.cotizacionesFacturadas)||0} facturadas`})}),e.jsx(r,{lg:3,md:6,className:"mb-3",children:e.jsx(l,{title:"Tasa de Conversión",value:`${(s==null?void 0:s.conversionRate)||0}%`,icon:R,color:"warning",subtitle:"Cotizaciones aprobadas"})})]}),e.jsxs(c,{className:"mb-4",children:[e.jsx(r,{lg:6,md:6,className:"mb-3",children:e.jsx(l,{title:"Cotizaciones Este Mes",value:(s==null?void 0:s.cotizacionesEsteMes)||0,icon:$,color:"primary",subtitle:"Nuevas cotizaciones"})}),e.jsx(r,{lg:6,md:6,className:"mb-3",children:e.jsx(l,{title:"Ingresos Este Mes",value:`$${((s==null?void 0:s.ingresosEsteMes)||0).toLocaleString()}`,icon:u,color:"success",subtitle:"Ingresos del mes actual"})})]}),e.jsxs(c,{className:"mb-4",children:[e.jsx(r,{lg:6,children:e.jsxs(n,{className:"shadow-sm",children:[e.jsx(n.Header,{children:e.jsx("h5",{className:"mb-0",children:"Embudo por Categoría"})}),e.jsx(n.Body,{children:((j=s==null?void 0:s.embudoPorCategoria)==null?void 0:j.length)>0?e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Categoría"}),e.jsx("th",{children:"Total"}),e.jsx("th",{children:"Aprobadas"}),e.jsx("th",{children:"Conversión"}),e.jsx("th",{children:"Ingresos"})]})}),e.jsx("tbody",{children:s.embudoPorCategoria.map((a,i)=>e.jsxs("tr",{children:[e.jsx("td",{children:a.categoria}),e.jsx("td",{children:a.total}),e.jsx("td",{children:a.aprobadas}),e.jsx("td",{children:e.jsxs("span",{className:`badge ${a.conversionRate>20?"bg-success":a.conversionRate>10?"bg-warning":"bg-danger"}`,children:[a.conversionRate,"%"]})}),e.jsxs("td",{children:["$",a.ingresos.toLocaleString()]})]},i))})]})}):e.jsx("p",{className:"text-muted",children:"No hay datos de embudo disponibles"})})]})}),e.jsx(r,{lg:6,children:e.jsxs(n,{className:"shadow-sm",children:[e.jsx(n.Header,{children:e.jsx("h5",{className:"mb-0",children:"Rendimiento de Vendedores"})}),e.jsx(n.Body,{children:((m=s==null?void 0:s.rendimientoVendedores)==null?void 0:m.length)>0?e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Vendedor"}),e.jsx("th",{children:"Cotizaciones"}),e.jsx("th",{children:"Aprobadas"}),e.jsx("th",{children:"Conversión"}),e.jsx("th",{children:"Ingresos"})]})}),e.jsx("tbody",{children:s.rendimientoVendedores.map((a,i)=>e.jsxs("tr",{children:[e.jsx("td",{children:a.nombre}),e.jsx("td",{children:a.totalCotizaciones}),e.jsx("td",{children:a.cotizacionesAprobadas}),e.jsx("td",{children:e.jsxs("span",{className:`badge ${a.conversionRate>20?"bg-success":a.conversionRate>10?"bg-warning":"bg-danger"}`,children:[a.conversionRate,"%"]})}),e.jsxs("td",{children:["$",a.ingresosGenerados.toLocaleString()]})]},i))})]})}):e.jsx("p",{className:"text-muted",children:"No hay datos de vendedores disponibles"})})]})})]}),e.jsx(c,{children:e.jsx(r,{children:e.jsxs(n,{className:"shadow-sm",children:[e.jsx(n.Header,{children:e.jsx("h5",{className:"mb-0",children:"Cotizaciones Recientes"})}),e.jsx(n.Body,{children:((b=s==null?void 0:s.cotizacionesRecientes)==null?void 0:b.length)>0?e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Código"}),e.jsx("th",{children:"Cliente"}),e.jsx("th",{children:"Empresa"}),e.jsx("th",{children:"Monto"}),e.jsx("th",{children:"Estado"}),e.jsx("th",{children:"Fecha"}),e.jsx("th",{children:"Vendedor"})]})}),e.jsx("tbody",{children:s.cotizacionesRecientes.map((a,i)=>{var g;return e.jsxs("tr",{children:[e.jsx("td",{children:a.quote_number}),e.jsx("td",{children:a.client_contact}),e.jsx("td",{children:a.company_name||"N/A"}),e.jsxs("td",{children:["$",((g=a.total_amount)==null?void 0:g.toLocaleString())||0]}),e.jsx("td",{children:e.jsx("span",{className:`badge ${a.status==="aprobada"?"bg-success":a.status==="facturada"?"bg-primary":a.status==="pendiente"?"bg-warning":"bg-secondary"}`,children:a.status})}),e.jsx("td",{children:new Date(a.created_at).toLocaleDateString()}),e.jsx("td",{children:a.created_by_name})]},i)})})]})}):e.jsx("p",{className:"text-muted",children:"No hay cotizaciones recientes"})})]})})})]})}export{T as default};
//# sourceMappingURL=JefaComercialDashboard-CkyQ44Tm.js.map
