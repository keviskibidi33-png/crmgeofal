{"version":3,"file":"Clientes-DXeHpZfM.js","sources":["../../src/components/ClientFormRedesigned.jsx","../../src/components/common/PermissionDeniedModal.jsx","../../src/components/ClientStatusDropdown.jsx","../../src/services/clientComments.js","../../src/components/ClientChat.jsx","../../src/components/ClientHistoryModal.jsx","../../src/pages/Clientes.jsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { FiUser, FiMail, FiPhone, FiMapPin, FiHome, FiUserCheck, FiX, FiSave } from 'react-icons/fi';\r\nimport './ClientFormRedesigned.css';\r\n\r\nconst CLIENT_TYPES = [\r\n  { value: 'empresa', label: 'Empresa' },\r\n  { value: 'persona', label: 'Persona Natural' }\r\n];\r\n\r\nconst SECTORS = [\r\n  { value: 'construccion', label: 'Construcción' },\r\n  { value: 'mineria', label: 'Minería' },\r\n  { value: 'servicios', label: 'Servicios' },\r\n  { value: 'comercio', label: 'Comercio' },\r\n  { value: 'industria', label: 'Industria' },\r\n  { value: 'gobierno', label: 'Gobierno' },\r\n  { value: 'otro', label: 'Otro' }\r\n];\r\n\r\nconst CITIES = [\r\n  { value: 'lima', label: 'Lima' },\r\n  { value: 'arequipa', label: 'Arequipa' },\r\n  { value: 'trujillo', label: 'Trujillo' },\r\n  { value: 'chiclayo', label: 'Chiclayo' },\r\n  { value: 'piura', label: 'Piura' },\r\n  { value: 'cusco', label: 'Cusco' },\r\n  { value: 'otro', label: 'Otra' }\r\n];\r\n\r\nconst ClientFormRedesigned = ({ \r\n  show, \r\n  onHide, \r\n  data = {}, \r\n  onSubmit, \r\n  loading = false, \r\n  isEditing = false \r\n}) => {\r\n  const [formData, setFormData] = useState({\r\n    type: data.type || 'empresa',\r\n    name: data.name || '',\r\n    ruc: data.ruc || '',\r\n    dni: data.dni || '',\r\n    contact_name: data.contact_name || '',\r\n    email: data.email || '',\r\n    phone: data.phone || '',\r\n    address: data.address || '',\r\n    city: data.city || 'lima',\r\n    sector: data.sector || 'servicios'\r\n  });\r\n\r\n  const [errors, setErrors] = useState({});\r\n\r\n  // Resetear formulario cuando cambien los datos o se abra/cierre el modal\r\n  React.useEffect(() => {\r\n    if (show) {\r\n      // Si es un nuevo cliente (no hay ID), usar valores vacíos\r\n      const isNewClient = !data.id;\r\n      \r\n      setFormData({\r\n        type: data.type || 'empresa',\r\n        name: isNewClient ? '' : (data.name || ''),\r\n        ruc: isNewClient ? '' : (data.ruc || ''),\r\n        dni: isNewClient ? '' : (data.dni || ''),\r\n        contact_name: isNewClient ? '' : (data.contact_name || ''),\r\n        email: isNewClient ? '' : (data.email || ''),\r\n        phone: isNewClient ? '' : (data.phone || ''),\r\n        address: isNewClient ? '' : (data.address || ''),\r\n        city: data.city || 'lima',\r\n        sector: data.sector || 'servicios'\r\n      });\r\n      setErrors({});\r\n    }\r\n  }, [show, data, isEditing]);\r\n\r\n  const handleInputChange = (field, value) => {\r\n    setFormData(prev => ({ ...prev, [field]: value }));\r\n    \r\n    // Validación en tiempo real para RUC y DNI\r\n    if (field === 'ruc' && formData.type === 'empresa') {\r\n      if (value && !validateRUC(value)) {\r\n        setErrors(prev => ({ ...prev, ruc: 'El RUC debe empezar con 20 y tener 11 dígitos' }));\r\n      } else {\r\n        setErrors(prev => ({ ...prev, ruc: '' }));\r\n      }\r\n    }\r\n    \r\n    if (field === 'dni' && formData.type === 'persona') {\r\n      if (value && !validateDNI(value)) {\r\n        setErrors(prev => ({ ...prev, dni: 'El DNI debe tener exactamente 8 dígitos' }));\r\n      } else {\r\n        setErrors(prev => ({ ...prev, dni: '' }));\r\n      }\r\n    }\r\n    \r\n    if (field === 'phone') {\r\n      if (value && !validatePhone(value)) {\r\n        setErrors(prev => ({ ...prev, phone: 'El teléfono debe tener 9 dígitos' }));\r\n      } else {\r\n        setErrors(prev => ({ ...prev, phone: '' }));\r\n      }\r\n    }\r\n    \r\n    // Limpiar error cuando el usuario empiece a escribir\r\n    if (errors[field] && field !== 'ruc' && field !== 'dni') {\r\n      setErrors(prev => ({ ...prev, [field]: '' }));\r\n    }\r\n  };\r\n\r\n  // Función para validar RUC peruano\r\n  const validateRUC = (ruc) => {\r\n    if (!ruc) return false;\r\n    // RUC debe empezar con 20 y tener 11 dígitos\r\n    const rucRegex = /^20\\d{9}$/;\r\n    return rucRegex.test(ruc);\r\n  };\r\n\r\n  // Función para validar DNI peruano\r\n  const validateDNI = (dni) => {\r\n    if (!dni) return false;\r\n    // DNI debe tener exactamente 8 dígitos\r\n    const dniRegex = /^\\d{8}$/;\r\n    return dniRegex.test(dni);\r\n  };\r\n\r\n  // Función para validar teléfono peruano\r\n  const validatePhone = (phone) => {\r\n    if (!phone) return true; // Teléfono es opcional\r\n    // Teléfono debe tener 9 dígitos\r\n    const phoneRegex = /^\\d{9}$/;\r\n    return phoneRegex.test(phone);\r\n  };\r\n\r\n  const validateForm = () => {\r\n    const newErrors = {};\r\n\r\n    if (!formData.name.trim()) {\r\n      newErrors.name = 'El nombre/razón social es requerido';\r\n    }\r\n\r\n    if (formData.type === 'empresa') {\r\n      if (!formData.ruc.trim()) {\r\n        newErrors.ruc = 'El RUC es requerido para empresas';\r\n      } else if (!validateRUC(formData.ruc)) {\r\n        newErrors.ruc = 'El RUC debe empezar con 20 y tener 11 dígitos';\r\n      }\r\n    }\r\n\r\n    if (formData.type === 'persona') {\r\n      if (!formData.dni.trim()) {\r\n        newErrors.dni = 'El DNI es requerido para personas naturales';\r\n      } else if (!validateDNI(formData.dni)) {\r\n        newErrors.dni = 'El DNI debe tener exactamente 8 dígitos';\r\n      }\r\n    }\r\n\r\n    if (formData.email && !/\\S+@\\S+\\.\\S+/.test(formData.email)) {\r\n      newErrors.email = 'El email no es válido';\r\n    }\r\n\r\n    if (formData.phone && !validatePhone(formData.phone)) {\r\n      newErrors.phone = 'El teléfono debe tener 9 dígitos';\r\n    }\r\n\r\n    setErrors(newErrors);\r\n    return Object.keys(newErrors).length === 0;\r\n  };\r\n\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    \r\n    if (validateForm()) {\r\n      const submitData = { ...formData };\r\n      \r\n      // Limpiar campos según el tipo de cliente\r\n      if (submitData.type === 'empresa') {\r\n        delete submitData.dni;\r\n      } else {\r\n        delete submitData.ruc;\r\n      }\r\n      \r\n      onSubmit(submitData);\r\n    }\r\n  };\r\n\r\n  // Manejar errores del servidor\r\n  React.useEffect(() => {\r\n    if (data.error) {\r\n      if (data.error.includes('email') || data.error.includes('Email')) {\r\n        setErrors(prev => ({ ...prev, email: 'Este email ya está registrado' }));\r\n      }\r\n    }\r\n  }, [data.error]);\r\n\r\n  if (!show) return null;\r\n\r\n  return (\r\n    <div className=\"client-form-backdrop\" onClick={onHide}>\r\n      <div className=\"client-form-modal\" onClick={e => e.stopPropagation()}>\r\n        <div className=\"client-form-header\">\r\n          <h4>\r\n            <FiUser className=\"client-form-icon\" />\r\n            {isEditing ? 'Editar Cliente' : 'Nuevo Cliente'}\r\n          </h4>\r\n          <button className=\"close-btn\" onClick={onHide}>\r\n            <FiX />\r\n          </button>\r\n        </div>\r\n\r\n        <form onSubmit={handleSubmit} className=\"client-form-body\">\r\n          {/* Información Básica */}\r\n          <div className=\"client-form-section\">\r\n            <div className=\"client-form-section-title\">\r\n              <FiUser className=\"client-form-icon\" />\r\n              Información Básica\r\n            </div>\r\n            \r\n            <div className=\"client-form-row\">\r\n              <div className=\"client-form-group\">\r\n                <label className=\"client-form-label\">\r\n                  <FiHome className=\"client-form-icon\" />\r\n                  Tipo de Cliente <span className=\"required\">*</span>\r\n                </label>\r\n                <select\r\n                  className=\"client-form-select\"\r\n                  value={formData.type}\r\n                  onChange={(e) => handleInputChange('type', e.target.value)}\r\n                >\r\n                  {CLIENT_TYPES.map(type => (\r\n                    <option key={type.value} value={type.value}>\r\n                      {type.label}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n\r\n              <div className=\"client-form-group\">\r\n                <label className=\"client-form-label\">\r\n                  <FiUserCheck className=\"client-form-icon\" />\r\n                  Nombre/Razón Social <span className=\"required\">*</span>\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  className={`client-form-input ${errors.name ? 'error' : ''}`}\r\n                  value={formData.name}\r\n                  onChange={(e) => handleInputChange('name', e.target.value)}\r\n                  placeholder=\"Ingresa el nombre o razón social\"\r\n                />\r\n                {errors.name && <div className=\"client-form-error\">{errors.name}</div>}\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"client-form-row\">\r\n              {formData.type === 'empresa' ? (\r\n                <div className=\"client-form-group\">\r\n                  <label className=\"client-form-label\">\r\n                    <FiHome className=\"client-form-icon\" />\r\n                    RUC <span className=\"required\">*</span>\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    className={`client-form-input ${errors.ruc ? 'error' : (formData.ruc && validateRUC(formData.ruc) ? 'valid' : '')}`}\r\n                    value={formData.ruc}\r\n                    onChange={(e) => handleInputChange('ruc', e.target.value)}\r\n                    placeholder=\"20123456789\"\r\n                    maxLength=\"11\"\r\n                  />\r\n                  {errors.ruc && <div className=\"client-form-error\">{errors.ruc}</div>}\r\n                  <div className=\"client-form-help\">Solo para empresas - Debe empezar con 20 y tener 11 dígitos</div>\r\n                </div>\r\n              ) : (\r\n                <div className=\"client-form-group\">\r\n                  <label className=\"client-form-label\">\r\n                    <FiUser className=\"client-form-icon\" />\r\n                    DNI <span className=\"required\">*</span>\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    className={`client-form-input ${errors.dni ? 'error' : (formData.dni && validateDNI(formData.dni) ? 'valid' : '')}`}\r\n                    value={formData.dni}\r\n                    onChange={(e) => handleInputChange('dni', e.target.value)}\r\n                    placeholder=\"12345678\"\r\n                    maxLength=\"8\"\r\n                  />\r\n                  {errors.dni && <div className=\"client-form-error\">{errors.dni}</div>}\r\n                  <div className=\"client-form-help\">Solo para personas naturales - Debe tener exactamente 8 dígitos</div>\r\n                </div>\r\n              )}\r\n\r\n              <div className=\"client-form-group\">\r\n                <label className=\"client-form-label\">\r\n                  <FiUser className=\"client-form-icon\" />\r\n                  Nombre de Contacto\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  className=\"client-form-input\"\r\n                  value={formData.contact_name}\r\n                  onChange={(e) => handleInputChange('contact_name', e.target.value)}\r\n                  placeholder=\"Ingresa el nombre del contacto\"\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Información de Contacto */}\r\n          <div className=\"client-form-section\">\r\n            <div className=\"client-form-section-title\">\r\n              <FiMail className=\"client-form-icon\" />\r\n              Información de Contacto\r\n            </div>\r\n            \r\n            <div className=\"client-form-row\">\r\n              <div className=\"client-form-group\">\r\n                <label className=\"client-form-label\">\r\n                  <FiMail className=\"client-form-icon\" />\r\n                  Email\r\n                </label>\r\n                <input\r\n                  type=\"email\"\r\n                  className={`client-form-input ${errors.email ? 'error' : ''}`}\r\n                  value={formData.email}\r\n                  onChange={(e) => handleInputChange('email', e.target.value)}\r\n                  placeholder=\"contacto@empresa.com\"\r\n                />\r\n                {errors.email && <div className=\"client-form-error\">{errors.email}</div>}\r\n              </div>\r\n\r\n              <div className=\"client-form-group\">\r\n                <label className=\"client-form-label\">\r\n                  <FiPhone className=\"client-form-icon\" />\r\n                  Teléfono\r\n                </label>\r\n                <input\r\n                  type=\"tel\"\r\n                  className={`client-form-input ${errors.phone ? 'error' : (formData.phone && validatePhone(formData.phone) ? 'valid' : '')}`}\r\n                  value={formData.phone}\r\n                  onChange={(e) => handleInputChange('phone', e.target.value)}\r\n                  placeholder=\"930238631\"\r\n                  maxLength=\"9\"\r\n                />\r\n                {errors.phone && <div className=\"client-form-error\">{errors.phone}</div>}\r\n                <div className=\"client-form-help\">Debe tener 9 dígitos</div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Información de Ubicación */}\r\n          <div className=\"client-form-section\">\r\n            <div className=\"client-form-section-title\">\r\n              <FiMapPin className=\"client-form-icon\" />\r\n              Información de Ubicación\r\n            </div>\r\n            \r\n            <div className=\"client-form-row\">\r\n              <div className=\"client-form-group\">\r\n                <label className=\"client-form-label\">\r\n                  <FiMapPin className=\"client-form-icon\" />\r\n                  Dirección\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  className=\"client-form-input\"\r\n                  value={formData.address}\r\n                  onChange={(e) => handleInputChange('address', e.target.value)}\r\n                  placeholder=\"Ingresa la dirección\"\r\n                />\r\n              </div>\r\n\r\n              <div className=\"client-form-group\">\r\n                <label className=\"client-form-label\">\r\n                  <FiHome className=\"client-form-icon\" />\r\n                  Ciudad\r\n                </label>\r\n                <select\r\n                  className=\"client-form-select\"\r\n                  value={formData.city}\r\n                  onChange={(e) => handleInputChange('city', e.target.value)}\r\n                >\r\n                  {CITIES.map(city => (\r\n                    <option key={city.value} value={city.value}>\r\n                      {city.label}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"client-form-row single\">\r\n              <div className=\"client-form-group\">\r\n                <label className=\"client-form-label\">\r\n                  <FiHome className=\"client-form-icon\" />\r\n                  Sector\r\n                </label>\r\n                <select\r\n                  className=\"client-form-select\"\r\n                  value={formData.sector}\r\n                  onChange={(e) => handleInputChange('sector', e.target.value)}\r\n                >\r\n                  {SECTORS.map(sector => (\r\n                    <option key={sector.value} value={sector.value}>\r\n                      {sector.label}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </form>\r\n\r\n        <div className=\"client-form-actions\">\r\n          <button\r\n            type=\"button\"\r\n            className=\"client-form-btn client-form-btn-cancel\"\r\n            onClick={onHide}\r\n            disabled={loading}\r\n          >\r\n            <FiX />\r\n            Cancelar\r\n          </button>\r\n          <button\r\n            type=\"submit\"\r\n            className=\"client-form-btn client-form-btn-create\"\r\n            onClick={handleSubmit}\r\n            disabled={loading}\r\n          >\r\n            {loading ? (\r\n              <>\r\n                <div className=\"spinner-border spinner-border-sm\" role=\"status\">\r\n                  <span className=\"visually-hidden\">Cargando...</span>\r\n                </div>\r\n                {isEditing ? 'Actualizando...' : 'Creando...'}\r\n              </>\r\n            ) : (\r\n              <>\r\n                <FiSave />\r\n                {isEditing ? 'Actualizar' : 'Crear'}\r\n              </>\r\n            )}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ClientFormRedesigned;\r\n","import React from 'react';\r\nimport { Modal, Button } from 'react-bootstrap';\r\nimport { FiAlertTriangle, FiShield, FiX } from 'react-icons/fi';\r\n\r\nconst PermissionDeniedModal = ({ \r\n  show, \r\n  onHide, \r\n  action = \"realizar esta acción\",\r\n  requiredRole = \"administrador\",\r\n  currentRole = \"usuario\"\r\n}) => {\r\n  return (\r\n    <Modal show={show} onHide={onHide} centered backdrop=\"static\">\r\n      <Modal.Header className=\"bg-danger text-white border-0\">\r\n        <Modal.Title className=\"d-flex align-items-center\">\r\n          <FiShield className=\"me-2\" size={20} />\r\n          Acceso Denegado\r\n        </Modal.Title>\r\n        <Button \r\n          variant=\"link\" \r\n          className=\"text-white p-0 border-0\"\r\n          onClick={onHide}\r\n          style={{ fontSize: '1.5rem', lineHeight: 1 }}\r\n        >\r\n          <FiX />\r\n        </Button>\r\n      </Modal.Header>\r\n      \r\n      <Modal.Body className=\"py-4\">\r\n        <div className=\"text-center\">\r\n          <div className=\"mb-3\">\r\n            <FiAlertTriangle \r\n              size={48} \r\n              className=\"text-warning\"\r\n            />\r\n          </div>\r\n          \r\n          <h5 className=\"text-danger mb-3\">\r\n            No tienes permisos para {action}\r\n          </h5>\r\n          \r\n          <div className=\"alert alert-warning border-0 mb-3\">\r\n            <div className=\"d-flex align-items-center\">\r\n              <FiShield className=\"me-2 text-warning\" size={16} />\r\n              <div>\r\n                <strong>Rol requerido:</strong> {requiredRole}\r\n                <br />\r\n                <strong>Tu rol actual:</strong> {currentRole}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          \r\n          <p className=\"text-muted mb-0\">\r\n            Contacta al administrador del sistema si necesitas acceso a esta funcionalidad.\r\n          </p>\r\n        </div>\r\n      </Modal.Body>\r\n      \r\n      <Modal.Footer className=\"border-0 justify-content-center\">\r\n        <Button \r\n          variant=\"secondary\" \r\n          onClick={onHide}\r\n          className=\"px-4\"\r\n        >\r\n          Entendido\r\n        </Button>\r\n      </Modal.Footer>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default PermissionDeniedModal;\r\n","import React, { useState, useRef, useEffect } from 'react';\r\nimport { Dropdown, Button, Spinner, Alert } from 'react-bootstrap';\r\nimport { createPortal } from 'react-dom';\r\nimport { useQueryClient } from 'react-query';\r\nimport { FiChevronDown, FiCheck, FiSearch, FiHeart, FiClock, FiSend, FiMessageSquare, FiCheckCircle, FiX, FiMoreHorizontal } from 'react-icons/fi';\r\nimport { updateClientStatus } from '../services/companies';\r\n\r\n// Estados de clientes con iconos y colores\r\nconst CLIENT_STATUSES = {\r\n  prospeccion: {\r\n    label: 'Prospección',\r\n    icon: FiSearch,\r\n    color: 'secondary',\r\n    bgColor: '#6c757d'\r\n  },\r\n  interesado: {\r\n    label: 'Interesado',\r\n    icon: FiHeart,\r\n    color: 'info',\r\n    bgColor: '#17a2b8'\r\n  },\r\n  pendiente_cotizacion: {\r\n    label: 'Pendiente de Cotización',\r\n    icon: FiClock,\r\n    color: 'warning',\r\n    bgColor: '#ffc107'\r\n  },\r\n  cotizacion_enviada: {\r\n    label: 'Cotización Enviada',\r\n    icon: FiSend,\r\n    color: 'info',\r\n    bgColor: '#17a2b8'\r\n  },\r\n  negociacion: {\r\n    label: 'Negociación',\r\n    icon: FiMessageSquare,\r\n    color: 'secondary',\r\n    bgColor: '#6c757d'\r\n  },\r\n  ganado: {\r\n    label: 'Ganado',\r\n    icon: FiCheckCircle,\r\n    color: 'success',\r\n    bgColor: '#28a745'\r\n  },\r\n  perdido: {\r\n    label: 'Perdido',\r\n    icon: FiX,\r\n    color: 'danger',\r\n    bgColor: '#dc3545'\r\n  },\r\n  otro: {\r\n    label: 'Otro',\r\n    icon: FiMoreHorizontal,\r\n    color: 'light',\r\n    bgColor: '#f8f9fa'\r\n  }\r\n};\r\n\r\nconst ClientStatusDropdown = ({ \r\n  clientId, \r\n  currentStatus, \r\n  onStatusChange, \r\n  disabled = false,\r\n  size = 'sm',\r\n  showLabel = true \r\n}) => {\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const [show, setShow] = useState(false);\r\n  const [position, setPosition] = useState({ top: 0, left: 0 });\r\n  const buttonRef = useRef(null);\r\n  const menuRef = useRef(null);\r\n  const queryClient = useQueryClient();\r\n\r\n  const handleToggle = () => {\r\n    if (buttonRef.current) {\r\n      const rect = buttonRef.current.getBoundingClientRect();\r\n      setPosition({\r\n        top: rect.bottom + 5,\r\n        left: rect.left\r\n      });\r\n    }\r\n    setShow(!show);\r\n  };\r\n\r\n  const handleClickOutside = (event) => {\r\n    if (show && menuRef.current && !menuRef.current.contains(event.target) && \r\n        buttonRef.current && !buttonRef.current.contains(event.target)) {\r\n      setShow(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (show) {\r\n      document.addEventListener('mousedown', handleClickOutside);\r\n      return () => document.removeEventListener('mousedown', handleClickOutside);\r\n    }\r\n  }, [show]);\r\n\r\n  const handleStatusChange = async (newStatus) => {\r\n    if (newStatus === currentStatus) return;\r\n    \r\n    console.log(`🔄 ClientStatusDropdown - Iniciando cambio de estado del cliente ${clientId} de '${currentStatus}' a '${newStatus}'`);\r\n    \r\n    // Actualización optimista inmediata - cambiar el estado visual al instante\r\n    onStatusChange?.(newStatus);\r\n    setShow(false);\r\n    \r\n    // Luego hacer la llamada a la API en segundo plano\r\n    setLoading(true);\r\n    setError('');\r\n    \r\n    try {\r\n      console.log(`🔄 ClientStatusDropdown - Llamando a updateClientStatus...`);\r\n      const result = await updateClientStatus(clientId, newStatus);\r\n      console.log(`✅ ClientStatusDropdown - Estado actualizado exitosamente:`, result);\r\n      \r\n      // Invalidar queries para sincronizar con el servidor\r\n      queryClient.invalidateQueries(['clients']);\r\n      queryClient.invalidateQueries('companiesList');\r\n      queryClient.invalidateQueries('clientStats');\r\n      queryClient.invalidateQueries('companyStats');\r\n    } catch (err) {\r\n      console.error(`❌ ClientStatusDropdown - Error al actualizar estado:`, err);\r\n      setError(err.message || 'Error al actualizar estado');\r\n      // Revertir el cambio si falla la API\r\n      console.log(`🔄 ClientStatusDropdown - Revirtiendo estado a '${currentStatus}'`);\r\n      onStatusChange?.(currentStatus);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const currentStatusConfig = CLIENT_STATUSES[currentStatus] || CLIENT_STATUSES.prospeccion;\r\n  const CurrentIcon = currentStatusConfig.icon;\r\n\r\n  const dropdownMenu = show && createPortal(\r\n    <div\r\n      ref={menuRef}\r\n      className=\"dropdown-menu show\"\r\n      style={{\r\n        position: 'fixed',\r\n        top: position.top,\r\n        left: position.left,\r\n        zIndex: 99999,\r\n        minWidth: '200px',\r\n        maxHeight: '300px',\r\n        overflowY: 'auto',\r\n        boxShadow: '0 0.5rem 1rem rgba(0, 0, 0, 0.15)',\r\n        border: '1px solid rgba(0, 0, 0, 0.15)',\r\n        borderRadius: '0.375rem',\r\n        backgroundColor: 'white'\r\n      }}\r\n    >\r\n      {Object.entries(CLIENT_STATUSES).map(([status, config]) => {\r\n        const StatusIcon = config.icon;\r\n        const isCurrentStatus = status === currentStatus;\r\n        \r\n        return (\r\n          <button\r\n            key={status}\r\n            className={`dropdown-item d-flex align-items-center gap-2 ${isCurrentStatus ? 'active' : ''}`}\r\n            onClick={() => handleStatusChange(status)}\r\n            disabled={isCurrentStatus}\r\n            style={{\r\n              border: 'none',\r\n              background: isCurrentStatus ? config.bgColor : 'transparent',\r\n              color: isCurrentStatus ? 'white' : '#212529',\r\n              width: '100%',\r\n              textAlign: 'left',\r\n              padding: '0.5rem 1rem',\r\n              cursor: 'pointer'\r\n            }}\r\n            onMouseEnter={(e) => {\r\n              if (!isCurrentStatus) {\r\n                e.target.style.backgroundColor = '#f8f9fa';\r\n              }\r\n            }}\r\n            onMouseLeave={(e) => {\r\n              if (!isCurrentStatus) {\r\n                e.target.style.backgroundColor = 'transparent';\r\n              }\r\n            }}\r\n          >\r\n            <StatusIcon size={14} />\r\n            <span>{config.label}</span>\r\n            {isCurrentStatus && <FiCheck size={14} className=\"ms-auto\" />}\r\n          </button>\r\n        );\r\n      })}\r\n    </div>,\r\n    document.body\r\n  );\r\n\r\n  return (\r\n    <>\r\n      <div className=\"client-status-dropdown\">\r\n        {error && (\r\n          <Alert variant=\"danger\" className=\"mb-2\" style={{ fontSize: '0.8rem' }}>\r\n            {error}\r\n          </Alert>\r\n        )}\r\n        \r\n        <button\r\n          ref={buttonRef}\r\n          className={`btn btn-${currentStatusConfig.color} btn-${size} d-flex align-items-center gap-1`}\r\n          onClick={handleToggle}\r\n          disabled={disabled || loading}\r\n          style={{ \r\n            backgroundColor: currentStatusConfig.bgColor,\r\n            borderColor: currentStatusConfig.bgColor,\r\n            minWidth: '140px'\r\n          }}\r\n        >\r\n          {loading ? (\r\n            <Spinner animation=\"border\" size=\"sm\" />\r\n          ) : (\r\n            <>\r\n              <CurrentIcon size={14} />\r\n              {showLabel && <span>{currentStatusConfig.label}</span>}\r\n            </>\r\n          )}\r\n          <FiChevronDown size={12} />\r\n        </button>\r\n      </div>\r\n      {dropdownMenu}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ClientStatusDropdown;","import apiFetch from './api';\r\n\r\nconst clientCommentsService = {\r\n  /**\r\n   * Crear un nuevo comentario\r\n   */\r\n  async createComment(companyId, comment) {\r\n    try {\r\n      console.log('💬 Creando comentario para cliente:', companyId);\r\n      const response = await apiFetch('/api/client-comments', {\r\n        method: 'POST',\r\n        body: JSON.stringify({\r\n          company_id: companyId,\r\n          comment: comment\r\n        })\r\n      });\r\n      console.log('✅ Comentario creado:', response);\r\n      return response;\r\n    } catch (error) {\r\n      console.error('❌ Error creando comentario:', error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Obtener comentarios de un cliente\r\n   */\r\n  async getCommentsByCompany(companyId) {\r\n    try {\r\n      console.log('💬 Obteniendo comentarios para cliente:', companyId);\r\n      const response = await apiFetch(`/api/client-comments/company/${companyId}`, {\r\n        method: 'GET'\r\n      });\r\n      console.log('✅ Comentarios obtenidos:', response);\r\n      return response;\r\n    } catch (error) {\r\n      console.error('❌ Error obteniendo comentarios:', error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Actualizar un comentario\r\n   */\r\n  async updateComment(commentId, comment) {\r\n    try {\r\n      console.log('💬 Actualizando comentario:', commentId);\r\n      const response = await apiFetch(`/api/client-comments/${commentId}`, {\r\n        method: 'PUT',\r\n        body: JSON.stringify({\r\n          comment: comment\r\n        })\r\n      });\r\n      console.log('✅ Comentario actualizado:', response);\r\n      return response;\r\n    } catch (error) {\r\n      console.error('❌ Error actualizando comentario:', error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Eliminar un comentario\r\n   */\r\n  async deleteComment(commentId) {\r\n    try {\r\n      console.log('💬 Eliminando comentario:', commentId);\r\n      const response = await apiFetch(`/api/client-comments/${commentId}`, {\r\n        method: 'DELETE'\r\n      });\r\n      console.log('✅ Comentario eliminado:', response);\r\n      return response;\r\n    } catch (error) {\r\n      console.error('❌ Error eliminando comentario:', error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Marcar comentarios como leídos\r\n   */\r\n  async markCommentsAsRead(companyId) {\r\n    try {\r\n      console.log('💬 Marcando comentarios como leídos para cliente:', companyId);\r\n      const response = await apiFetch(`/api/client-comments/company/${companyId}/mark-read`, {\r\n        method: 'POST'\r\n      });\r\n      console.log('✅ Comentarios marcados como leídos:', response);\r\n      return response;\r\n    } catch (error) {\r\n      console.error('❌ Error marcando comentarios como leídos:', error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Obtener comentarios no leídos\r\n   */\r\n  async getUnreadComments() {\r\n    try {\r\n      console.log('💬 Obteniendo comentarios no leídos');\r\n      const response = await apiFetch('/api/client-comments/unread', {\r\n        method: 'GET'\r\n      });\r\n      console.log('✅ Comentarios no leídos obtenidos:', response);\r\n      return response;\r\n    } catch (error) {\r\n      console.error('❌ Error obteniendo comentarios no leídos:', error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Obtener comentarios recientes\r\n   */\r\n  async getRecentComments(limit = 10) {\r\n    try {\r\n      console.log('💬 Obteniendo comentarios recientes');\r\n      const response = await apiFetch(`/api/client-comments/recent?limit=${limit}`, {\r\n        method: 'GET'\r\n      });\r\n      console.log('✅ Comentarios recientes obtenidos:', response);\r\n      return response;\r\n    } catch (error) {\r\n      console.error('❌ Error obteniendo comentarios recientes:', error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Obtener estadísticas de comentarios\r\n   */\r\n  async getCommentsStats() {\r\n    try {\r\n      console.log('💬 Obteniendo estadísticas de comentarios');\r\n      const response = await apiFetch('/api/client-comments/stats', {\r\n        method: 'GET'\r\n      });\r\n      console.log('✅ Estadísticas obtenidas:', response);\r\n      return response;\r\n    } catch (error) {\r\n      console.error('❌ Error obteniendo estadísticas:', error);\r\n      throw error;\r\n    }\r\n  }\r\n};\r\n\r\nexport default clientCommentsService;\r\n","import React, { useState, useEffect, useRef } from 'react';\nimport { FiMessageSquare, FiSend, FiUser, FiClock, FiCheck } from 'react-icons/fi';\nimport { useMutation, useQuery, useQueryClient } from 'react-query';\nimport clientCommentsService from '../services/clientComments';\nimport { useAuth } from '../contexts/AuthContext';\nimport { useSocket } from '../contexts/SocketContext';\nimport './ClientChat.css';\n\nconst ClientChat = ({ companyId }) => {\n  const [newComment, setNewComment] = useState('');\n  const [isTyping, setIsTyping] = useState(false);\n  const messagesEndRef = useRef(null);\n  const queryClient = useQueryClient();\n  const { user } = useAuth();\n  const socket = useSocket();\n\n  // Obtener comentarios del cliente\n  const { data: commentsData, isLoading } = useQuery(\n    ['client-comments', companyId],\n    () => clientCommentsService.getCommentsByCompany(companyId),\n    {\n      refetchInterval: 10000, // Refrescar cada 10 segundos\n      onSuccess: () => {\n        // Marcar como leídos cuando se cargan\n        clientCommentsService.markCommentsAsRead(companyId);\n      }\n    }\n  );\n\n  const comments = commentsData?.comments || [];\n\n  // Mutación para crear comentario\n  const createCommentMutation = useMutation(\n    ({ companyId, comment }) => clientCommentsService.createComment(companyId, comment),\n    {\n      onSuccess: () => {\n        setNewComment('');\n        queryClient.invalidateQueries(['client-comments', companyId]);\n        alert('✅ Comentario agregado exitosamente');\n      },\n      onError: (error) => {\n        console.error('Error creando comentario:', error);\n        alert('❌ Error al enviar comentario');\n      }\n    }\n  );\n\n  // Scroll automático al final\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [comments]);\n\n  // WebSocket para comentarios en tiempo real\n  useEffect(() => {\n    if (socket && socket.on) {\n      const handleNewComment = (data) => {\n        if (data.company_id === companyId) {\n          queryClient.invalidateQueries(['client-comments', companyId]);\n        }\n      };\n\n      socket.on('new_client_comment', handleNewComment);\n\n      return () => {\n        socket.off('new_client_comment', handleNewComment);\n      };\n    }\n  }, [socket, companyId, queryClient]);\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    if (newComment.trim() && !createCommentMutation.isLoading) {\n      createCommentMutation.mutate({ companyId, comment: newComment.trim() });\n    }\n  };\n\n  const formatDate = (dateString) => {\n    const date = new Date(dateString);\n    const now = new Date();\n    const diffInHours = (now - date) / (1000 * 60 * 60);\n\n    if (diffInHours < 1) {\n      return 'Hace unos minutos';\n    } else if (diffInHours < 24) {\n      return `Hace ${Math.floor(diffInHours)} horas`;\n    } else if (diffInHours < 48) {\n      return 'Ayer';\n    } else {\n      return date.toLocaleDateString('es-ES', {\n        day: '2-digit',\n        month: '2-digit',\n        year: 'numeric',\n        hour: '2-digit',\n        minute: '2-digit'\n      });\n    }\n  };\n\n  const getInitials = (name, apellido) => {\n    const firstInitial = name ? name.charAt(0).toUpperCase() : 'U';\n    const lastInitial = apellido ? apellido.charAt(0).toUpperCase() : '';\n    return firstInitial + lastInitial;\n  };\n\n  const getRoleColor = (role) => {\n    switch (role) {\n      case 'admin':\n        return '#dc3545';\n      case 'comercial':\n        return '#28a745';\n      case 'vendedor':\n        return '#007bff';\n      case 'soporte':\n        return '#ffc107';\n      default:\n        return '#6c757d';\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"client-chat-container\">\n        <div className=\"chat-header\">\n          <FiMessageSquare className=\"chat-icon\" />\n          <h3>Comentarios del Cliente</h3>\n        </div>\n        <div className=\"chat-loading\">\n          <div className=\"spinner\"></div>\n          <p>Cargando comentarios...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"client-chat-container\">\n      <div className=\"chat-header\">\n        <FiMessageSquare className=\"chat-icon\" />\n        <h3>Comentarios del Cliente</h3>\n        <span className=\"comment-count\">{comments.length} comentarios</span>\n      </div>\n\n      <div className=\"chat-messages\">\n        {comments.length === 0 ? (\n          <div className=\"no-comments\">\n            <FiMessageSquare className=\"no-comments-icon\" />\n            <p>No hay comentarios aún</p>\n            <small>Sé el primero en comentar sobre este cliente</small>\n          </div>\n        ) : (\n          comments.map((comment) => (\n            <div\n              key={comment.id}\n              className={`message ${comment.user_id === user.id ? 'own-message' : 'other-message'}`}\n            >\n              <div className=\"message-avatar\">\n                {comment.user_name ? (\n                  <div\n                    className=\"avatar-circle\"\n                    style={{ backgroundColor: getRoleColor(comment.user_role) }}\n                  >\n                    {getInitials(comment.user_name, comment.user_apellido)}\n                  </div>\n                ) : (\n                  <FiUser className=\"avatar-icon\" />\n                )}\n              </div>\n              \n              <div className=\"message-content\">\n                <div className=\"message-header\">\n                  <span className=\"user-name\">\n                    {comment.user_name && comment.user_apellido\n                      ? `${comment.user_name} ${comment.user_apellido}`\n                      : comment.user_name || 'Usuario'}\n                  </span>\n                  <span className=\"user-role\" style={{ color: getRoleColor(comment.user_role) }}>\n                    {comment.user_role}\n                  </span>\n                  <span className=\"message-time\">\n                    <FiClock className=\"time-icon\" />\n                    {formatDate(comment.created_at)}\n                  </span>\n                </div>\n                \n                <div className=\"message-text\">\n                  {comment.comment}\n                </div>\n                \n                {comment.is_system && (\n                  <div className=\"system-message-badge\">\n                    <FiCheck className=\"system-icon\" />\n                    Mensaje del sistema\n                  </div>\n                )}\n              </div>\n            </div>\n          ))\n        )}\n        <div ref={messagesEndRef} />\n      </div>\n\n      <form className=\"chat-input-form\" onSubmit={handleSubmit}>\n        <div className=\"input-group\">\n          <textarea\n            value={newComment}\n            onChange={(e) => setNewComment(e.target.value)}\n            placeholder=\"Escribe un comentario sobre este cliente...\"\n            className=\"comment-input\"\n            rows=\"2\"\n            disabled={createCommentMutation.isLoading}\n          />\n          <button\n            type=\"submit\"\n            className=\"send-button\"\n            disabled={!newComment.trim() || createCommentMutation.isLoading}\n          >\n            <FiSend className=\"send-icon\" />\n          </button>\n        </div>\n        {createCommentMutation.isLoading && (\n          <div className=\"sending-indicator\">\n            <div className=\"spinner small\"></div>\n            <span>Enviando...</span>\n          </div>\n        )}\n      </form>\n    </div>\n  );\n};\n\nexport default ClientChat;\n","import React from 'react';\r\nimport { Modal, Tab, Tabs, Table, Badge, Row, Col, Card } from 'react-bootstrap';\r\nimport { useQuery } from 'react-query';\r\nimport { getClientHistory } from '../services/companies';\r\nimport ClientChat from './ClientChat';\r\nimport { \r\n  FiFileText, FiHome, FiUser, FiCalendar, \r\n  FiDollarSign, FiTrendingUp, FiCheckCircle, FiX,\r\n  FiClock, FiSend, FiMessageSquare, FiSearch, FiActivity\r\n} from 'react-icons/fi';\r\n\r\nconst STATUS_CONFIG = {\r\n  // Estados de cotizaciones\r\n  'nuevo': { label: 'Nuevo', variant: 'primary', icon: FiClock },\r\n  'cotizacion_enviada': { label: 'Cotización Enviada', variant: 'info', icon: FiSend },\r\n  'pendiente_cotizacion': { label: 'Pendiente de Cotización', variant: 'warning', icon: FiClock },\r\n  'en_negociacion': { label: 'En Negociación', variant: 'secondary', icon: FiMessageSquare },\r\n  'seguimiento': { label: 'Seguimiento', variant: 'info', icon: FiTrendingUp },\r\n  'ganado': { label: 'Ganado', variant: 'success', icon: FiCheckCircle },\r\n  'perdido': { label: 'Perdido', variant: 'danger', icon: FiX },\r\n  \r\n  // Estados de proyectos\r\n  'activo': { label: 'Activo', variant: 'success', icon: FiCheckCircle },\r\n  'completado': { label: 'Completado', variant: 'primary', icon: FiCheckCircle },\r\n  'pausado': { label: 'Pausado', variant: 'warning', icon: FiClock },\r\n  'cancelado': { label: 'Cancelado', variant: 'danger', icon: FiX },\r\n};\r\n\r\nconst ClientHistoryModal = ({ show, onHide, clientId, clientName }) => {\r\n  const { data: historyData, isLoading, error } = useQuery(\r\n    ['clientHistory', clientId],\r\n    () => getClientHistory(clientId),\r\n    {\r\n      enabled: show && !!clientId,\r\n      staleTime: 5 * 60 * 1000, // 5 minutos\r\n    }\r\n  );\r\n\r\n  const getStatusBadge = (status, type = 'quote') => {\r\n    const config = STATUS_CONFIG[status] || { label: status, variant: 'secondary', icon: FiFileText };\r\n    const Icon = config.icon;\r\n    \r\n    return (\r\n      <Badge bg={config.variant} className=\"d-flex align-items-center gap-1\">\r\n        <Icon size={12} />\r\n        {config.label}\r\n      </Badge>\r\n    );\r\n  };\r\n\r\n  const formatDate = (dateString) => {\r\n    return new Date(dateString).toLocaleDateString('es-ES', {\r\n      year: 'numeric',\r\n      month: 'short',\r\n      day: 'numeric'\r\n    });\r\n  };\r\n\r\n  const formatCurrency = (amount) => {\r\n    return new Intl.NumberFormat('es-PE', {\r\n      style: 'currency',\r\n      currency: 'PEN'\r\n    }).format(amount);\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <Modal show={show} onHide={onHide} size=\"xl\">\r\n        <Modal.Header closeButton>\r\n          <Modal.Title>Historial de {clientName}</Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body className=\"text-center\">\r\n          <div className=\"spinner-border\" role=\"status\">\r\n            <span className=\"visually-hidden\">Cargando...</span>\r\n          </div>\r\n        </Modal.Body>\r\n      </Modal>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <Modal show={show} onHide={onHide} size=\"xl\">\r\n        <Modal.Header closeButton>\r\n          <Modal.Title>Historial de {clientName}</Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body>\r\n          <div className=\"alert alert-danger\">\r\n            Error al cargar el historial: {error.message}\r\n          </div>\r\n        </Modal.Body>\r\n      </Modal>\r\n    );\r\n  }\r\n\r\n  const history = historyData?.data || { quotes: [], projects: [], manager: null, stats: {} };\r\n\r\n  return (\r\n    <Modal show={show} onHide={onHide} size=\"xl\">\r\n      <Modal.Header closeButton>\r\n        <Modal.Title>\r\n          <FiActivity className=\"me-2\" />\r\n          Historial de {clientName}\r\n        </Modal.Title>\r\n      </Modal.Header>\r\n      <Modal.Body>\r\n        {/* Información del gestor */}\r\n        {history.manager && (\r\n          <Card className=\"mb-4\">\r\n            <Card.Body>\r\n              <Row>\r\n                <Col md={6}>\r\n                  <h6><FiUser className=\"me-2\" />Gestor Actual</h6>\r\n                  <p className=\"mb-1\"><strong>{history.manager.name}</strong></p>\r\n                  <p className=\"mb-1 text-muted\">{history.manager.role}</p>\r\n                  <p className=\"mb-0 text-muted\">{history.manager.email}</p>\r\n                </Col>\r\n                <Col md={6}>\r\n                  <h6>Estadísticas</h6>\r\n                  <Row>\r\n                    <Col xs={6}>\r\n                      <div className=\"text-center\">\r\n                        <h4 className=\"text-primary mb-0\">{history.stats.totalQuotes}</h4>\r\n                        <small className=\"text-muted\">Cotizaciones</small>\r\n                      </div>\r\n                    </Col>\r\n                    <Col xs={6}>\r\n                      <div className=\"text-center\">\r\n                        <h4 className=\"text-success mb-0\">{history.stats.totalProjects}</h4>\r\n                        <small className=\"text-muted\">Proyectos</small>\r\n                      </div>\r\n                    </Col>\r\n                  </Row>\r\n                </Col>\r\n              </Row>\r\n            </Card.Body>\r\n          </Card>\r\n        )}\r\n\r\n        <Tabs defaultActiveKey=\"quotes\" className=\"mb-3\">\r\n          {/* Tab de Cotizaciones */}\r\n          <Tab eventKey=\"quotes\" title={\r\n            <span>\r\n              <FiFileText className=\"me-1\" />\r\n              Cotizaciones ({history.quotes.length})\r\n            </span>\r\n          }>\r\n            {history.quotes.length > 0 ? (\r\n              <Table responsive striped hover>\r\n                <thead>\r\n                  <tr>\r\n                    <th>ID</th>\r\n                    <th>Total</th>\r\n                    <th>Estado</th>\r\n                    <th>Creado por</th>\r\n                    <th>Fecha Creación</th>\r\n                    <th>Última Actualización</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {history.quotes.map((quote) => (\r\n                    <tr key={quote.id}>\r\n                      <td>\r\n                        <strong>#{quote.id}</strong>\r\n                      </td>\r\n                      <td>\r\n                        <FiDollarSign className=\"me-1\" />\r\n                        {formatCurrency(quote.total)}\r\n                      </td>\r\n                      <td>\r\n                        {getStatusBadge(quote.status, 'quote')}\r\n                      </td>\r\n                      <td>\r\n                        <div>\r\n                          <div>{quote.created_by_name}</div>\r\n                          <small className=\"text-muted\">{quote.created_by_role}</small>\r\n                        </div>\r\n                      </td>\r\n                      <td>\r\n                        <FiCalendar className=\"me-1\" />\r\n                        {formatDate(quote.created_at)}\r\n                      </td>\r\n                      <td>\r\n                        <FiCalendar className=\"me-1\" />\r\n                        {formatDate(quote.updated_at)}\r\n                      </td>\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n              </Table>\r\n            ) : (\r\n              <div className=\"text-center py-4\">\r\n                <FiFileText size={48} className=\"text-muted mb-3\" />\r\n                <p className=\"text-muted\">No hay cotizaciones registradas para este cliente</p>\r\n              </div>\r\n            )}\r\n          </Tab>\r\n\r\n          {/* Tab de Proyectos */}\r\n          <Tab eventKey=\"projects\" title={\r\n            <span>\r\n              <FiHome className=\"me-1\" />\r\n              Proyectos ({history.projects.length})\r\n            </span>\r\n          }>\r\n            {history.projects.length > 0 ? (\r\n              <Table responsive striped hover>\r\n                <thead>\r\n                  <tr>\r\n                    <th>ID</th>\r\n                    <th>Nombre</th>\r\n                    <th>Estado</th>\r\n                    <th>Creado por</th>\r\n                    <th>Fecha Creación</th>\r\n                    <th>Última Actualización</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {history.projects.map((project) => (\r\n                    <tr key={project.id}>\r\n                      <td>\r\n                        <strong>#{project.id}</strong>\r\n                      </td>\r\n                      <td>\r\n                        <FiHome className=\"me-1\" />\r\n                        {project.name}\r\n                      </td>\r\n                      <td>\r\n                        {getStatusBadge(project.status, 'project')}\r\n                      </td>\r\n                      <td>\r\n                        <div>\r\n                          <div>{project.created_by_name}</div>\r\n                          <small className=\"text-muted\">{project.created_by_role}</small>\r\n                        </div>\r\n                      </td>\r\n                      <td>\r\n                        <FiCalendar className=\"me-1\" />\r\n                        {formatDate(project.created_at)}\r\n                      </td>\r\n                      <td>\r\n                        <FiCalendar className=\"me-1\" />\r\n                        {formatDate(project.updated_at)}\r\n                      </td>\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n              </Table>\r\n            ) : (\r\n              <div className=\"text-center py-4\">\r\n                <FiHome size={48} className=\"text-muted mb-3\" />\r\n                <p className=\"text-muted\">No hay proyectos registrados para este cliente</p>\r\n              </div>\r\n            )}\r\n          </Tab>\r\n\r\n          {/* Tab de Comentarios */}\r\n          <Tab eventKey=\"comments\" title={\r\n            <span>\r\n              <FiMessageSquare className=\"me-1\" />\r\n              Comentarios\r\n            </span>\r\n          }>\r\n            <ClientChat companyId={clientId} />\r\n          </Tab>\r\n        </Tabs>\r\n      </Modal.Body>\r\n      <Modal.Footer>\r\n        <button type=\"button\" className=\"btn btn-secondary\" onClick={onHide}>\r\n          Cerrar\r\n        </button>\r\n      </Modal.Footer>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default ClientHistoryModal;\r\n","import React, { useState, useMemo } from 'react';\nimport { useQuery, useMutation, useQueryClient } from 'react-query';\nimport { useNavigate } from 'react-router-dom';\nimport { Button, Badge, Row, Col, Card, Container } from 'react-bootstrap';\nimport { FiPlus, FiEdit, FiTrash2, FiUser, FiHome, FiMail, FiPhone, FiMapPin, FiUsers, FiHome as FiBuilding, FiFolderPlus, FiClock, FiUserCheck, FiUpload } from 'react-icons/fi';\nimport PageHeader from '../components/common/PageHeader';\nimport DataTable from '../components/common/DataTable';\nimport ModalForm from '../components/common/ModalForm';\nimport ClientFormRedesigned from '../components/ClientFormRedesigned';\nimport StatsCard from '../components/common/StatsCard';\nimport ConfirmModal from '../components/common/ConfirmModal';\nimport PermissionDeniedModal from '../components/common/PermissionDeniedModal';\nimport ClientStatusDropdown from '../components/ClientStatusDropdown';\nimport ClientHistoryModal from '../components/ClientHistoryModal';\nimport { listCompanies, createCompany, updateCompany, deleteCompany, getCompanyStats, getCompanyFilterOptions } from '../services/companies';\nimport { getCurrentUser, canCreateClient, canEditClient, canDeleteClient, canViewClientHistory, canCreateProject, logUserInfo } from '../utils/authHelper';\nimport './Clientes.css';\n\nconst emptyForm = {\n  id: null,\n  type: 'empresa',\n  ruc: '',\n  dni: '',\n  name: '',\n  address: '',\n  email: '',\n  phone: '',\n  contact_name: '',\n  city: '',\n  sector: '',\n};\n\nexport default function Clientes() {\n  const [showModal, setShowModal] = useState(false);\n  const [editingClient, setEditingClient] = useState(null);\n  const [deletingClient, setDeletingClient] = useState(null);\n  const [showHistoryModal, setShowHistoryModal] = useState(false);\n  const [selectedClientForHistory, setSelectedClientForHistory] = useState(null);\n  const [showPermissionDeniedModal, setShowPermissionDeniedModal] = useState(false);\n  const [permissionDeniedInfo, setPermissionDeniedInfo] = useState({});\n  \n  // Información del usuario actual\n  const currentUser = getCurrentUser();\n  const userCanCreateClient = canCreateClient();\n  const userCanEditClient = canEditClient();\n  const userCanDeleteClient = canDeleteClient();\n  const userCanViewClientHistory = canViewClientHistory();\n  const userCanCreateProject = canCreateProject();\n  \n  // Log de información de usuario al cargar el componente\n  React.useEffect(() => {\n    logUserInfo();\n  }, []);\n  \n  // Estado para paginación y filtros\n  const [currentPage, setCurrentPage] = useState(1);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [selectedType, setSelectedType] = useState('');\n  const [selectedCity, setSelectedCity] = useState('');\n  const [selectedSector, setSelectedSector] = useState('');\n  const [isSearching, setIsSearching] = useState(false);\n\n  const queryClient = useQueryClient();\n  const navigate = useNavigate();\n\n  const { data, isLoading, refetch } = useQuery(\n    ['clients', currentPage, searchTerm, selectedType, selectedCity, selectedSector],\n    () => listCompanies({ \n      page: currentPage, \n      limit: 20, \n      search: searchTerm, \n      type: selectedType,\n      city: selectedCity,\n      sector: selectedSector\n    }),\n    { \n      keepPreviousData: true,\n      refetchOnWindowFocus: true,\n      refetchOnMount: true,\n      staleTime: 0,\n      cacheTime: 0\n    }\n  );\n\n  // Consulta separada para estadísticas reales\n  const { data: statsData, isLoading: statsLoading, error: statsError } = useQuery(\n    ['clientStats'],\n    getCompanyStats,\n    {\n      refetchOnWindowFocus: true,\n      refetchOnMount: true,\n      staleTime: 30000, // 30 segundos\n      cacheTime: 60000  // 1 minuto\n    }\n  );\n\n  // Debug: Log de estadísticas (simplificado)\n  React.useEffect(() => {\n    if (statsData && statsData.data) {\n      console.log('✅ Estadísticas cargadas correctamente:', {\n        total: statsData.data.total,\n        empresas: statsData.data.empresas,\n        personas: statsData.data.personas\n      });\n    }\n  }, [statsData]);\n\n  // Consulta para opciones de filtros dinámicos\n  const { data: filterOptionsData, isLoading: filterOptionsLoading } = useQuery(\n    ['clientFilterOptions'],\n    getCompanyFilterOptions,\n    {\n      refetchOnWindowFocus: true,\n      refetchOnMount: true,\n      staleTime: 60000, // 1 minuto\n      cacheTime: 300000  // 5 minutos\n    }\n  );\n\n  const handleMutationSuccess = (message) => {\n    queryClient.invalidateQueries('clients');\n    queryClient.invalidateQueries('clientStats'); // Invalidar también las estadísticas\n    queryClient.invalidateQueries('clientFilterOptions'); // Invalidar también las opciones de filtros\n    setShowModal(false);\n    setEditingClient(null);\n    setDeletingClient(null);\n  };\n\n  // Función para manejar búsqueda\n  const handleSearch = (searchValue) => {\n    console.log('🔍 handleSearch - Búsqueda:', searchValue);\n    setSearchTerm(searchValue);\n    setCurrentPage(1); // Resetear a la primera página\n    setIsSearching(true);\n    \n    // La consulta se actualizará automáticamente por el useQuery\n    setTimeout(() => setIsSearching(false), 1000);\n  };\n\n  // Función para manejar filtros\n  const handleFilter = (filters) => {\n    console.log('🔍 handleFilter - Filtros:', filters);\n    setSelectedType(filters.type || '');\n    setSelectedCity(filters.city || '');\n    setSelectedSector(filters.sector || '');\n    setCurrentPage(1); // Resetear a la primera página\n  };\n\n  // Opciones de filtros dinámicas basadas en datos reales\n  const clientFilterOptions = useMemo(() => {\n    if (!filterOptionsData) {\n      return [\n        {\n          title: 'Por Tipo de Cliente',\n          options: [\n            { label: 'Empresas', filter: { type: 'empresa' } },\n            { label: 'Personas Naturales', filter: { type: 'persona' } }\n          ]\n        }\n      ];\n    }\n\n    return [\n      {\n        title: 'Por Tipo de Cliente',\n        options: filterOptionsData.types?.map(type => ({\n          label: `${type.label} (${type.count})`,\n          filter: { type: type.value }\n        })) || []\n      },\n      {\n        title: 'Por Sector',\n        options: filterOptionsData.sectors?.map(sector => ({\n          label: `${sector.label} (${sector.count})`,\n          filter: { sector: sector.value }\n        })) || []\n      },\n      {\n        title: 'Por Ciudad',\n        options: filterOptionsData.cities?.map(city => ({\n          label: `${city.label} (${city.count})`,\n          filter: { city: city.value }\n        })) || []\n      }\n    ];\n  }, [filterOptionsData]);\n\n  const createMutation = useMutation(createCompany, {\n    onSuccess: () => handleMutationSuccess('Cliente creado exitosamente'),\n    onError: (error) => {\n      console.error('Error creating client:', error);\n      console.error('Error details:', {\n        message: error.message,\n        status: error.status,\n        body: error.body\n      });\n    }\n  });\n\n  const updateMutation = useMutation(updateCompany, {\n    onSuccess: () => handleMutationSuccess('Cliente actualizado exitosamente'),\n    onError: (error) => console.error('Error updating client:', error)\n  });\n\n  const deleteMutation = useMutation(deleteCompany, {\n    onSuccess: () => handleMutationSuccess('Cliente eliminado exitosamente'),\n    onError: (error) => console.error('Error deleting client:', error)\n  });\n\n  const handleCreate = () => {\n    if (!userCanCreateClient) {\n      setPermissionDeniedInfo({\n        action: \"crear clientes\",\n        requiredRole: \"administrador, jefe comercial o vendedor comercial\",\n        currentRole: currentUser?.role || \"no autenticado\"\n      });\n      setShowPermissionDeniedModal(true);\n      return;\n    }\n    setEditingClient(emptyForm);\n    setShowModal(true);\n  };\n\n  const handleEdit = (client) => {\n    if (!userCanEditClient) {\n      setPermissionDeniedInfo({\n        action: \"editar clientes\",\n        requiredRole: \"administrador, jefe comercial o vendedor comercial\",\n        currentRole: currentUser?.role || \"no autenticado\"\n      });\n      setShowPermissionDeniedModal(true);\n      return;\n    }\n    setEditingClient(client);\n    setShowModal(true);\n  };\n\n  const handleDelete = (client) => {\n    console.log('🔍 handleDelete - Verificando permisos:', {\n      userCanDeleteClient,\n      currentUserRole: currentUser?.role,\n      currentUser: currentUser\n    });\n    \n    if (!userCanDeleteClient) {\n      console.log('🚫 handleDelete - Permisos insuficientes, mostrando modal');\n      setPermissionDeniedInfo({\n        action: \"eliminar clientes\",\n        requiredRole: \"administrador\",\n        currentRole: currentUser?.role || \"no autenticado\"\n      });\n      setShowPermissionDeniedModal(true);\n      return;\n    }\n    console.log('✅ handleDelete - Permisos OK, procediendo con eliminación');\n    setDeletingClient(client);\n  };\n\n  const confirmDelete = async () => {\n    try {\n      await deleteMutation.mutateAsync(deletingClient.id);\n      setDeletingClient(null);\n    } catch (error) {\n      console.error('Error eliminando cliente:', error);\n      setDeletingClient(null);\n    }\n  };\n\n  const handleCreateProject = (client) => {\n    if (!userCanCreateProject) {\n      setPermissionDeniedInfo({\n        action: \"crear cotizaciones\",\n        requiredRole: \"administrador, jefe comercial o vendedor comercial\",\n        currentRole: currentUser?.role || \"no autenticado\"\n      });\n      setShowPermissionDeniedModal(true);\n      return;\n    }\n    // Navegar a cotización inteligente con el cliente pre-seleccionado\n    navigate('/cotizaciones/inteligente', { \n      state: { \n        selectedClient: {\n          id: client.id,\n          name: client.name,\n          type: client.type,\n          sector: client.sector,\n          city: client.city,\n          ruc: client.ruc,\n          dni: client.dni,\n          email: client.email,\n          phone: client.phone,\n          contact_name: client.contact_name,\n          address: client.address\n        }\n      } \n    });\n  };\n\n  const handleShowHistory = (client) => {\n    if (!userCanViewClientHistory) {\n      setPermissionDeniedInfo({\n        action: \"ver historial de clientes\",\n        requiredRole: \"administrador, jefe comercial o vendedor comercial\",\n        currentRole: currentUser?.role || \"no autenticado\"\n      });\n      setShowPermissionDeniedModal(true);\n      return;\n    }\n    setSelectedClientForHistory(client);\n    setShowHistoryModal(true);\n  };\n\n  const handleStatusChange = (clientId, newStatus) => {\n    // La actualización se maneja automáticamente por react-query\n    console.log(`Estado del cliente ${clientId} cambiado a: ${newStatus}`);\n  };\n\n  const handleSubmit = async (formData) => {\n    if (editingClient.id) {\n      await updateMutation.mutateAsync({ id: editingClient.id, ...formData });\n    } else {\n      await createMutation.mutateAsync(formData);\n    }\n  };\n\n  const getTypeBadge = (type) => {\n    const typeConfig = {\n      'empresa': { bg: 'primary', text: 'Empresa', icon: FiHome },\n      'persona': { bg: 'info', text: 'Persona Natural', icon: FiUser }\n    };\n    \n    const config = typeConfig[type] || { bg: 'secondary', text: type, icon: FiUser };\n    const Icon = config.icon;\n    \n    return (\n      <Badge bg={config.bg} className=\"status-badge d-flex align-items-center\">\n        <Icon size={12} className=\"me-1\" />\n        {config.text}\n      </Badge>\n    );\n  };\n\n  const columns = [\n    {\n      header: 'ID',\n      accessor: 'id',\n      width: '50px'\n    },\n    {\n      header: 'Cliente',\n      accessor: 'name',\n      width: '180px',\n      render: (value, row) => (\n        <div>\n          <div className=\"fw-medium\" style={{fontSize: '0.8rem'}}>{row.name}</div>\n          <div className=\"d-flex align-items-center gap-1 mt-1\">\n            {getTypeBadge(row.type)}\n            {row.ruc && (\n              <small className=\"text-muted\" style={{fontSize: '0.7rem'}}>RUC: {row.ruc}</small>\n            )}\n            {row.dni && (\n              <small className=\"text-muted\" style={{fontSize: '0.7rem'}}>DNI: {row.dni}</small>\n            )}\n          </div>\n        </div>\n      )\n    },\n    {\n      header: 'Contacto',\n      accessor: 'contact',\n      width: '150px',\n      render: (value, row) => (\n        <div>\n          {row.contact_name && (\n            <div className=\"fw-medium\" style={{fontSize: '0.8rem'}}>{row.contact_name}</div>\n          )}\n          {row.email && (\n            <div className=\"d-flex align-items-center mt-1\">\n              <FiMail size={10} className=\"me-1 text-muted\" />\n              <small className=\"text-muted\" style={{fontSize: '0.7rem'}}>{row.email}</small>\n            </div>\n          )}\n          {row.phone && (\n            <div className=\"d-flex align-items-center mt-1\">\n              <FiPhone size={10} className=\"me-1 text-muted\" />\n              <small className=\"text-muted\" style={{fontSize: '0.7rem'}}>{row.phone}</small>\n            </div>\n          )}\n        </div>\n      )\n    },\n    {\n      header: 'Ciudad',\n      accessor: 'city',\n      width: '80px',\n      render: (value) => {\n        const city = value || 'No especificada';\n        let cityColor = 'secondary';\n        \n        // Asignar colores según la ciudad\n        switch (city) {\n          case 'Lima':\n            cityColor = 'primary';\n            break;\n          case 'Arequipa':\n            cityColor = 'info';\n            break;\n          case 'Cusco':\n            cityColor = 'success';\n            break;\n          case 'Trujillo':\n            cityColor = 'warning';\n            break;\n          case 'Piura':\n            cityColor = 'danger';\n            break;\n          case 'Chiclayo':\n            cityColor = 'info';\n            break;\n          case 'Iquitos':\n            cityColor = 'success';\n            break;\n          case 'Huancayo':\n            cityColor = 'warning';\n            break;\n          default:\n            cityColor = 'secondary';\n        }\n        \n        return (\n          <Badge bg={cityColor} className=\"px-1 py-0\" style={{fontSize: '0.65rem'}}>\n            {city}\n          </Badge>\n        );\n      }\n    },\n    {\n      header: 'Sector',\n      accessor: 'sector',\n      width: '80px',\n      render: (value) => {\n        // Limpiar sector para mostrar solo el sector base\n        const cleanSector = (sector) => {\n          if (!sector) return 'General';\n          // Remover la información de prioridad\n          return sector.replace(/\\s*\\[PRIORIDAD:\\s*\\w+\\]/g, '').trim() || 'General';\n        };\n        \n        const sector = cleanSector(value);\n        let sectorColor = 'secondary';\n        \n        // Asignar colores según el sector\n        switch (sector) {\n          case 'Construcción':\n            sectorColor = 'warning';\n            break;\n          case 'Minería':\n            sectorColor = 'dark';\n            break;\n          case 'Ingeniería':\n            sectorColor = 'primary';\n            break;\n          case 'Laboratorio':\n            sectorColor = 'info';\n            break;\n          case 'Consultoría':\n            sectorColor = 'success';\n            break;\n          case 'Tecnología':\n            sectorColor = 'primary';\n            break;\n          case 'Ambiental':\n            sectorColor = 'success';\n            break;\n          case 'Geología':\n            sectorColor = 'info';\n            break;\n          default:\n            sectorColor = 'secondary';\n        }\n        \n        return (\n          <Badge bg={sectorColor} className=\"px-1 py-0\" style={{fontSize: '0.65rem'}}>\n            {sector}\n          </Badge>\n        );\n      }\n    },\n    {\n      header: 'Estado',\n      accessor: 'status',\n      width: '120px',\n      render: (value, row) => (\n        <ClientStatusDropdown\n          clientId={row.id}\n          currentStatus={row.status || 'prospeccion'}\n          onStatusChange={(newStatus) => handleStatusChange(row.id, newStatus)}\n          size=\"sm\"\n          showLabel={true}\n        />\n      )\n    },\n    {\n      header: 'Prioridad',\n      accessor: 'priority',\n      width: '100px',\n      render: (value, row) => {\n        // Extraer prioridad del campo sector\n        const extractPriority = (sector) => {\n          if (!sector) return 'normal';\n          \n          if (sector.includes('[PRIORIDAD: URGENTE]')) return 'urgent';\n          if (sector.includes('[PRIORIDAD: ALTA]')) return 'high';\n          if (sector.includes('[PRIORIDAD: BAJA]')) return 'low';\n          \n          return 'normal';\n        };\n        \n        const priority = extractPriority(row.sector);\n        let priorityColor = 'secondary';\n        let priorityText = 'Normal';\n        \n        switch (priority) {\n          case 'urgent':\n            priorityColor = 'danger';\n            priorityText = 'Urgente';\n            break;\n          case 'high':\n            priorityColor = 'warning';\n            priorityText = 'Alta';\n            break;\n          case 'normal':\n            priorityColor = 'info';\n            priorityText = 'Normal';\n            break;\n          case 'low':\n            priorityColor = 'secondary';\n            priorityText = 'Baja';\n            break;\n        }\n        \n        return (\n          <Badge bg={priorityColor} className=\"px-2 py-1\" style={{fontSize: '0.7rem'}}>\n            {priorityText}\n          </Badge>\n        );\n      }\n    },\n    {\n      header: 'Gestor',\n      accessor: 'managed_by',\n      width: '100px',\n      render: (value, row) => (\n        <div className=\"d-flex align-items-center\">\n          {row.managed_by_name ? (\n            <>\n              <FiUserCheck size={12} className=\"me-1 text-success\" />\n              <div>\n                <div className=\"fw-medium\" style={{fontSize: '0.8rem'}}>{row.managed_by_name}</div>\n                <small className=\"text-muted\" style={{fontSize: '0.7rem'}}>{row.managed_by_role}</small>\n              </div>\n            </>\n          ) : (\n            <span className=\"text-muted\" style={{fontSize: '0.8rem'}}>Sin asignar</span>\n          )}\n        </div>\n      )\n    },\n    {\n      header: 'Dirección',\n      accessor: 'address',\n      width: '120px',\n      render: (value) => (\n        value ? (\n          <div className=\"d-flex align-items-center\">\n            <FiMapPin size={12} className=\"me-1 text-muted\" />\n            <small className=\"text-muted\">{value}</small>\n          </div>\n        ) : (\n          <small className=\"text-muted\">Sin dirección</small>\n        )\n      )\n    }, \n    {\n      header: 'Fecha Registro',\n      accessor: 'created_at',\n      type: 'date'\n    },\n    {\n      header: 'Acciones',\n      accessor: 'actions',\n      render: (value, row) => (\n        <div className=\"d-flex gap-1\">\n          {userCanEditClient && (\n            <Button\n              variant=\"outline-primary\"\n              size=\"sm\"\n              onClick={() => handleEdit(row)}\n              title=\"Editar cliente\"\n            >\n              <FiEdit size={14} />\n            </Button>\n          )}\n          {userCanViewClientHistory && (\n            <Button\n              variant=\"outline-info\"\n              size=\"sm\"\n              onClick={() => handleShowHistory(row)}\n              title=\"Ver historial de cotizaciones y proyectos\"\n            >\n              <FiClock size={14} />\n            </Button>\n          )}\n          {userCanCreateProject && (\n            <Button\n              variant=\"outline-success\"\n              size=\"sm\"\n              onClick={() => handleCreateProject(row)}\n              title=\"Crear cotización para este cliente\"\n            >\n              <FiFolderPlus size={14} />\n            </Button>\n          )}\n          {userCanDeleteClient && (\n            <Button\n              variant=\"outline-danger\"\n              size=\"sm\"\n              onClick={() => handleDelete(row)}\n              title=\"Eliminar cliente\"\n            >\n              <FiTrash2 size={14} />\n            </Button>\n          )}\n          {!userCanDeleteClient && (\n            <Button\n              variant=\"outline-secondary\"\n              size=\"sm\"\n              onClick={() => {\n                console.log('🚫 Botón eliminar clickeado sin permisos');\n                setPermissionDeniedInfo({\n                  action: \"eliminar clientes\",\n                  requiredRole: \"administrador\",\n                  currentRole: currentUser?.role || \"no autenticado\"\n                });\n                setShowPermissionDeniedModal(true);\n              }}\n              title=\"No tienes permisos para eliminar clientes\"\n            >\n              <FiTrash2 size={14} />\n            </Button>\n          )}\n        </div>\n      )\n    }\n  ];\n\n  const formFields = [\n    {\n      name: 'type',\n      label: 'Tipo de Cliente',\n      type: 'select',\n      required: true,\n      options: [\n        { value: 'empresa', label: 'Empresa' },\n        { value: 'persona', label: 'Persona Natural' }\n      ]\n    },\n    {\n      name: 'name',\n      label: 'Nombre/Razón Social',\n      type: 'text',\n      required: true,\n      placeholder: 'Ingresa el nombre o razón social'\n    },\n    {\n      name: 'ruc',\n      label: 'RUC',\n      type: 'text',\n      placeholder: 'Ingresa el RUC (solo para empresas)',\n      help: 'Solo para empresas'\n    },\n    {\n      name: 'dni',\n      label: 'DNI',\n      type: 'text',\n      placeholder: 'Ingresa el DNI (solo para personas)',\n      help: 'Solo para personas naturales'\n    },\n    {\n      name: 'contact_name',\n      label: 'Nombre de Contacto',\n      type: 'text',\n      placeholder: 'Ingresa el nombre del contacto'\n    },\n    {\n      name: 'email',\n      label: 'Email',\n      type: 'email',\n      placeholder: 'contacto@empresa.com'\n    },\n    {\n      name: 'phone',\n      label: 'Teléfono',\n      type: 'text',\n      placeholder: '+51 999 999 999'\n    },\n    {\n      name: 'address',\n      label: 'Dirección',\n      type: 'textarea',\n      placeholder: 'Ingresa la dirección completa'\n    },\n    {\n      name: 'city',\n      label: 'Ciudad',\n      type: 'text',\n      placeholder: 'Escribe la ciudad (ej: Lima, Arequipa, Cusco...)',\n      autocomplete: true,\n      suggestions: [\n        'Lima', 'Arequipa', 'Cusco', 'Trujillo', 'Piura', 'Chiclayo', 'Iquitos', 'Huancayo',\n        'Tacna', 'Cajamarca', 'Ayacucho', 'Puno', 'Juliaca', 'Chimbote', 'Huaraz', 'Abancay',\n        'Andahuaylas', 'Tumbes', 'Pucallpa', 'Tarapoto', 'Moyobamba', 'Cerro de Pasco', 'Huánuco',\n        'Ica', 'Nazca', 'Chincha', 'Cañete', 'Barranca', 'Huaral', 'Callao', 'Ventanilla',\n        'San Juan de Miraflores', 'Villa El Salvador', 'San Martín de Porres', 'Comas',\n        'Los Olivos', 'San Miguel', 'Pueblo Libre', 'Jesús María', 'Magdalena', 'San Isidro',\n        'Miraflores', 'Surco', 'La Molina', 'Ate', 'Santa Anita', 'El Agustino', 'San Juan de Lurigancho',\n        'Lurigancho', 'Chosica', 'Chaclacayo', 'Cieneguilla', 'Pachacámac', 'Punta Hermosa',\n        'Punta Negra', 'San Bartolo', 'Santa María del Mar', 'Pucusana', 'Asia', 'Mala',\n        'San Vicente de Cañete', 'Imperial', 'Nuevo Imperial', 'Quilmaná', 'San Luis',\n        'San Pedro de Lloc', 'Pacasmayo', 'Guadalupe', 'Jequetepeque', 'Chepén', 'Cascas',\n        'Contumazá', 'Cupisnique', 'Guzmango', 'San Benito', 'San Diego', 'San José',\n        'San Pablo', 'Tembladera', 'Yonán', 'Zaña', 'Cajabamba', 'Cajamarca', 'Celendín',\n        'Chota', 'Contumazá', 'Cutervo', 'Hualgayoc', 'Jaén', 'San Ignacio', 'San Marcos',\n        'San Miguel', 'San Pablo', 'Santa Cruz', 'Bagua', 'Bongará', 'Condorcanqui',\n        'Luya', 'Rodríguez de Mendoza', 'Utcubamba', 'Chachapoyas', 'Asunción', 'Balsas',\n        'Cheto', 'Chiliquín', 'Chuquibamba', 'Granada', 'Huancas', 'La Jalca', 'Leimebamba',\n        'Levanto', 'Magdalena', 'Mariscal Castilla', 'Molinopampa', 'Montevideo', 'Olleros',\n        'Quinjalca', 'San Francisco de Daguas', 'San Isidro de Maino', 'Soloco', 'Sonche',\n        'Abancay', 'Andahuaylas', 'Antabamba', 'Aymaraes', 'Chincheros', 'Cotabambas',\n        'Grau', 'Huancarama', 'Huancaray', 'Huanipaca', 'Kishuara', 'Lambrama', 'Pacobamba',\n        'Pacucha', 'Pampachiri', 'Pomacocha', 'San Antonio de Cachi', 'San Jerónimo',\n        'San Miguel de Chaccrampa', 'Santa María de Chicmo', 'Talavera', 'Tamburco',\n        'Andahuaylas', 'Antabamba', 'Aymaraes', 'Chincheros', 'Cotabambas', 'Grau',\n        'Huancarama', 'Huancaray', 'Huanipaca', 'Kishuara', 'Lambrama', 'Pacobamba',\n        'Pacucha', 'Pampachiri', 'Pomacocha', 'San Antonio de Cachi', 'San Jerónimo',\n        'San Miguel de Chaccrampa', 'Santa María de Chicmo', 'Talavera', 'Tamburco'\n      ]\n    },\n    {\n      name: 'sector',\n      label: 'Sector',\n      type: 'text',\n      placeholder: 'Escribe el sector (ej: Construcción, Minería, Tecnología...)',\n      autocomplete: true,\n      suggestions: [\n        'General', 'Construcción', 'Minería', 'Ingeniería', 'Laboratorio', 'Consultoría', \n        'Tecnología', 'Ambiental', 'Geología', 'Agricultura', 'Ganadería', 'Pesca',\n        'Manufactura', 'Textil', 'Alimentario', 'Farmacéutico', 'Químico', 'Petroquímico',\n        'Energía', 'Electricidad', 'Gas', 'Agua', 'Saneamiento', 'Transporte', 'Logística',\n        'Comercio', 'Retail', 'Mayorista', 'Distribución', 'Servicios Financieros', 'Banca',\n        'Seguros', 'Inversiones', 'Bienes Raíces', 'Inmobiliaria', 'Turismo', 'Hotelería',\n        'Restaurantes', 'Entretenimiento', 'Medios', 'Comunicaciones', 'Telecomunicaciones',\n        'Software', 'Hardware', 'Sistemas', 'Internet', 'E-commerce', 'Marketing', 'Publicidad',\n        'Educación', 'Capacitación', 'Investigación', 'Desarrollo', 'Salud', 'Medicina',\n        'Farmacéutica', 'Biotecnología', 'Gobierno', 'Público', 'Defensa', 'Seguridad',\n        'Legal', 'Jurídico', 'Contable', 'Auditoría', 'Recursos Humanos', 'Administración',\n        'Gestión', 'Consultoría Empresarial', 'Outsourcing', 'Servicios Profesionales',\n        'Arquitectura', 'Diseño', 'Arte', 'Cultura', 'Deportes', 'Recreación', 'ONG',\n        'Fundaciones', 'Religioso', 'Espiritual', 'Otro'\n      ]\n    }\n  ];\n\n  // Calcular estadísticas\n  const stats = useMemo(() => {\n    // Usar estadísticas reales del backend si están disponibles\n    if (statsData && statsData.data) {\n      console.log('📊 Stats - Usando estadísticas reales del backend:', statsData);\n      console.log('📊 Stats - Datos extraídos:', statsData.data);\n      return {\n        total: statsData.data.total || 0,\n        empresas: statsData.data.empresas || 0,\n        personas: statsData.data.personas || 0,\n        conEmail: statsData.data.withEmail || 0,\n        conTelefono: statsData.data.withPhone || 0\n      };\n    }\n    \n    // Fallback: calcular desde los datos de la página actual\n    const companies = data?.data || [];\n    console.log('📊 Stats - Fallback: calculando desde página actual:', companies);\n    return {\n      total: companies.length,\n      empresas: companies.filter(c => c.type === 'empresa').length,\n      personas: companies.filter(c => c.type === 'persona').length,\n      conEmail: companies.filter(c => c.email).length,\n      conTelefono: companies.filter(c => c.phone).length\n    };\n  }, [statsData, data]);\n\n  return (\n    <div className=\"clientes-page\">\n      <Container fluid className=\"h-100 d-flex flex-column p-0\">\n        {/* Header compacto */}\n        <div className=\"d-flex justify-content-between align-items-center mb-3\">\n          <div>\n            <h4 className=\"mb-0 fw-bold\">Gestión de Clientes</h4>\n            <small className=\"text-muted\">Crear, editar y gestionar clientes del sistema</small>\n          </div>\n          <div className=\"d-flex gap-2\">\n            {currentUser?.role === 'admin' && (\n              <Button \n                variant=\"outline-success\" \n                size=\"sm\"\n                onClick={() => navigate('/clientes/importar')}\n                title=\"Importar clientes desde archivo CSV\"\n              >\n                <FiUpload className=\"me-1\" />\n                Importar Clientes\n              </Button>\n            )}\n            <Button \n              variant=\"primary\" \n              size=\"sm\"\n              onClick={handleCreate}\n              disabled={!userCanCreateClient}\n              title={!userCanCreateClient ? `No tienes permisos para crear clientes. Rol actual: ${currentUser?.role || 'No autenticado'}` : 'Crear nuevo cliente'}\n            >\n              <FiPlus className=\"me-1\" />\n              Nuevo Cliente\n            </Button>\n          </div>\n        </div>\n\n        {/* Información de depuración */}\n        {!userCanCreateClient && (\n          <div className=\"alert alert-warning py-1 mb-1\" role=\"alert\">\n            <small><strong>⚠️ Permisos insuficientes:</strong> Tu rol actual ({currentUser?.role || 'No autenticado'}) no tiene permisos para crear clientes.</small>\n          </div>\n        )}\n\n        {/* Estadísticas compactas */}\n        <Row className=\"g-2 mb-3\">\n          <Col md={6} lg={3}>\n            <StatsCard\n              title=\"Total\"\n              value={stats.total}\n              icon={FiUsers}\n              color=\"primary\"\n              loading={statsLoading}\n              size=\"compact\"\n            />\n          </Col>\n          <Col md={6} lg={3}>\n            <StatsCard\n              title=\"Empresas\"\n              value={stats.empresas}\n              icon={FiBuilding}\n              color=\"success\"\n              loading={statsLoading}\n              size=\"compact\"\n            />\n          </Col>\n          <Col md={6} lg={3}>\n            <StatsCard\n              title=\"Personas\"\n              value={stats.personas}\n              icon={FiUser}\n              color=\"info\"\n              loading={statsLoading}\n              size=\"compact\"\n            />\n          </Col>\n          <Col md={6} lg={3}>\n            <StatsCard\n              title=\"Con Email\"\n              value={stats.conEmail}\n              icon={FiMail}\n              color=\"warning\"\n              loading={statsLoading}\n              size=\"compact\"\n            />\n          </Col>\n        </Row>\n\n        {/* Tabla de clientes */}\n        <Card className=\"shadow-sm border-0 flex-grow-1 d-flex flex-column\">\n          <Card.Header className=\"bg-white border-bottom flex-shrink-0 py-2\">\n            <div className=\"d-flex justify-content-between align-items-center\">\n              <h6 className=\"mb-0\">\n                <FiUsers className=\"me-1 text-primary\" size={16} />\n                Lista de Clientes\n              </h6>\n              <Badge bg=\"light\" text=\"dark\" className=\"px-2 py-1\">\n                {stats.total} clientes\n              </Badge>\n            </div>\n          </Card.Header>\n          <Card.Body className=\"p-0 flex-grow-1 d-flex flex-column\">\n            <div className=\"client-table flex-grow-1 d-flex flex-column\">\n              <DataTable\n                data={data?.data || []}\n                columns={columns}\n                loading={isLoading || isSearching}\n                onEdit={handleEdit}\n                onDelete={handleDelete}\n                emptyMessage=\"No hay clientes registrados\"\n                // Props para paginación del backend\n                totalItems={data?.pagination?.total || 0}\n                itemsPerPage={data?.pagination?.limit || 20}\n                currentPage={currentPage}\n                onPageChange={setCurrentPage}\n                onSearch={handleSearch}\n                onFilter={handleFilter}\n                // Filtros específicos para clientes\n                filterOptions={clientFilterOptions}\n                // Deshabilitar ordenamiento automático para mantener posición\n                sortable={false}\n                // Usar flexbox para ajustar altura\n                useFlexbox={true}\n              />\n            </div>\n          </Card.Body>\n        </Card>\n\n      <ClientFormRedesigned\n        show={showModal}\n        onHide={() => setShowModal(false)}\n        data={editingClient || emptyForm}\n        onSubmit={handleSubmit}\n        loading={createMutation.isLoading || updateMutation.isLoading}\n        isEditing={!!editingClient?.id}\n      />\n\n      {/* Modal de confirmación para eliminar cliente */}\n      <ConfirmModal\n        show={!!deletingClient}\n        onHide={() => setDeletingClient(null)}\n        onConfirm={confirmDelete}\n        title=\"Eliminar Cliente\"\n        message={`¿Estás seguro de que quieres eliminar el cliente \"${deletingClient?.name}\"?`}\n        confirmText=\"Eliminar\"\n        variant=\"danger\"\n        isLoading={deleteMutation.isLoading}\n        alertMessage=\"Esta acción eliminará permanentemente el cliente y todos sus datos asociados (proyectos, cotizaciones, etc.).\"\n        alertVariant=\"danger\"\n      />\n\n      {/* Modal de historial del cliente */}\n      <ClientHistoryModal\n        show={showHistoryModal}\n        onHide={() => setShowHistoryModal(false)}\n        clientId={selectedClientForHistory?.id}\n        clientName={selectedClientForHistory?.name}\n      />\n\n      {/* Modal de permisos denegados */}\n      <PermissionDeniedModal\n        show={showPermissionDeniedModal}\n        onHide={() => setShowPermissionDeniedModal(false)}\n        action={permissionDeniedInfo.action}\n        requiredRole={permissionDeniedInfo.requiredRole}\n        currentRole={permissionDeniedInfo.currentRole}\n      />\n      </Container>\n      </div>\n  );\n};"],"names":["CLIENT_TYPES","SECTORS","CITIES","ClientFormRedesigned","show","onHide","data","onSubmit","loading","isEditing","formData","setFormData","useState","errors","setErrors","React","isNewClient","handleInputChange","field","value","prev","validateRUC","validateDNI","validatePhone","ruc","dni","phone","validateForm","newErrors","handleSubmit","e","submitData","jsx","jsxs","FiUser","FiX","FiHome","type","FiUserCheck","FiMail","FiPhone","FiMapPin","city","sector","Fragment","FiSave","PermissionDeniedModal","action","requiredRole","currentRole","Modal","FiShield","Button","FiAlertTriangle","CLIENT_STATUSES","FiSearch","FiHeart","FiClock","FiSend","FiMessageSquare","FiCheckCircle","FiMoreHorizontal","ClientStatusDropdown","clientId","currentStatus","onStatusChange","disabled","size","showLabel","setLoading","error","setError","setShow","position","setPosition","buttonRef","useRef","menuRef","queryClient","useQueryClient","handleToggle","rect","handleClickOutside","event","useEffect","handleStatusChange","newStatus","result","updateClientStatus","err","currentStatusConfig","CurrentIcon","dropdownMenu","createPortal","status","config","StatusIcon","isCurrentStatus","FiCheck","Alert","Spinner","FiChevronDown","clientCommentsService","companyId","comment","response","apiFetch","commentId","limit","ClientChat","newComment","setNewComment","isTyping","setIsTyping","messagesEndRef","user","useAuth","socket","useSocket","commentsData","isLoading","useQuery","comments","createCommentMutation","useMutation","scrollToBottom","_a","handleNewComment","formatDate","dateString","date","diffInHours","getInitials","name","apellido","firstInitial","lastInitial","getRoleColor","role","STATUS_CONFIG","FiTrendingUp","ClientHistoryModal","clientName","historyData","getClientHistory","getStatusBadge","FiFileText","Icon","Badge","formatCurrency","amount","history","FiActivity","Card","Row","Col","Tabs","Tab","Table","quote","FiDollarSign","FiCalendar","project","emptyForm","Clientes","showModal","setShowModal","editingClient","setEditingClient","deletingClient","setDeletingClient","showHistoryModal","setShowHistoryModal","selectedClientForHistory","setSelectedClientForHistory","showPermissionDeniedModal","setShowPermissionDeniedModal","permissionDeniedInfo","setPermissionDeniedInfo","currentUser","getCurrentUser","userCanCreateClient","canCreateClient","userCanEditClient","canEditClient","userCanDeleteClient","canDeleteClient","userCanViewClientHistory","canViewClientHistory","userCanCreateProject","canCreateProject","logUserInfo","currentPage","setCurrentPage","searchTerm","setSearchTerm","selectedType","setSelectedType","selectedCity","setSelectedCity","selectedSector","setSelectedSector","isSearching","setIsSearching","navigate","useNavigate","refetch","listCompanies","statsData","statsLoading","statsError","getCompanyStats","filterOptionsData","filterOptionsLoading","getCompanyFilterOptions","handleMutationSuccess","message","handleSearch","searchValue","handleFilter","filters","clientFilterOptions","useMemo","_b","_c","createMutation","createCompany","updateMutation","updateCompany","deleteMutation","deleteCompany","handleCreate","handleEdit","client","handleDelete","confirmDelete","handleCreateProject","handleShowHistory","getTypeBadge","columns","row","cityColor","sectorColor","priority","priorityColor","priorityText","FiEdit","FiFolderPlus","FiTrash2","stats","companies","c","Container","FiUpload","FiPlus","StatsCard","FiUsers","FiBuilding","DataTable","ConfirmModal"],"mappings":"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"}