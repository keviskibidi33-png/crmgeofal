import{a as U,r as t,b as k,j as e,s as H,q as J,v as M,aq as O,B as d,X as V,ar as X,as as Q,L as $,z as W,K as Y,at as Z,m as ee,au as se,ak as L,E as ae,av as G,V as re}from"./index-CJDD9_Aw.js";import{P as ie}from"./PageHeader-Cfye0oPO.js";import{R as b,C as x}from"./Row-BGooJhRW.js";import{C as i}from"./Col-DkPevymr.js";import{T as le,a as g}from"./Tabs-4ARJRbHI.js";import{S as ne}from"./Spinner-BVQsrHFz.js";import{A as v}from"./Alert-Cn54xJZ3.js";import{F as r}from"./Form-FBPQ7LgU.js";import{I as te}from"./InputGroup-CY9SaoEq.js";import"./ElementChildren-B01Kjy_s.js";const Ne=()=>{const{user:a,logout:z}=U(),[R,A]=t.useState("profile"),[y,B]=t.useState(!1),[o,C]=t.useState(!1),[m,f]=t.useState(!1),[S,c]=t.useState(null),[F,j]=t.useState(null),[l,u]=t.useState({name:(a==null?void 0:a.name)||"",apellido:(a==null?void 0:a.apellido)||"",email:(a==null?void 0:a.email)||"",area:(a==null?void 0:a.area)||""}),[h,N]=t.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[w,D]=t.useState({email:!0,push:!1,sms:!1});t.useEffect(()=>{E()},[]);const E=async()=>{try{f(!0),c(null);const n=(await k("/api/auth/me")).user;u({name:n.name||"",apellido:n.apellido||"",email:n.email||"",area:n.area||""})}catch(s){console.error("Error cargando perfil:",s),c("Error al cargar los datos del perfil")}finally{f(!1)}},T=s=>({admin:"danger",jefa_comercial:"warning",vendedor_comercial:"primary",jefe_laboratorio:"info",usuario_laboratorio:"secondary",laboratorio:"secondary",facturacion:"success",soporte:"success",gerencia:"dark"})[s]||"secondary",_=s=>({admin:"Administrador",jefa_comercial:"Jefa Comercial",vendedor_comercial:"Vendedor",jefe_laboratorio:"Jefe Laboratorio",usuario_laboratorio:"Usuario Laboratorio",laboratorio:"Laboratorio",facturacion:"Facturación",soporte:"Soporte",gerencia:"Gerencia"})[s]||s,q=async()=>{var s,n;try{if(f(!0),c(null),j(null),!l.name.trim()){c("El nombre es requerido");return}if(!l.email.trim()){c("El email es requerido");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l.email)){c("El formato del email no es válido");return}const K=await k("/api/auth/me",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});C(!1),j("Perfil actualizado exitosamente"),console.log("Perfil actualizado:",K),setTimeout(()=>j(null),3e3)}catch(p){console.error("Error actualizando perfil:",p),c(((n=(s=p.response)==null?void 0:s.data)==null?void 0:n.error)||"Error al actualizar el perfil")}finally{f(!1)}},I=()=>{N({currentPassword:"",newPassword:"",confirmPassword:""}),console.log("Contraseña actualizada")},P=(s,n)=>{D(p=>({...p,[s]:n}))};return e.jsxs("div",{className:"fade-in",children:[e.jsx(ie,{title:"Configuración y Ajustes",subtitle:"Gestiona tu perfil, configuración y preferencias del sistema",icon:H}),e.jsxs(b,{className:"g-4",children:[e.jsxs(i,{lg:4,children:[e.jsx(x,{className:"h-100",children:e.jsxs(x.Body,{className:"text-center",children:[e.jsx("div",{className:"mb-3",children:e.jsx("div",{className:"bg-primary bg-opacity-10 rounded-circle p-4 d-inline-flex align-items-center justify-content-center",children:e.jsx(J,{size:48,className:"text-primary"})})}),e.jsx("h4",{className:"fw-bold",children:a==null?void 0:a.name}),e.jsx("p",{className:"text-muted mb-2",children:a==null?void 0:a.email}),e.jsx(M,{bg:T(a==null?void 0:a.role),className:"status-badge mb-3",children:_(a==null?void 0:a.role)}),(a==null?void 0:a.area)&&e.jsxs("div",{className:"text-muted small",children:[e.jsx(O,{className:"me-1"}),"Área: ",a.area]})]})}),e.jsxs(x,{className:"mt-4",children:[e.jsx(x.Header,{children:e.jsx("h6",{className:"mb-0",children:"Acciones Rápidas"})}),e.jsx(x.Body,{children:e.jsxs("div",{className:"d-grid gap-2",children:[e.jsxs(d,{variant:"outline-primary",size:"sm",children:[e.jsx(V,{className:"me-2"}),"Exportar Datos"]}),e.jsxs(d,{variant:"outline-secondary",size:"sm",children:[e.jsx(X,{className:"me-2"}),"Historial de Actividad"]}),e.jsxs(d,{variant:"outline-danger",size:"sm",onClick:z,children:[e.jsx(Q,{className:"me-2"}),"Cerrar Sesión"]})]})})]})]}),e.jsx(i,{lg:8,children:e.jsx(x,{children:e.jsx(x.Body,{children:e.jsxs(le,{activeKey:R,onSelect:s=>A(s),className:"mb-4",children:[e.jsx(g,{eventKey:"profile",title:"Perfil",children:e.jsxs("div",{className:"p-3",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[e.jsx("h5",{children:"Información Personal"}),e.jsx(d,{variant:o?"success":"outline-primary",size:"sm",onClick:()=>o?q():C(!0),disabled:m,children:m?e.jsxs(e.Fragment,{children:[e.jsx(ne,{size:"sm",className:"me-1"}),"Guardando..."]}):o?e.jsxs(e.Fragment,{children:[e.jsx($,{className:"me-1"}),"Guardar"]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"me-1"}),"Editar"]})})]}),S&&e.jsx(v,{variant:"danger",dismissible:!0,onClose:()=>c(null),children:S}),F&&e.jsx(v,{variant:"success",dismissible:!0,onClose:()=>j(null),children:F}),e.jsxs(b,{className:"g-3",children:[e.jsx(i,{md:6,children:e.jsxs(r.Group,{children:[e.jsx(r.Label,{children:"Nombre"}),e.jsx(r.Control,{type:"text",value:l.name,onChange:s=>u({...l,name:s.target.value}),disabled:!o||m,required:!0})]})}),e.jsx(i,{md:6,children:e.jsxs(r.Group,{children:[e.jsx(r.Label,{children:"Apellido"}),e.jsx(r.Control,{type:"text",value:l.apellido,onChange:s=>u({...l,apellido:s.target.value}),disabled:!o||m})]})}),e.jsx(i,{md:6,children:e.jsxs(r.Group,{children:[e.jsx(r.Label,{children:"Email"}),e.jsx(r.Control,{type:"email",value:l.email,onChange:s=>u({...l,email:s.target.value}),disabled:!o||m,required:!0})]})}),e.jsx(i,{md:6,children:e.jsxs(r.Group,{children:[e.jsx(r.Label,{children:"Área"}),e.jsx(r.Control,{type:"text",value:l.area,onChange:s=>u({...l,area:s.target.value}),disabled:!o||m})]})})]}),o&&e.jsx("div",{className:"mt-3",children:e.jsxs(d,{variant:"outline-secondary",size:"sm",onClick:()=>{C(!1),c(null),j(null),E()},disabled:m,children:[e.jsx(Y,{className:"me-1"}),"Cancelar"]})})]})}),e.jsx(g,{eventKey:"security",title:"Seguridad",children:e.jsxs("div",{className:"p-3",children:[e.jsx("h5",{className:"mb-4",children:"Cambiar Contraseña"}),e.jsxs(b,{className:"g-3",children:[e.jsx(i,{md:12,children:e.jsxs(r.Group,{children:[e.jsx(r.Label,{children:"Contraseña Actual"}),e.jsxs(te,{children:[e.jsx(r.Control,{type:y?"text":"password",value:h.currentPassword,onChange:s=>N({...h,currentPassword:s.target.value})}),e.jsx(d,{variant:"outline-secondary",onClick:()=>B(!y),children:y?e.jsx(Z,{}):e.jsx(ee,{})})]})]})}),e.jsx(i,{md:6,children:e.jsxs(r.Group,{children:[e.jsx(r.Label,{children:"Nueva Contraseña"}),e.jsx(r.Control,{type:"password",value:h.newPassword,onChange:s=>N({...h,newPassword:s.target.value})})]})}),e.jsx(i,{md:6,children:e.jsxs(r.Group,{children:[e.jsx(r.Label,{children:"Confirmar Contraseña"}),e.jsx(r.Control,{type:"password",value:h.confirmPassword,onChange:s=>N({...h,confirmPassword:s.target.value})})]})})]}),e.jsx("div",{className:"mt-3",children:e.jsxs(d,{variant:"primary",onClick:I,children:[e.jsx(se,{className:"me-1"}),"Cambiar Contraseña"]})}),e.jsxs(v,{variant:"info",className:"mt-4",children:[e.jsx(L,{className:"me-2"}),e.jsx("strong",{children:"Recomendaciones de seguridad:"}),e.jsxs("ul",{className:"mb-0 mt-2",children:[e.jsx("li",{children:"Usa al menos 8 caracteres"}),e.jsx("li",{children:"Incluye mayúsculas, minúsculas y números"}),e.jsx("li",{children:"Evita información personal"})]})]})]})}),e.jsx(g,{eventKey:"notifications",title:"Notificaciones",children:e.jsxs("div",{className:"p-3",children:[e.jsx("h5",{className:"mb-4",children:"Preferencias de Notificaciones"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center p-3 border rounded",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"fw-medium",children:[e.jsx(ae,{className:"me-2"}),"Notificaciones por Email"]}),e.jsx("small",{className:"text-muted",children:"Recibe notificaciones importantes por correo electrónico"})]}),e.jsx(r.Check,{type:"switch",checked:w.email,onChange:s=>P("email",s.target.checked)})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center p-3 border rounded",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"fw-medium",children:[e.jsx(G,{className:"me-2"}),"Notificaciones Push"]}),e.jsx("small",{className:"text-muted",children:"Recibe notificaciones en tiempo real en el navegador"})]}),e.jsx(r.Check,{type:"switch",checked:w.push,onChange:s=>P("push",s.target.checked)})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center p-3 border rounded",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"fw-medium",children:[e.jsx(G,{className:"me-2"}),"Notificaciones SMS"]}),e.jsx("small",{className:"text-muted",children:"Recibe notificaciones críticas por mensaje de texto"})]}),e.jsx(r.Check,{type:"switch",checked:w.sms,onChange:s=>P("sms",s.target.checked)})]})]}),e.jsx("div",{className:"mt-4",children:e.jsxs(d,{variant:"primary",children:[e.jsx(re,{className:"me-1"}),"Guardar Preferencias"]})})]})}),e.jsx(g,{eventKey:"system",title:"Sistema",children:e.jsxs("div",{className:"p-3",children:[e.jsx("h5",{className:"mb-4",children:"Información del Sistema"}),e.jsxs(b,{className:"g-3",children:[e.jsx(i,{md:6,children:e.jsxs("div",{className:"p-3 border rounded",children:[e.jsx("h6",{children:"Versión del Sistema"}),e.jsx("p",{className:"text-muted mb-0",children:"CRM GeoFal v1.0.0"})]})}),e.jsx(i,{md:6,children:e.jsxs("div",{className:"p-3 border rounded",children:[e.jsx("h6",{children:"Última Actualización"}),e.jsx("p",{className:"text-muted mb-0",children:"15 de Enero, 2025"})]})}),e.jsx(i,{md:6,children:e.jsxs("div",{className:"p-3 border rounded",children:[e.jsx("h6",{children:"Base de Datos"}),e.jsx("p",{className:"text-muted mb-0",children:"PostgreSQL 14.0"})]})}),e.jsx(i,{md:6,children:e.jsxs("div",{className:"p-3 border rounded",children:[e.jsx("h6",{children:"Servidor"}),e.jsx("p",{className:"text-muted mb-0",children:"Node.js 18.0"})]})})]}),e.jsxs(v,{variant:"info",className:"mt-4",children:[e.jsx(L,{className:"me-2"}),"Para más información sobre el sistema, contacta al administrador."]})]})})]})})})})]})]})};export{Ne as default};
//# sourceMappingURL=Ajustes-CYr5w_xf.js.map
